<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PokePoint - Sistema de Torneios VGC</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', 'Roboto', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
            position: relative;
        }

        /* Adicionar efeito de fundo animado */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="20" cy="20" r="3" fill="white" opacity="0.1"/><circle cx="80" cy="40" r="2" fill="white" opacity="0.08"/><circle cx="40" cy="80" r="2.5" fill="white" opacity="0.06"/><circle cx="70" cy="10" r="1.5" fill="white" opacity="0.09"/><circle cx="10" cy="60" r="2" fill="white" opacity="0.07"/></svg>') repeat;
            animation: float 30s infinite linear;
            z-index: -1;
        }

        @keyframes float {
            0% { transform: translateX(0) translateY(0); }
            100% { transform: translateX(-100px) translateY(-50px); }
        }

        /* Navegação entre páginas */
        .page-content {
            transition: opacity 0.3s ease-in-out;
        }

        .page-content[style*="display: none"] {
            opacity: 0;
        }

        /* Header com tema Pokémon */
        .header {
            background: linear-gradient(135deg, #ff6b6b 0%, #ffd93d 25%, #6bcf7f 50%, #4dabf7 75%, #9775fa 100%);
            padding: 2rem;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
            position: sticky;
            top: 0;
            z-index: 1000;
            position: relative;
            overflow: hidden;
        }

        .header-nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1200px;
            margin: 0 auto;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 2rem;
        }

        .logo {
            font-size: 2rem;
            font-weight: bold;
            color: white;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .pokeball-icon {
            display: inline-block;
            width: 32px;
            height: 32px;
            background: linear-gradient(
                to bottom,
                #ff0000 0%,
                #ff0000 45%,
                #333 45%,
                #333 55%,
                #ffffff 55%,
                #ffffff 100%
            );
            border-radius: 50%;
            border: 3px solid #333;
            position: relative;
            animation: pokeball-spin 3s linear infinite;
        }

        .pokeball-icon::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 8px;
            height: 8px;
            background: #333;
            border: 2px solid #fff;
            border-radius: 50%;
        }

        @keyframes pokeball-spin {
            0% { transform: rotateY(0deg); }
            100% { transform: rotateY(360deg); }
        }

        .nav-links {
            display: flex;
            gap: 1rem;
        }

        .nav-link {
            padding: 0.75rem 1.5rem;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            text-decoration: none;
            border-radius: 25px;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            font-weight: 500;
        }

        .nav-link:hover, .nav-link.active {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: white;
            font-weight: 500;
        }

        /* Feed tipo Instagram */
        .main-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
            display: grid;
            grid-template-columns: 1fr 350px;
            gap: 2rem;
        }

        .feed-container {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .post-card {
            background: white;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .post-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }

        .post-header {
            padding: 1rem;
            display: flex;
            align-items: center;
            gap: 1rem;
            border-bottom: 1px solid #f0f0f0;
        }

        .user-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea, #764ba2);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .user-avatar:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .user-avatar[onclick] {
            cursor: pointer !important;
        }

        .user-avatar[onclick]:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.5);
            border: 3px solid #667eea;
        }

        .post-user-info {
            flex: 1;
        }

        .post-username {
            font-weight: bold;
            color: #ffd700;
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .post-username:hover {
            color: #ffed4a;
        }

        .post-time {
            color: #cccccc;
            font-size: 0.9rem;
            font-weight: 500;
        }

        .post-content {
            padding: 1rem;
        }

        .post-text {
            margin-bottom: 1rem;
            line-height: 1.6;
            color: #ffffff;
            font-size: 0.95em;
            font-weight: 500;
        }

        .post-stats {
            padding: 1rem;
            border-top: 1px solid #f0f0f0;
            display: flex;
            gap: 2rem;
            color: #666;
        }

        .post-stat {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .post-stat:hover {
            color: #667eea;
        }

        /* Sidebar */
        .sidebar {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .sidebar-card {
            background: white;
            border-radius: 15px;
            padding: 1.5rem;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .sidebar-title {
            font-weight: bold;
            color: #333;
            margin-bottom: 1rem;
            font-size: 1.1rem;
        }

        .top-players {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .top-player {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.5rem;
            border-radius: 10px;
            transition: background 0.3s ease;
            cursor: pointer;
        }

        .top-player:hover {
            background: #f8f9fa;
        }

        .player-rank {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: linear-gradient(135deg, #ffd93d, #ff6b6b);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: white;
            font-size: 0.9rem;
        }

        .top-player-info {
            flex: 1;
        }

        .top-player-name {
            font-weight: 500;
            color: #333;
        }

        .top-player-points {
            color: #666;
            font-size: 0.9rem;
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
                padding: 1rem;
            }
            
            .sidebar {
                order: -1;
            }
        }

        .header::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="50" cy="50" r="40" fill="none" stroke="white" stroke-width="1" opacity="0.1"/><circle cx="50" cy="50" r="15" fill="white" opacity="0.05"/><line x1="10" y1="50" x2="90" y2="50" stroke="white" stroke-width="2" opacity="0.1"/></svg>') repeat;
            animation: rotate 20s infinite linear;
        }

        @keyframes rotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .header h1 {
            color: white;
            text-align: center;
            font-size: 3rem;
            margin-bottom: 1rem;
            text-shadow: 3px 3px 0px #333, -2px -2px 0px #333, 2px -2px 0px #333, -2px 2px 0px #333;
            position: relative;
            z-index: 2;
            animation: glow 2s ease-in-out infinite alternate;
        }

        @keyframes glow {
            from { text-shadow: 3px 3px 0px #333, -2px -2px 0px #333, 2px -2px 0px #333, -2px 2px 0px #333, 0 0 10px rgba(255,255,255,0.5); }
            to { text-shadow: 3px 3px 0px #333, -2px -2px 0px #333, 2px -2px 0px #333, -2px 2px 0px #333, 0 0 20px rgba(255,255,255,0.8), 0 0 30px rgba(255,255,255,0.6); }
        }

        .nav-tabs {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-bottom: 1rem;
            position: relative;
            z-index: 2;
            flex-wrap: wrap;
        }

        .tab-btn {
            padding: 12px 24px;
            background: linear-gradient(145deg, #ff6b6b, #ee5a52);
            color: white;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
            font-size: 1rem;
            box-shadow: 0 4px 15px rgba(255, 107, 107, 0.3);
            position: relative;
            overflow: hidden;
            min-width: 120px;
        }

        .tab-btn::before {
            content: '⚪';
            position: absolute;
            left: 8px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 0.8rem;
        }

        .tab-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(255, 107, 107, 0.4);
            background: linear-gradient(145deg, #ee5a52, #ff6b6b);
        }

        .tab-btn.active {
            background: linear-gradient(145deg, #ffd93d, #ffcc02);
            color: #333;
            box-shadow: 0 6px 20px rgba(255, 217, 61, 0.5);
        }

        .tab-btn.active::before {
            content: '🔴';
        }

        .tab-btn:hover, .tab-btn.active {
            background: #764ba2;
            transform: translateY(-2px);
            font-weight: bold;
        }

        .auth-section {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-top: 1rem;
            position: relative;
            z-index: 2;
        }

        .auth-btn, .admin-btn {
            padding: 0.8rem 1.5rem;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .auth-btn {
            background: linear-gradient(145deg, #28a745, #20c997);
            color: white;
        }

        .auth-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(40, 167, 69, 0.4);
        }

        .admin-btn {
            background: linear-gradient(145deg, #dc3545, #c82333);
            color: white;
        }

        .admin-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(220, 53, 69, 0.4);
        }

        #userInfo {
            color: white;
            font-weight: bold;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        }

        .container {
            max-width: 1200px;
            margin: 2rem auto;
            padding: 0 1rem;
        }

        .tab-content {
            display: none;
            background: rgba(255, 255, 255, 0.98);
            border-radius: 20px;
            padding: 2rem;
            box-shadow: 0 10px 40px rgba(0,0,0,0.15);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
        }

        .tab-content.active {
            display: block;
            animation: slideIn 0.5s ease-out;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .tab-content h2 {
            color: #333;
            text-align: center;
            margin-bottom: 1.5rem;
            font-size: 2rem;
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .ranking-list {
            display: grid;
            gap: 1rem;
        }

        .player-card {
            background: linear-gradient(145deg, #ffffff, #f8f9fa);
            border-radius: 20px;
            padding: 1.5rem;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 3px solid transparent;
            position: relative;
            overflow: hidden;
        }

        .player-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #ff6b6b, #ffd93d, #6bcf7f, #4dabf7, #9775fa);
        }

        .player-card:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 15px 40px rgba(0,0,0,0.2);
        }

        /* Efeitos especiais para primeiros colocados */
        .player-card:nth-child(1) {
            border-left: 5px solid #ffd93d;
            background: linear-gradient(145deg, #fff9c4, #ffffff);
        }

        .player-card:nth-child(1)::after {
            content: '👑';
            position: absolute;
            top: 10px;
            right: 15px;
            font-size: 1.5rem;
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }

        .player-card:nth-child(2) {
            border-left: 5px solid #c0c0c0;
            background: linear-gradient(145deg, #f5f5f5, #ffffff);
        }

        .player-card:nth-child(3) {
            border-left: 5px solid #cd7f32;
            background: linear-gradient(145deg, #fdf5e6, #ffffff);
        }

        .player-info {
            display: flex;
            flex-direction: column;
            flex: 1;
        }

        .player-info h3 {
            color: #333;
            margin-bottom: 0.5rem;
            font-size: 1.4rem;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }

        .player-stats {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: 0.5rem;
        }

        .points {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 0.8rem 1.5rem;
            border-radius: 25px;
            font-weight: bold;
            font-size: 1.2rem;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
            border: 2px solid rgba(255,255,255,0.2);
        }

        .tournament-points {
            background: linear-gradient(135deg, #6bcf7f, #4dabf7);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 1rem;
            font-weight: 600;
            box-shadow: 0 3px 10px rgba(107, 207, 127, 0.3);
            border: 1px solid rgba(255,255,255,0.2);
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            backdrop-filter: blur(5px);
            animation: fadeIn 0.3s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-content {
            background: linear-gradient(145deg, #ffffff, #f8f9fa);
            margin: 3% auto;
            padding: 2rem;
            border-radius: 25px;
            width: 90%;
            max-width: 900px;
            max-height: 85vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            border: 3px solid transparent;
            background-clip: padding-box;
            position: relative;
            animation: slideUp 0.3s ease-out;
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(50px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .modal-content::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: linear-gradient(90deg, #ff6b6b, #ffd93d, #6bcf7f, #4dabf7, #9775fa);
            border-radius: 25px 25px 0 0;
        }

        .close {
            color: #666;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            background: #f1f3f4;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: -10px -10px 0 0;
        }

        .close:hover {
            color: #ff6b6b;
            background: #fee;
            transform: scale(1.1);
        }

        .pokemon-team {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin: 1rem 0;
        }

        .pokemon-card {
            background: linear-gradient(145deg, #f8f9fa, #ffffff);
            border-radius: 15px;
            padding: 1.2rem;
            text-align: center;
            border: 2px solid transparent;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            position: relative;
            overflow: hidden;
        }

        .pokemon-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #ff6b6b, #ffd93d, #6bcf7f);
        }

        .pokemon-card:hover {
            border-color: #667eea;
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        }

        .pokemon-card img {
            width: 80px;
            height: 80px;
            object-fit: contain;
            transition: transform 0.3s ease;
        }

        .pokemon-card:hover img {
            transform: scale(1.1);
        }

        .pokemon-name {
            font-weight: bold;
            margin-top: 0.5rem;
            text-transform: capitalize;
            color: #333;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }

        .likes {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-top: 0.5rem;
            justify-content: center;
        }

        .like-btn {
            background: linear-gradient(145deg, #ffffff, #f8f9fa);
            border: 2px solid #ddd;
            font-size: 1.2rem;
            cursor: pointer;
            color: #666;
            transition: all 0.3s ease;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        .like-btn:hover {
            background: linear-gradient(145deg, #f8f9fa, #ffffff);
            border-color: #ff6b6b;
            color: #ff6b6b;
            transform: scale(1.1);
        }

        .like-btn.liked {
            background: linear-gradient(145deg, #ff6b6b, #e74c3c);
            color: white;
            border-color: #ff6b6b;
            box-shadow: 0 4px 15px rgba(231, 76, 60, 0.3);
        }

        .rating {
            display: flex;
            gap: 0.3rem;
            margin: 1rem 0;
            justify-content: center;
            align-items: center;
        }

        .rating h3 {
            margin-right: 1rem;
            color: #333;
        }

        .star {
            font-size: 2.5rem;
            color: #ddd;
            cursor: pointer;
            transition: all 0.3s ease;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            margin: 0 0.2rem;
            display: inline-block;
            position: relative;
        }

        .star:hover {
            color: #ffd93d;
            transform: scale(1.3);
            text-shadow: 0 0 15px rgba(255, 217, 61, 0.8);
            filter: brightness(1.2);
        }

        .star.active {
            color: #ffd93d;
            text-shadow: 0 0 10px rgba(255, 217, 61, 0.6);
        }

        .rating-interactive {
            padding: 2rem;
            text-align: center;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }

        .rating-interactive h3 {
            margin-bottom: 1rem;
            color: #333;
            font-size: 1.2rem;
        }

        .rating-interactive .rating-instruction {
            margin-bottom: 1rem;
            color: #666;
            font-size: 0.9rem;
            font-style: italic;
        }

        .current-rating {
            margin-top: 1rem;
            font-weight: bold;
            color: #333;
            font-size: 1.1rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.8rem;
            font-weight: bold;
            color: #333;
            font-size: 1.1rem;
        }

        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 1rem;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: #f8f9fa;
        }

        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
            background: white;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .form-group textarea {
            min-height: 120px;
            resize: vertical;
            font-family: inherit;
            line-height: 1.5;
        }

        /* Estilos para o modal de perfil */
        .avatar-selection {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .current-avatar {
            text-align: center;
            padding: 1rem;
            background: #f8f9fa;
            border-radius: 10px;
        }

        .avatar-preview {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            border: 3px solid #667eea;
            object-fit: cover;
        }

        .avatar-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
            gap: 1rem;
            max-height: 300px;
            overflow-y: auto;
            padding: 1rem;
            border: 2px solid #e9ecef;
            border-radius: 10px;
        }

        .avatar-option {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            border: 2px solid transparent;
            cursor: pointer;
            transition: all 0.3s ease;
            object-fit: cover;
        }

        .avatar-option:hover {
            border-color: #667eea;
            transform: scale(1.1);
        }

        .avatar-option.selected {
            border-color: #28a745;
            border-width: 3px;
            transform: scale(1.05);
        }

        .button-group {
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
            margin-top: 1rem;
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
            padding: 1rem 2rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .btn-secondary:hover {
            background: #5a6268;
            transform: translateY(-2px);
        }

        .form-note {
            background: linear-gradient(135deg, #e3f2fd, #f3e5f5);
            border-left: 4px solid #667eea;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 8px;
        }

        .form-note p {
            margin: 0 0 0.5rem 0;
            font-weight: 600;
            color: #333;
        }

        .form-note ul {
            margin: 0;
            padding-left: 1.5rem;
        }

        .form-note li {
            margin: 0.3rem 0;
            color: #555;
        }

        .btn {
            background: linear-gradient(145deg, #667eea, #764ba2);
            color: white;
            padding: 1rem 2rem;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }

        .btn:hover {
            background: linear-gradient(145deg, #764ba2, #667eea);
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        .btn:hover::before {
            left: 100%;
        }

        .pokemon-selector {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 0.8rem;
            max-height: 300px;
            overflow-y: auto;
            border: 2px solid #e9ecef;
            padding: 1.5rem;
            border-radius: 15px;
            margin-top: 1rem;
            background: #f8f9fa;
        }

        .pokemon-option {
            text-align: center;
            padding: 0.8rem;
            border: 2px solid #ddd;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: white;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }

        .pokemon-option:hover {
            background: linear-gradient(145deg, #667eea, #764ba2);
            color: white;
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .pokemon-option img {
            width: 50px;
            height: 50px;
            object-fit: contain;
            transition: transform 0.3s ease;
        }

        .pokemon-option:hover img {
            transform: scale(1.1);
        }
        }

        .tournament-limits {
            background: linear-gradient(145deg, #e3f2fd, #ffffff);
            border: 2px solid #2196f3;
            border-radius: 15px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            text-align: center;
            box-shadow: 0 4px 15px rgba(33, 150, 243, 0.2);
        }

        .tournament-limits h4 {
            color: #1976d2;
            font-size: 1.3rem;
            margin: 0;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }

        .limit-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
            padding: 0.5rem;
            background: rgba(255,255,255,0.5);
            border-radius: 8px;
        }

        .hidden {
            display: none !important;
        }

        .admin-panel {
            background: linear-gradient(145deg, #fff3cd, #ffffff);
            border: 2px solid #ffeaa7;
            border-radius: 15px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 4px 15px rgba(255, 234, 167, 0.3);
        }

        .admin-panel h3 {
            color: #856404;
            margin-bottom: 1rem;
            text-align: center;
        }

        /* Estilos para as abas do admin */
        .admin-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            border-bottom: 2px solid #e9ecef;
            padding-bottom: 10px;
        }

        .admin-tab-btn {
            background: rgba(255, 255, 255, 0.8);
            border: 2px solid #dee2e6;
            color: #495057;
            padding: 10px 20px;
            border-radius: 8px 8px 0 0;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            font-size: 0.9em;
        }

        .admin-tab-btn:hover {
            background: rgba(255, 234, 167, 0.8);
            border-color: #ffeaa7;
            color: #856404;
        }

        .admin-tab-btn.active {
            background: linear-gradient(145deg, #ffeaa7, #fdcb6e);
            border-color: #fdcb6e;
            color: #2d3436;
            box-shadow: 0 2px 8px rgba(253, 203, 110, 0.3);
        }

        .admin-tab-content {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .admin-tab-content.active {
            display: block;
        }

        .verification-request {
            background: rgba(255, 255, 255, 0.9);
            border: 2px solid #e9ecef;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .verification-request.pending {
            border-color: #ffc107;
            background: rgba(255, 193, 7, 0.1);
        }

        .verification-request h4 {
            margin: 0 0 10px 0;
            color: #2d3436;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .verification-status {
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 0.8em;
            font-weight: bold;
        }

        .verification-status.pending {
            background: #ffc107;
            color: #856404;
        }

        .verification-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin: 10px 0;
            font-size: 0.9em;
        }

        .verification-detail {
            background: rgba(248, 249, 250, 0.8);
            padding: 8px;
            border-radius: 5px;
        }

        .verification-detail strong {
            color: #495057;
        }

        .verification-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .btn-approve {
            background: linear-gradient(145deg, #00b894, #00a085);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn-approve:hover {
            background: linear-gradient(145deg, #00a085, #00b894);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 184, 148, 0.3);
        }

        .btn-reject {
            background: linear-gradient(145deg, #e74c3c, #c0392b);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn-reject:hover {
            background: linear-gradient(145deg, #c0392b, #e74c3c);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(231, 76, 60, 0.3);
        }

        .tournament-config-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .tournament-config-item {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: 1rem;
            border-radius: 10px;
            border: 2px solid #dee2e6;
        }

        .tournament-config-item h4 {
            margin: 0 0 1rem 0;
            color: #495057;
            text-align: center;
            font-size: 1.1rem;
        }

        .tournament-config-btn {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            width: 100%;
            font-weight: bold;
        }

        .tournament-config-btn:hover {
            background: linear-gradient(135deg, #218838 0%, #1ba085 100%);
            transform: translateY(-2px);
        }

        .misc-points-btn {
            background: linear-gradient(135deg, #6f42c1 0%, #e83e8c 100%);
            width: 100%;
            font-weight: bold;
        }

        .misc-points-btn:hover {
            background: linear-gradient(135deg, #59359a 0%, #d91a72 100%);
            transform: translateY(-2px);
        }

        .loading {
            text-align: center;
            padding: 3rem;
            font-style: italic;
            color: #666;
            font-size: 1.2rem;
            background: linear-gradient(145deg, #f8f9fa, #ffffff);
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        /* Estilos para o sistema de times */
        .teams-section {
            margin: 2rem 0;
        }

        .teams-section h3 {
            color: #333;
            margin-bottom: 1.5rem;
            text-align: center;
            font-size: 1.5rem;
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .teams-container {
            display: grid;
            gap: 1.5rem;
            margin-top: 1rem;
        }

        .team-card {
            background: linear-gradient(145deg, #f8f9fa, #ffffff);
            border-radius: 20px;
            padding: 1.5rem;
            border: 2px solid transparent;
            transition: all 0.3s ease;
            box-shadow: 0 6px 20px rgba(0,0,0,0.1);
            position: relative;
            overflow: hidden;
        }

        .team-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #6bcf7f, #4dabf7);
        }

        .team-card.most-popular {
            border-color: #ffd93d;
            background: linear-gradient(145deg, #fff9c4, #ffffff);
            box-shadow: 0 8px 30px rgba(255, 217, 61, 0.3);
        }

        .team-card.most-popular::before {
            background: linear-gradient(90deg, #ffd93d, #ffcc02);
        }

        .team-card.most-popular::after {
            content: '👑';
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 1.5rem;
            animation: bounce 2s infinite;
        }

        .team-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 35px rgba(0,0,0,0.15);
        }

        .team-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .team-header h4 {
            margin: 0;
            color: #333;
            font-size: 1.3rem;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }

        .team-stats {
            display: flex;
            align-items: center;
            gap: 0.8rem;
        }

        .likes-count {
            font-size: 1rem;
            color: #666;
            font-weight: 600;
            background: linear-gradient(145deg, #f1f3f4, #ffffff);
            padding: 0.3rem 0.8rem;
            border-radius: 15px;
            border: 1px solid #e0e0e0;
        }

        .pokemon-team-grid {
            display: flex;
            gap: 0.8rem;
            flex-wrap: wrap;
            justify-content: center;
        }

        .pokemon-mini {
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(145deg, #ffffff, #f8f9fa);
            border-radius: 12px;
            border: 2px solid #e9ecef;
            transition: all 0.3s ease;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
            position: relative;
            overflow: hidden;
        }

        .pokemon-mini::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, #ff6b6b, #ffd93d, #6bcf7f);
        }

        .pokemon-mini:hover {
            transform: scale(1.15) rotate(5deg);
            border-color: #667eea;
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.3);
        }

        .pokemon-mini img {
            width: 45px;
            height: 45px;
            object-fit: contain;
            transition: transform 0.3s ease;
        }

        .pokemon-mini:hover img {
            transform: scale(1.1);
        }

        .pokemon-mini.pokemon-missing {
            background: linear-gradient(135deg, #ff6b6b, #ee5a52);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2rem;
        }

        .team-author {
            font-size: 0.9rem;
            color: #666;
            margin-top: 1rem;
            font-style: italic;
            text-align: center;
            background: rgba(102, 126, 234, 0.1);
            padding: 0.5rem;
            border-radius: 10px;
        }

        .no-teams {
            text-align: center;
            color: #666;
            font-style: italic;
            padding: 3rem;
            background: linear-gradient(145deg, #f8f9fa, #ffffff);
            border-radius: 15px;
            border: 2px dashed #ddd;
            margin: 2rem 0;
        }

        .add-team-section {
            margin-top: 2rem;
            padding: 2rem;
            background: linear-gradient(145deg, #e8f5e8, #ffffff);
            border-radius: 20px;
            border: 2px solid #6bcf7f;
            box-shadow: 0 6px 20px rgba(107, 207, 127, 0.2);
        }

        .add-team-section h3 {
            color: #2e7d32;
            text-align: center;
            margin-bottom: 1.5rem;
        }

        .login-prompt {
            text-align: center;
            padding: 3rem;
            background: linear-gradient(145deg, #e3f2fd, #ffffff);
            border-radius: 20px;
            margin-top: 2rem;
            border: 2px solid #2196f3;
            box-shadow: 0 6px 20px rgba(33, 150, 243, 0.2);
        }

        .login-prompt p {
            margin-bottom: 1.5rem;
            color: #1565c0;
            font-size: 1.1rem;
        }

        /* Estilos para conquistas/prêmios */
        .achievements-section {
            margin: 2rem 0;
            padding: 2rem;
            background: linear-gradient(145deg, #fff3e0, #ffffff);
            border-radius: 20px;
            border: 2px solid #ff9800;
            box-shadow: 0 6px 20px rgba(255, 152, 0, 0.2);
        }

        .achievements-section h3 {
            color: #e65100;
            text-align: center;
            margin-bottom: 1.5rem;
            font-size: 1.5rem;
        }

        .achievements-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 1rem;
        }

        .achievement-card {
            background: linear-gradient(145deg, #ffffff, #fafafa);
            border-radius: 15px;
            padding: 1.2rem;
            text-align: center;
            border: 2px solid #e0e0e0;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .achievement-card.earned {
            border-color: #ff9800;
            background: linear-gradient(145deg, #fff8e1, #ffffff);
            box-shadow: 0 4px 15px rgba(255, 152, 0, 0.3);
        }

        .achievement-card.earned::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #ff9800, #ffc107);
        }

        .achievement-icon {
            font-size: 2rem;
            margin-bottom: 0.5rem;
            display: block;
        }

        .achievement-card.earned .achievement-icon {
            animation: bounce 1s infinite;
        }

        .achievement-title {
            font-weight: bold;
            color: #333;
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
        }

        .achievement-description {
            font-size: 0.8rem;
            color: #666;
            margin-bottom: 0.5rem;
        }

        .achievement-date {
            font-size: 0.7rem;
            color: #999;
            font-style: italic;
        }

        .no-achievements {
            text-align: center;
            color: #666;
            font-style: italic;
            padding: 2rem;
            background: #f5f5f5;
            border-radius: 10px;
        }

        /* Melhorias no perfil do jogador */
        .player-profile-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2rem;
            border-radius: 20px 20px 0 0;
            text-align: center;
            margin: -2rem -2rem 2rem -2rem;
            position: relative;
            overflow: hidden;
        }

        .player-profile-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="50" cy="50" r="30" fill="none" stroke="white" stroke-width="1" opacity="0.1"/><circle cx="20" cy="30" r="15" fill="none" stroke="white" stroke-width="1" opacity="0.05"/></svg>') repeat;
            animation: float 20s infinite linear;
        }

        .player-profile-header h2 {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            position: relative;
            z-index: 2;
        }

        .player-profile-stats {
            display: flex;
            justify-content: center;
            gap: 2rem;
            position: relative;
            z-index: 2;
        }

        .profile-stat-card {
            background: rgba(255,255,255,0.2);
            padding: 1rem;
            border-radius: 15px;
            text-align: center;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.3);
        }

        .profile-stat-value {
            font-size: 1.8rem;
            font-weight: bold;
            margin-bottom: 0.3rem;
        }

        .profile-stat-label {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .profile-content-section {
            background: white;
            border-radius: 15px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
            border: 1px solid #e9ecef;
        }

        .section-title {
            color: #333;
            font-size: 1.3rem;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid #f0f0f0;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .tournament-breakdown {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }

        .tournament-card {
            background: linear-gradient(145deg, #f8f9fa, #ffffff);
            padding: 1rem;
            border-radius: 10px;
            border: 2px solid #e9ecef;
            text-align: center;
            transition: all 0.3s ease;
        }

        .tournament-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .tournament-name {
            font-weight: bold;
            color: #667eea;
            margin-bottom: 0.5rem;
        }

        .tournament-points {
            font-size: 1.5rem;
            font-weight: bold;
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .rating-section {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1rem;
            padding: 1rem;
            background: linear-gradient(145deg, #fff9c4, #ffffff);
            border-radius: 15px;
            border: 2px solid #ffd93d;
        }

        /* Responsividade */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }

            .nav-tabs {
                flex-direction: column;
                gap: 0.5rem;
            }

            .tab-btn {
                min-width: auto;
                padding: 10px 20px;
            }

            .player-card {
                flex-direction: column;
                text-align: center;
                gap: 1rem;
            }

            .player-stats {
                align-items: center;
            }

            .container {
                padding: 0 0.5rem;
            }

            .modal-content {
                width: 95%;
                margin: 5% auto;
                padding: 1rem;
            }

            .pokemon-team-grid {
                justify-content: center;
            }

            .pokemon-mini {
                width: 50px;
                height: 50px;
            }

            .pokemon-mini img {
                width: 35px;
                height: 35px;
            }
        }

        @media (max-width: 480px) {
            .header {
                padding: 1rem;
            }

            .header h1 {
                font-size: 1.5rem;
            }

            .tab-btn {
                font-size: 0.9rem;
                padding: 8px 16px;
            }

            .pokemon-grid {
                grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
            }

            .pokemon-selection-card img {
                width: 40px;
                height: 40px;
            }
        }

        .team-author {
            font-size: 0.8rem;
            color: #666;
            margin-top: 0.5rem;
            font-style: italic;
        }

        .no-teams {
            text-align: center;
            color: #666;
            font-style: italic;
            padding: 2rem;
            background: #f8f9fa;
            border-radius: 8px;
        }

        /* Estilos para seleção de Pokémon */
        .pokemon-search-controls {
            margin-bottom: 1rem;
        }

        .pokemon-search-controls input {
            width: 100%;
            margin-bottom: 1rem;
        }

        .selected-pokemon-display {
            background: #e9ecef;
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1rem;
        }

        .selected-count {
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 1rem;
            padding: 0.75rem 1rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.25);
            font-size: 0.95rem;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
        }

        .selected-pokemon-list {
            display: flex;
            gap: 0.75rem;
            flex-wrap: wrap;
            padding: 1rem;
            background: linear-gradient(135deg, #f7fafc 0%, #edf2f7 100%);
            border-radius: 12px;
            border: 2px solid rgba(102, 126, 234, 0.1);
            margin-bottom: 1rem;
        }

        .selected-pokemon-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
            padding: 0.5rem 0.75rem;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            border: 2px solid rgba(72, 187, 120, 0.2);
            transition: all 0.3s ease;
        }

        .selected-pokemon-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);
            border: 1px solid #ddd;
        }

        .selected-pokemon-item img {
            width: 30px;
            height: 30px;
        }

        .selected-pokemon-item span {
            font-size: 0.85rem;
            font-weight: 600;
            text-transform: capitalize;
            color: #2d3748;
        }

        .remove-pokemon-btn {
            background: linear-gradient(135deg, #e53e3e 0%, #c53030 100%);
            color: white;
            border: none;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            cursor: pointer;
            font-size: 0.9rem;
            line-height: 1;
            transition: all 0.3s ease;
            box-shadow: 0 2px 4px rgba(229, 62, 62, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .remove-pokemon-btn:hover {
            background: linear-gradient(135deg, #c53030 0%, #9b2c2c 100%);
            transform: scale(1.1);
            box-shadow: 0 4px 8px rgba(229, 62, 62, 0.4);
        }

        .team-complete {
            background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
            color: white;
            font-weight: 700;
            text-align: center;
            margin: 1rem 0;
            padding: 0.75rem 1rem;
            border-radius: 10px;
            font-size: 0.95rem;
            box-shadow: 0 4px 12px rgba(72, 187, 120, 0.25);
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { box-shadow: 0 4px 12px rgba(72, 187, 120, 0.25); }
            50% { box-shadow: 0 6px 20px rgba(72, 187, 120, 0.4); }
            100% { box-shadow: 0 4px 12px rgba(72, 187, 120, 0.25); }
        }

        .add-team-toggle-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 1rem 1.5rem;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.25);
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
            width: 100%;
            margin-bottom: 1rem;
        }

        .add-team-toggle-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.35);
            background: linear-gradient(135deg, #5a67d8 0%, #6b46c1 100%);
        }

        .add-team-form {
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            border: 2px solid rgba(102, 126, 234, 0.1);
            border-radius: 15px;
            padding: 1.5rem;
            margin-top: 1rem;
            animation: slideDown 0.3s ease-out;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
                max-height: 0;
            }
            to {
                opacity: 1;
                transform: translateY(0);
                max-height: 1000px;
            }
        }

        .form-actions {
            display: flex;
            gap: 1rem;
            margin-top: 1.5rem;
            justify-content: flex-end;
        }

        .btn-primary {
            background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
            color: white;
        }

        .btn-primary:hover {
            background: linear-gradient(135deg, #38a169 0%, #2f855a 100%);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #e2e8f0 0%, #cbd5e0 100%);
            color: #4a5568;
        }

        .btn-secondary:hover {
            background: linear-gradient(135deg, #cbd5e0 0%, #a0aec0 100%);
        }

        .pokemon-search-controls {
            background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
            border: 2px solid rgba(102, 126, 234, 0.1);
            border-radius: 15px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }

        .search-input-group {
            position: relative;
            margin-bottom: 1rem;
        }

        .search-icon {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            font-size: 1.2rem;
            color: #667eea;
            z-index: 1;
        }

        .search-input-group input {
            width: 100%;
            padding: 0.75rem 0.75rem 0.75rem 3rem;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: white;
        }

        .search-input-group input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .filter-row {
            display: flex;
            gap: 1rem;
            align-items: center;
            flex-wrap: wrap;
            margin-bottom: 1rem;
        }

        .filter-group {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            background: white;
            padding: 0.5rem;
            border-radius: 10px;
            border: 2px solid #e2e8f0;
            transition: all 0.3s ease;
        }

        .filter-group:hover {
            border-color: #667eea;
        }

        .filter-icon {
            font-size: 1.1rem;
            color: #667eea;
        }

        .filter-group select {
            border: none;
            background: none;
            font-size: 0.9rem;
            color: #4a5568;
            cursor: pointer;
            outline: none;
        }

        .btn-clear {
            background: linear-gradient(135deg, #fed7d7 0%, #feb2b2 100%);
            color: #c53030;
            border: none;
            padding: 0.75rem 1rem;
            border-radius: 10px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-clear:hover {
            background: linear-gradient(135deg, #feb2b2 0%, #f56565 100%);
            color: white;
            transform: translateY(-1px);
        }

        .pokemon-selection-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding: 1rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 12px;
            color: white;
        }

        .pokemon-selection-header h4 {
            margin: 0;
            font-size: 1.2rem;
            font-weight: 600;
        }

        .progress-indicator {
            background: rgba(255, 255, 255, 0.2);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.9rem;
        }

        .search-filters-card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            border: 1px solid #e2e8f0;
        }

        .search-section {
            margin-bottom: 1rem;
        }

        .search-box {
            position: relative;
            width: 100%;
        }

        .search-box .search-icon {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            color: #667eea;
            font-size: 1.1rem;
            z-index: 2;
        }

        .search-box input {
            width: 100%;
            padding: 0.875rem 1rem 0.875rem 3rem;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: #f8fafc;
        }

        .search-box input:focus {
            outline: none;
            border-color: #667eea;
            background: white;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .filters-section {
            display: flex;
            gap: 1rem;
            align-items: center;
            flex-wrap: wrap;
        }

        .filter-item {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .filter-label {
            font-size: 0.875rem;
            font-weight: 600;
            color: #4a5568;
        }

        .filter-item select {
            padding: 0.5rem 0.75rem;
            border: 2px solid #e2e8f0;
            border-radius: 6px;
            background: white;
            color: #4a5568;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .filter-item select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .clear-filters-btn {
            padding: 0.5rem 1rem;
            background: #e2e8f0;
            border: none;
            border-radius: 6px;
            color: #4a5568;
            font-size: 0.875rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            align-self: flex-end;
        }

        .clear-filters-btn:hover {
            background: #cbd5e0;
            transform: translateY(-1px);
        }

        .btn-search {
            padding: 0.5rem 1rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            border-radius: 6px;
            color: white;
            font-size: 0.875rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            align-self: flex-end;
            box-shadow: 0 2px 4px rgba(102, 126, 234, 0.3);
        }

        .btn-search:hover {
            background: linear-gradient(135deg, #5a67d8 0%, #6b46c1 100%);
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(102, 126, 234, 0.4);
        }

        .selected-team-preview {
            background: linear-gradient(135deg, #f0fff4 0%, #c6f6d5 100%);
            border: 2px solid #48bb78;
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 1.5rem;
            min-height: 80px;
            display: flex;
            align-items: center;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .selected-team-preview.empty {
            background: linear-gradient(135deg, #f7fafc 0%, #edf2f7 100%);
            border: 2px dashed #cbd5e0;
            justify-content: center;
            color: #a0aec0;
            font-weight: 600;
        }

        .selected-pokemon-mini {
            position: relative;
            background: white;
            border-radius: 8px;
            padding: 0.5rem;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .selected-pokemon-mini img {
            width: 50px;
            height: 50px;
            object-fit: contain;
        }

        .selected-pokemon-mini .remove-btn {
            position: absolute;
            top: -5px;
            right: -5px;
            width: 20px;
            height: 20px;
            background: #e53e3e;
            color: white;
            border: none;
            border-radius: 50%;
            font-size: 0.75rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .selected-pokemon-mini .remove-btn:hover {
            background: #c53030;
            transform: scale(1.1);
        }

        .selected-pokemon-mini.empty-slot {
            background: #f7fafc;
            border: 2px dashed #cbd5e0;
            opacity: 0.6;
        }

        .pokemon-grid-container {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            padding: 1rem;
            border: 1px solid #e2e8f0;
        }

        .modern-profile-container {
            max-width: 1000px;
            margin: 0 auto;
        }

        .profile-header-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 16px;
            padding: 2rem;
            color: white;
            margin-bottom: 2rem;
            display: flex;
            align-items: center;
            gap: 2rem;
            box-shadow: 0 8px 32px rgba(102, 126, 234, 0.3);
        }

        .profile-avatar {
            flex-shrink: 0;
        }

        .avatar-circle {
            width: 80px;
            height: 80px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 3px solid rgba(255, 255, 255, 0.3);
        }

        .avatar-initial {
            font-size: 2rem;
            font-weight: 700;
            color: white;
        }

        .profile-main-info {
            flex: 1;
        }

        .profile-name {
            font-size: 2rem;
            font-weight: 700;
            margin: 0 0 0.5rem 0;
            color: white;
        }

        .profile-position {
            font-size: 1.1rem;
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 0.5rem;
        }

        .profile-rating {
            font-size: 1.2rem;
            color: #ffd700;
        }

        .rating-value {
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.9rem;
        }

        .profile-stats-mini {
            display: flex;
            gap: 1.5rem;
            flex-shrink: 0;
        }

        .stat-mini {
            text-align: center;
            background: rgba(255, 255, 255, 0.1);
            padding: 1rem;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .stat-mini-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: white;
        }

        .stat-mini-label {
            font-size: 0.8rem;
            color: rgba(255, 255, 255, 0.8);
            margin-top: 0.25rem;
        }

        .profile-content-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .profile-card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            border: 1px solid #e2e8f0;
            overflow: hidden;
        }

        .card-header {
            padding: 1.5rem 1.5rem 0 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .card-header h3 {
            margin: 0;
            font-size: 1.1rem;
            font-weight: 600;
            color: #2d3748;
        }

        .card-badge {
            background: #667eea;
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .tournaments-grid {
            padding: 1.5rem;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        .tournament-item {
            background: #f8fafc;
            padding: 1rem;
            border-radius: 8px;
            text-align: center;
            border: 1px solid #e2e8f0;
        }

        .tournament-name {
            font-size: 0.8rem;
            color: #64748b;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .tournament-points {
            font-size: 1.5rem;
            font-weight: 700;
            color: #1e293b;
            margin: 0.25rem 0;
        }

        .tournament-limit {
            font-size: 0.8rem;
            color: #64748b;
        }

        .achievements-compact {
            padding: 1.5rem;
            display: flex;
            gap: 0.75rem;
            flex-wrap: wrap;
        }

        .achievement-mini {
            width: 40px;
            height: 40px;
            background: #f0f9ff;
            border: 2px solid #0ea5e9;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .achievement-mini:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 8px rgba(14, 165, 233, 0.3);
        }

        .achievement-more {
            width: 40px;
            height: 40px;
            background: #f1f5f9;
            border: 2px dashed #cbd5e0;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            color: #64748b;
            font-weight: 600;
        }

        .rating-interactive {
            padding: 1.5rem;
            text-align: center;
        }

        .no-content {
            padding: 2rem 1.5rem;
            text-align: center;
            color: #64748b;
        }

        .no-content p {
            margin: 0 0 0.5rem 0;
            font-weight: 600;
        }

        .no-content small {
            color: #94a3b8;
        }

        .verified-badge {
            position: absolute;
            bottom: -5px;
            right: -5px;
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
            padding: 0.3rem 0.6rem;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: bold;
            box-shadow: 0 2px 8px rgba(40, 167, 69, 0.3);
        }

        .official-badge {
            background: linear-gradient(135deg, #ffd93d, #ffcc02);
            color: #333;
            padding: 0.2rem 0.6rem;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: bold;
            margin-left: auto;
        }

        .verified-text {
            color: #28a745;
            font-weight: bold;
        }

        @media (max-width: 768px) {
            .profile-header-card {
                flex-direction: column;
                text-align: center;
                gap: 1.5rem;
            }

            .profile-stats-mini {
                justify-content: center;
            }

            .profile-content-grid {
                grid-template-columns: 1fr;
            }

            .tournaments-grid {
                grid-template-columns: 1fr;
            }
        }

        .pokemon-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 1rem;
            max-height: 400px;
            overflow-y: auto;
            padding: 0.5rem;
        }

        .pokemon-grid::-webkit-scrollbar {
            width: 6px;
        }

        .pokemon-grid::-webkit-scrollbar-track {
            background: #f1f5f9;
            border-radius: 10px;
        }

        .pokemon-grid::-webkit-scrollbar-thumb {
            background: #cbd5e0;
            border-radius: 10px;
        }

        .pokemon-grid::-webkit-scrollbar-thumb:hover {
            background: #a0aec0;
        }

        .pokemon-selection-card {
            text-align: center;
            padding: 1rem 0.5rem;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: white;
            position: relative;
        }

        .pokemon-selection-card:hover {
            border-color: #667eea;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.15);
        }

        .pokemon-selection-card.selected {
            border-color: #48bb78;
            background: linear-gradient(135deg, #f0fff4 0%, #c6f6d5 100%);
            box-shadow: 0 4px 12px rgba(72, 187, 120, 0.2);
        }

        .selected-indicator {
            position: absolute;
            top: 5px;
            right: 5px;
            background: #48bb78;
            color: white;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: 700;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .pokemon-selection-card img {
            width: 60px;
            height: 60px;
            object-fit: contain;
            transition: transform 0.3s ease;
        }

        .pokemon-selection-card:hover img {
            transform: scale(1.05);
        }

        .pokemon-selection-card .pokemon-name {
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: capitalize;
            margin-top: 0.5rem;
            color: #4a5568;
        }

        .pokemon-types {
            display: flex;
            gap: 0.2rem;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 0.4rem;
        }

        .type-badge {
            font-size: 0.6rem;
            font-weight: 600;
            padding: 0.15rem 0.4rem;
            border-radius: 8px;
            color: white;
            text-transform: uppercase;
            letter-spacing: 0.3px;
        }

        .type-normal { background: #A8A878; }
        .type-fire { background: #F08030; }
        .type-water { background: #6890F0; }
        .type-electric { background: #F8D030; }
        .type-grass { background: #78C850; }
        .type-ice { background: #98D8D8; }
        .type-fighting { background: #C03028; }
        .type-poison { background: #A040A0; }
        .type-ground { background: #E0C068; }
        .type-flying { background: #A890F0; }
        .type-psychic { background: #F85888; }
        .type-bug { background: #A8B820; }
        .type-rock { background: #B8A038; }
        .type-ghost { background: #705898; }
        .type-dragon { background: #7038F8; }
        .type-dark { background: #705848; }
        .type-steel { background: #B8B8D0; }
        .type-fairy { background: #EE99AC; }

        .load-more-btn {
            grid-column: 1 / -1;
            margin-top: 1rem;
        }

        .no-results {
            grid-column: 1 / -1;
            text-align: center;
            padding: 2rem;
            color: #666;
            font-style: italic;
        }

        .add-team-section {
            margin-top: 2rem;
            padding: 1rem;
            background: #f8f9fa;
            border-radius: 8px;
            border: 1px solid #dee2e6;
        }

        .login-prompt {
            text-align: center;
            padding: 2rem;
            background: #e9ecef;
            border-radius: 8px;
            margin-top: 2rem;
        }

        .login-prompt p {
            margin-bottom: 1rem;
            color: #666;
        }

        /* Estilos para posts do feed */
        .tournament-result {
            margin: 10px 0;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .tournament-badge {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.8em;
            font-weight: bold;
        }

        .placement-badge {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.8em;
            font-weight: bold;
        }

        .pokemon-team {
            display: flex;
            gap: 8px;
            margin: 15px 0;
            flex-wrap: wrap;
            padding: 10px;
            background: rgba(0, 0, 0, 0.1);
            border-radius: 12px;
            border: 2px solid #ffd700;
        }

        .pokemon-sprite {
            width: 48px;
            height: 48px;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.1);
            padding: 4px;
            transition: transform 0.2s;
        }

        .pokemon-sprite:hover {
            transform: scale(1.1);
        }

        .post-actions {
            display: flex;
            gap: 15px;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .action-btn {
            background: none;
            border: none;
            color: rgba(255, 255, 255, 0.8);
            cursor: pointer;
            padding: 8px 12px;
            border-radius: 20px;
            transition: all 0.3s ease;
            font-size: 0.9em;
        }

        .action-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            transform: translateY(-2px);
        }

        /* Responsividade adicional para feed */
        @media (max-width: 768px) {
            .pokemon-team {
                justify-content: center;
            }
            
            .pokemon-sprite {
                width: 40px;
                height: 40px;
            }
            
            .post-actions {
                flex-wrap: wrap;
                gap: 10px;
            }
            
            .action-btn {
                font-size: 0.8em;
                padding: 6px 10px;
            }
        }

        /* Animações para posts */
        .post-card {
            animation: slideInFeed 0.5s ease-out;
        }

        @keyframes slideInFeed {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .tournament-badge, .placement-badge {
            animation: glow 2s ease-in-out infinite alternate;
        }

        @keyframes glow {
            from {
                box-shadow: 0 0 5px rgba(255, 215, 0, 0.3);
            }
            to {
                box-shadow: 0 0 15px rgba(255, 215, 0, 0.6);
            }
        }

        /* Estilos para criar post */
        .create-post-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 20px;
            border: 2px solid rgba(255, 255, 255, 0.2);
        }

        .create-post-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }

        .create-post-btn {
            flex: 1;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 25px;
            padding: 12px 20px;
            color: rgba(255, 255, 255, 0.7);
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
            font-size: 1rem;
        }

        .create-post-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border-color: #ffd700;
        }

        .post-options {
            display: flex;
            gap: 10px;
            justify-content: space-around;
        }

        .post-option {
            background: none;
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 15px;
            padding: 10px 15px;
            color: rgba(255, 255, 255, 0.8);
            cursor: pointer;
            transition: all 0.3s ease;
            flex: 1;
            font-size: 0.9rem;
        }

        .post-option:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: #ffd700;
            color: white;
        }

        /* Contador de caracteres */
        .char-counter {
            display: block;
            text-align: right;
            color: rgba(255, 255, 255, 0.6);
            font-size: 0.8em;
            margin-top: 5px;
        }

        /* Seletor de Pokémon */
        .pokemon-selector {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(60px, 1fr));
            gap: 10px;
            max-height: 200px;
            overflow-y: auto;
            padding: 10px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            margin-bottom: 15px;
        }

        .pokemon-option {
            width: 50px;
            height: 50px;
            cursor: pointer;
            border-radius: 8px;
            border: 2px solid transparent;
            transition: all 0.2s ease;
        }

        .pokemon-option:hover {
            border-color: #ffd700;
            transform: scale(1.1);
        }

        .pokemon-option.selected {
            border-color: #00ff00;
            background: rgba(0, 255, 0, 0.2);
        }

        .selected-team {
            padding: 15px;
            background: rgba(255, 215, 0, 0.1);
            border-radius: 10px;
            border: 2px solid #ffd700;
        }

        .team-display {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 10px;
        }

        .team-pokemon {
            position: relative;
        }

        .remove-pokemon {
            position: absolute;
            top: -5px;
            right: -5px;
            background: #ff4444;
            color: white;
            border: none;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            font-size: 12px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Melhorias nos posts */
        .post-card {
            position: relative;
        }

        .post-actions {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .post-actions-left {
            display: flex;
            gap: 20px;
        }

        .post-actions-right {
            display: flex;
            gap: 10px;
        }

        .like-btn {
            background: none;
            border: none;
            color: rgba(255, 255, 255, 0.9);
            cursor: pointer;
            padding: 8px 12px;
            border-radius: 20px;
            transition: all 0.3s ease;
            font-size: 0.9em;
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 500;
        }

        .like-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        .like-btn .action-icon {
            font-size: 1.2em;
            transition: transform 0.2s ease;
        }

        .like-btn:hover .action-icon {
            transform: scale(1.2);
        }

        .like-btn.liked {
            color: #ff6b9d;
            background: rgba(255, 107, 157, 0.15);
            border: 1px solid rgba(255, 107, 157, 0.3);
        }

        .like-btn.liked:hover {
            background: rgba(255, 107, 157, 0.25);
            color: #ff6b9d;
        }

        /* Novos botões de curtir e comentar */
        .curtir-btn, .comentar-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.3);
            color: rgba(0, 0, 0, 0.9);
            cursor: pointer;
            padding: 10px 16px;
            border-radius: 25px;
            transition: all 0.3s ease;
            font-size: 0.9em;
            font-weight: 600;
            margin-right: 12px;
        }

        .curtir-btn:hover {
            background: rgba(0, 0, 0, 0.2);
            border-color: #ff6b9d;
            color: #ff6b9d;
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(255, 107, 157, 0.3);
        }

        .curtir-btn.curtido {
            background: #ff6b9d;
            border-color: #ff6b9d;
            color: white;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.4);
        }

        .comentar-btn:hover {
            background: rgba(74, 144, 226, 0.2);
            border-color: #4a90e2;
            color: #4a90e2;
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(74, 144, 226, 0.3);
        }


        .likes-count {
            color: #ff6b9d;
            font-weight: 600;
            font-size: 0.9em;
        }

        /* Manter estilos para outros botões */
        .comment-btn {
            background: none;
            border: none;
            color: rgba(255, 255, 255, 0.9);
            cursor: pointer;
            padding: 8px 12px;
            border-radius: 20px;
            transition: all 0.3s ease;
            font-size: 0.9em;
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 500;
        }

        .comment-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        /* Melhorar visibilidade dos contadores */
        .like-count, .dislike-count, .comment-count {
            color: inherit;
            font-weight: bold;
            min-width: 20px;
            text-align: center;
        }

        .post-time {
            color: #cccccc;
            font-size: 0.8em;
            margin-left: auto;
            font-weight: 500;
        }

        /* Responsividade para criar post */
        @media (max-width: 768px) {
            .post-options {
                flex-direction: column;
                gap: 8px;
            }
            
            .pokemon-selector {
                grid-template-columns: repeat(auto-fill, minmax(50px, 1fr));
            }
            
            .post-actions-left {
                gap: 15px;
            }
        }

        /* Estilos para comentários */
        .comments-section {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .comments-list {
            max-height: 300px;
            overflow-y: auto;
            margin-bottom: 15px;
        }

        .comment {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            padding: 10px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
        }

        .comment-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            flex-shrink: 0;
        }

        .comment-content {
            flex: 1;
        }

        .comment-content strong {
            color: #ffd700;
            font-size: 0.9em;
            font-weight: bold;
        }

        .comment-content p {
            margin: 5px 0;
            color: #000000;
            font-size: 0.9em;
            font-weight: 500;
        }

        .comment-time {
            color: #cccccc;
            font-size: 0.8em;
            font-weight: 500;
        }

        .comment-input {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .comment-input input {
            flex: 1;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            padding: 8px 15px;
            color: #000000;
            font-size: 0.9em;
            font-weight: 500;
        }

        .comment-input input::placeholder {
            color: #b0b0b0;
        }

        .comment-input input:focus {
            outline: none;
            border-color: #ffd700;
            color: black;
        }

        .comment-input button {
            background: #ffd700;
            border: none;
            border-radius: 50%;
            width: 35px;
            height: 35px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .comment-input button:hover {
            background: #ffed4a;
            transform: scale(1.1);
        }

        /* Estilos para seleção melhorada de Pokémon */
        .pokemon-filters {
            margin-bottom: 20px;
        }

        #pokemonSearch {
            width: 100%;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 25px;
            padding: 12px 20px;
            color: white;
            font-size: 1rem;
            margin-bottom: 15px;
        }

        #pokemonSearch:focus {
            outline: none;
            border-color: #ffd700;
        }

        .filter-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .filter-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            padding: 8px 16px;
            color: rgba(255, 255, 255, 0.8);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9em;
        }

        .filter-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            color: white;
        }

        .filter-btn.active {
            background: #ffd700;
            color: #333;
            border-color: #ffd700;
        }

        .pokemon-selector {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(70px, 1fr));
            gap: 12px;
            max-height: 300px;
            overflow-y: auto;
            padding: 15px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 15px;
            margin-bottom: 20px;
            border: 2px solid rgba(255, 255, 255, 0.1);
        }

        .pokemon-option {
            width: 60px;
            height: 60px;
            cursor: pointer;
            border-radius: 12px;
            border: 3px solid transparent;
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.1);
            padding: 5px;
            position: relative;
            overflow: hidden;
        }

        .pokemon-option:hover {
            border-color: #ffd700;
            transform: scale(1.1);
            box-shadow: 0 4px 15px rgba(255, 215, 0, 0.3);
        }

        .pokemon-option.selected {
            border-color: #00ff88;
            background: rgba(0, 255, 136, 0.2);
            box-shadow: 0 4px 15px rgba(0, 255, 136, 0.4);
        }

        .pokemon-option::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, transparent 30%, rgba(255, 255, 255, 0.1) 50%, transparent 70%);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .pokemon-option:hover::after {
            opacity: 1;
        }

        .clear-team-btn {
            background: linear-gradient(135deg, #ff6b6b, #ee5a52);
            border: none;
            border-radius: 25px;
            padding: 10px 20px;
            color: white;
            cursor: pointer;
            font-weight: bold;
            margin-top: 15px;
            transition: all 0.3s ease;
        }

        .clear-team-btn:hover {
            background: linear-gradient(135deg, #ff5252, #d32f2f);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(255, 107, 107, 0.3);
        }

        .team-display {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 10px;
            margin: 15px 0;
            min-height: 80px;
            padding: 15px;
            background: rgba(255, 215, 0, 0.1);
            border-radius: 15px;
            border: 2px dashed #ffd700;
        }

        .team-pokemon {
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            min-height: 70px;
            transition: all 0.3s ease;
        }

        .team-pokemon:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .team-pokemon.empty {
            border: 2px dashed rgba(255, 255, 255, 0.3);
            background: transparent;
        }

        .team-pokemon.empty::after {
            content: '+';
            font-size: 2em;
            color: rgba(255, 255, 255, 0.3);
        }

        /* Estilo para quando não há comentários */
        .no-comments {
            text-align: center;
            color: rgba(0, 0, 0, 0.6);
            font-style: italic;
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            margin-bottom: 15px;
        }

        /* Loading para posts */
        .loading {
            text-align: center;
            color: rgba(255, 255, 255, 0.8);
            padding: 40px 20px;
            font-size: 1.1em;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            margin: 20px 0;
            animation: pulse 2s ease-in-out infinite alternate;
        }

        @keyframes pulse {
            from {
                opacity: 0.6;
            }
            to {
                opacity: 1;
            }
        }

        /* Estilos para criação de perfil */
        .trainer-selector {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
            gap: 15px;
            padding: 20px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 15px;
            margin: 15px 0;
            max-height: 300px;
            overflow-y: auto;
        }

        .trainer-option {
            width: 70px;
            height: 70px;
            border: 3px solid transparent;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.1);
            padding: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }

        .trainer-option:hover {
            border-color: #ffd700;
            transform: scale(1.1);
            box-shadow: 0 4px 15px rgba(255, 215, 0, 0.3);
        }

        .trainer-option.selected {
            border-color: #00ff88;
            background: rgba(0, 255, 136, 0.2);
            box-shadow: 0 4px 15px rgba(0, 255, 136, 0.4);
        }

        .trainer-option img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .trainer-option::after {
            content: '✓';
            position: absolute;
            top: -5px;
            right: -5px;
            background: #00ff88;
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            font-size: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .trainer-option.selected::after {
            opacity: 1;
        }

        .profile-preview {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin: 15px 0;
            text-align: center;
            border: 2px solid rgba(255, 215, 0, 0.3);
        }

        .profile-preview img {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            border: 3px solid #ffd700;
            margin-bottom: 10px;
        }

        .profile-preview h4 {
            color: #ffd700;
            margin: 10px 0 5px 0;
        }

        .profile-preview p {
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.9em;
            margin: 5px 0;
        }

        /* Melhorias no header do usuário */
        .user-profile-info {
            display: flex;
            align-items: center;
            gap: 10px;
            color: white;
        }

        .user-profile-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: 2px solid #ffd700;
        }

        .user-profile-details h4 {
            margin: 0;
            font-size: 0.9em;
            color: #ffd700;
        }

        .user-profile-details p {
            margin: 0;
            font-size: 0.8em;
            color: rgba(255, 255, 255, 0.7);
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-nav">
            <div class="header-left">
                <div class="logo">
                    <div class="pokeball-icon"></div>
                    PokePoint
                </div>
                <nav class="nav-links">
                    <a href="#" class="nav-link active" onclick="showPage('inicioPage')">📱 Início</a>
                    <a href="#" class="nav-link" onclick="showPage('torneiosPage')">🏆 Torneios</a>
                </nav>
            </div>
            <div class="header-right">
                <div id="userInfo" class="user-info" style="display: none;">
                    <span id="userEmail"></span>
                </div>
                <button id="loginBtn" class="auth-btn" onclick="showLoginModal()">Login</button>
                <button id="logoutBtn" class="auth-btn hidden" onclick="logout()">Logout</button>
                <button class="admin-btn hidden" id="adminBtn" onclick="showAdminPanel()">Admin</button>
            </div>
        </div>
    </div>

    <!-- Página Inicial (Feed) -->
    <div id="inicioPage" class="page-content" style="opacity: 1;">
        <div class="main-content">
            <div class="feed-container" id="feedContainer">
                <!-- Criar Post -->
                <div class="create-post-card">
                    <div class="create-post-header">
                        <img src="https://play.pokemonshowdown.com/sprites/trainers/brendan.png" alt="Seu Avatar" class="user-avatar" id="createPostAvatar" onclick="openProfileModal()" style="cursor: pointer;" title="Clique para editar seu perfil">
                        <button class="create-post-btn" onclick="openModal('createPostModal')">
                            💭 No que você está pensando?
                        </button>
                    </div>
                    <div class="post-options">
                        <button class="post-option" onclick="openModal('createPostModal')">📝 Texto</button>
                        <button class="post-option" onclick="openModal('createPostModal')">🏆 Resultado</button>
                        <button class="post-option" onclick="openModal('createPostModal')">👥 Team</button>
                    </div>
                </div>
                
                <!-- Posts do Feed -->
                <div class="posts-container">
                    <!-- Posts serão carregados aqui -->
                </div>
            </div>
            <div class="sidebar">
                <div class="sidebar-card">
                    <div class="sidebar-title">🏆 Top Jogadores</div>
                    <div class="top-players" id="topPlayersSidebar">
                        <!-- Top players serão carregados aqui -->
                    </div>
                </div>
                <div class="sidebar-card">
                    <div class="sidebar-title">📊 Estatísticas</div>
                    <div class="stats-info">
                        <p><strong id="totalPlayers">0</strong> jogadores ativos</p>
                        <p><strong id="totalMatches">0</strong> partidas registradas</p>
                        <p><strong id="totalTeams">0</strong> times cadastrados</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Página de Torneios (Original) -->
    <div id="torneiosPage" class="page-content" style="display: none;">
        <div class="container">
            <div class="header-tournaments">
                <h1>
                    <div class="pokeball-icon" style="width: 24px; height: 24px; display: inline-block; margin-right: 10px;"></div>
                    PokePoint VGC
                    <div class="pokeball-icon" style="width: 24px; height: 24px; display: inline-block; margin-left: 10px;"></div>
                </h1>
                <div class="nav-tabs">
                    <button class="tab-btn active" onclick="showTab('ranking-geral')">Ranking Geral</button>
                    <button class="tab-btn" onclick="showTab('torneio1')" id="tab-torneio1">League Challenge</button>
                    <button class="tab-btn" onclick="showTab('torneio2')" id="tab-torneio2">League Cup</button>
                    <button class="tab-btn" onclick="showTab('torneio3')" id="tab-torneio3">Regional</button>
                    <button class="tab-btn" onclick="showTab('torneio4')" id="tab-torneio4">Internacional</button>
                </div>
            </div>
        <!-- Ranking Geral -->
        <div id="ranking-geral" class="tab-content active">
            <h2>Ranking Geral - Pontos Totais</h2>
            <div id="rankingGeral" class="ranking-list">
                <div class="loading">Carregando ranking geral...</div>
            </div>
        </div>

        <!-- Conteúdo dos Torneios -->
        <div id="torneio1" class="tab-content">
            <h2 id="ranking-title-torneio1">Ranking - League Challenge</h2>
            <div class="tournament-limits">
                <h4 id="limit-torneio1">Limite de Pontos: 50</h4>
            </div>
            <div id="ranking1" class="ranking-list">
                <div class="loading">Carregando rankings...</div>
            </div>
        </div>

        <div id="torneio2" class="tab-content">
            <h2 id="ranking-title-torneio2">Ranking - League Cup</h2>
            <div class="tournament-limits">
                <h4 id="limit-torneio2">Limite de Pontos: 30</h4>
            </div>
            <div id="ranking2" class="ranking-list">
                <div class="loading">Carregando rankings...</div>
            </div>
        </div>

        <div id="torneio3" class="tab-content">
            <h2 id="ranking-title-torneio3">Ranking - Regional</h2>
            <div class="tournament-limits">
                <h4 id="limit-torneio3">Limite de Pontos: 40</h4>
            </div>
            <div id="ranking3" class="ranking-list">
                <div class="loading">Carregando rankings...</div>
            </div>
        </div>

        <div id="torneio4" class="tab-content">
            <h2 id="ranking-title-torneio4">Ranking - Internacional</h2>
            <div class="tournament-limits">
                <h4 id="limit-torneio4">Limite de Pontos: 25</h4>
            </div>
            <div id="ranking4" class="ranking-list">
                <div class="loading">Carregando rankings...</div>
            </div>
        </div>
    </div>

    <!-- Modal de Login -->
    <div id="loginModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('loginModal')">&times;</span>
            <h2>Login</h2>
            <form id="loginForm">
                <div class="form-group">
                    <label for="email">Email:</label>
                    <input type="email" id="email" required>
                </div>
                <div class="form-group">
                    <label for="password">Senha:</label>
                    <input type="password" id="password" required>
                </div>
                <button type="submit" class="btn">Entrar</button>
                <button type="button" class="btn" onclick="showRegisterForm()">Criar Conta</button>
            </form>
        </div>
    </div>

    <!-- Modal do Jogador -->
    <div id="playerModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('playerModal')">&times;</span>
            <div id="playerDetails">
                <!-- Conteúdo será preenchido dinamicamente -->
            </div>
        </div>
    </div>

    <!-- Modal Admin -->
    <div id="adminModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('adminModal')">&times;</span>
            <h2>🔧 Painel Administrativo</h2>
            
            <!-- Navegação do Admin -->
            <div class="admin-tabs">
                <button class="admin-tab-btn active" onclick="showAdminTab('verification')">🔐 Verificações</button>
                <button class="admin-tab-btn" onclick="showAdminTab('points')">📊 Pontos</button>
                <button class="admin-tab-btn" onclick="showAdminTab('players')">👥 Jogadores</button>
                <button class="admin-tab-btn" onclick="showAdminTab('achievements')">🏆 Conquistas</button>
            </div>

            <!-- Tab de Verificações -->
            <div id="adminTabVerification" class="admin-tab-content active">
                <h3>🔐 Solicitações de Verificação</h3>
                <div id="verificationRequests">
                    <!-- Solicitações serão carregadas aqui -->
                </div>
            </div>

            <!-- Tab de Pontos -->
            <div id="adminTabPoints" class="admin-tab-content">
                <h3>📊 Gerenciar Pontuação</h3>
                <form id="pointsForm">
                    <div class="form-group">
                        <label for="playerName">Nome do Jogador:</label>
                        <input type="text" id="playerName" required oninput="calculatePointsPreview()">
                    </div>
                    <div class="form-group">
                        <label for="newPoints">Pontuação Total no Torneio:</label>
                        <input type="number" id="newPoints" required oninput="calculatePointsPreview()">
                        <div id="pointsPreview" style="margin-top: 10px; padding: 10px; background: rgba(0,255,0,0.1); border-radius: 8px; display: none;">
                            <strong>📊 Prévia do Cálculo:</strong><br>
                            <span id="previewText"></span>
                        </div>
                        <small style="color: #666; font-style: italic;">
                            💡 <strong>Como funciona:</strong><br>
                            • Se o jogador tem 20 pontos totais e 10 no torneio atual<br>
                            • Colocando 15 pontos: remove os 10 antigos e adiciona 15 novos<br>
                            • Total fica: (20 - 10) + 15 = 25 pontos<br>
                            • É automático: só digite os pontos finais do torneio!
                        </small>
                    </div>
                    <div class="form-group">
                        <label for="tournament">Torneio:</label>
                        <select id="tournament" required onchange="calculatePointsPreview()">
                            <option value="">Selecione um torneio</option>
                            <option value="torneio1">League Challenge (Limite: 50)</option>
                            <option value="torneio2">League Cup (Limite: 30)</option>
                            <option value="torneio3">Regional (Limite: 40)</option>
                            <option value="torneio4">Internacional (Limite: 25)</option>
                        </select>
                    </div>
                    <button type="submit" class="btn">Atualizar Pontuação</button>
                </form>
            </div>

            <!-- Tab de Jogadores -->
            <div id="adminTabPlayers" class="admin-tab-content">
                <h3>👥 Criar Novo Jogador</h3>
                <form id="createPlayerForm">
                    <div class="form-group">
                        <label for="newPlayerName">Nome do Jogador:</label>
                        <input type="text" id="newPlayerName" required>
                    </div>
                    <div class="form-group">
                        <label for="newPlayerPoints">Pontuação Inicial:</label>
                        <input type="number" id="newPlayerPoints" value="0" required>
                    </div>
                    <button type="submit" class="btn">Criar Jogador</button>
                </form>
            </div>

            <!-- Tab de Conquistas -->
            <div id="adminTabAchievements" class="admin-tab-content">
                <h3>🏆 Gerenciar Conquistas</h3>
                <form id="achievementForm">
                    <div class="form-group">
                        <label for="achievementPlayerName">Nome do Jogador:</label>
                        <input type="text" id="achievementPlayerName" required>
                    </div>
                    <div class="form-group">
                        <label for="achievementType">Tipo de Conquista:</label>
                        <select id="achievementType" required>
                            <option value="tournament_winner">🏆 Campeão de Torneio</option>
                            <option value="tournament_runner_up">🥈 Vice-Campeão</option>
                            <option value="tournament_semifinalist">🥉 Semifinalista</option>
                            <option value="first_victory">⭐ Primeira Vitória</option>
                            <option value="streak_5">🔥 5 Vitórias Seguidas</option>
                            <option value="streak_10">🔥 10 Vitórias Seguidas</option>
                            <option value="points_milestone_50">💯 50 Pontos Alcançados</option>
                            <option value="points_milestone_100">💯 100 Pontos Alcançados</option>
                            <option value="team_creator">📝 Criador de Times</option>
                            <option value="community_favorite">❤️ Favorito da Comunidade</option>
                            <option value="veteran_player">🎖️ Jogador Veterano</option>
                            <option value="custom">🎗️ Conquista Personalizada</option>
                        </select>
                    </div>
                    <div class="form-group" id="customAchievementFields" style="display: none;">
                        <label for="customTitle">Título da Conquista:</label>
                        <input type="text" id="customTitle" placeholder="Ex: Especialista em Dragões">
                        <label for="customDescription">Descrição:</label>
                        <input type="text" id="customDescription" placeholder="Ex: Venceu 5 batalhas usando apenas Pokémon do tipo Dragão">
                        <label for="customIcon">Emoji/Ícone:</label>
                        <input type="text" id="customIcon" placeholder="🐉" maxlength="2">
                    </div>
                    <div class="form-group">
                        <label for="achievementTournament">Torneio (opcional):</label>
                        <select id="achievementTournament">
                            <option value="">Não específico</option>
                            <option value="torneio1">League Challenge</option>
                            <option value="torneio2">League Cup</option>
                            <option value="torneio3">Regional</option>
                            <option value="torneio4">Internacional</option>
                        </select>
                    </div>
                    <button type="submit" class="btn">Conceder Conquista</button>
                </form>
            </div>

            <div class="admin-panel">
                <hr>
                <h3>⚙️ Configurações de Torneios</h3>
                <form id="tournamentConfigForm">
                    <div class="tournament-config-grid">
                        <div class="tournament-config-item">
                            <h4>🥇 Torneio 1</h4>
                            <div class="form-group">
                                <label for="tournament1Name">Nome:</label>
                                <input type="text" id="tournament1Name" value="League Challenge" required>
                            </div>
                            <div class="form-group">
                                <label for="tournament1Limit">Limite de Pontos:</label>
                                <input type="number" id="tournament1Limit" value="50" min="1" required>
                            </div>
                        </div>
                        
                        <div class="tournament-config-item">
                            <h4>🥈 Torneio 2</h4>
                            <div class="form-group">
                                <label for="tournament2Name">Nome:</label>
                                <input type="text" id="tournament2Name" value="League Cup" required>
                            </div>
                            <div class="form-group">
                                <label for="tournament2Limit">Limite de Pontos:</label>
                                <input type="number" id="tournament2Limit" value="30" min="1" required>
                            </div>
                        </div>
                        
                        <div class="tournament-config-item">
                            <h4>🥉 Torneio 3</h4>
                            <div class="form-group">
                                <label for="tournament3Name">Nome:</label>
                                <input type="text" id="tournament3Name" value="Regional" required>
                            </div>
                            <div class="form-group">
                                <label for="tournament3Limit">Limite de Pontos:</label>
                                <input type="number" id="tournament3Limit" value="40" min="1" required>
                            </div>
                        </div>
                        
                        <div class="tournament-config-item">
                            <h4>🏆 Torneio 4</h4>
                            <div class="form-group">
                                <label for="tournament4Name">Nome:</label>
                                <input type="text" id="tournament4Name" value="Internacional" required>
                            </div>
                            <div class="form-group">
                                <label for="tournament4Limit">Limite de Pontos:</label>
                                <input type="number" id="tournament4Limit" value="25" min="1" required>
                            </div>
                        </div>
                    </div>
                    <button type="submit" class="btn tournament-config-btn">💾 Salvar Configurações</button>
                </form>
            </div>

            <div class="admin-panel">
                <hr>
                <h3>🎯 Gerenciar Pontos Diversos/Lojinha</h3>
                <form id="miscPointsForm">
                    <div class="form-group">
                        <label for="miscPlayerName">Nome do Jogador:</label>
                        <input type="text" id="miscPlayerName" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="pointsAction">Ação:</label>
                        <select id="pointsAction" onchange="togglePointsFields()" required>
                            <option value="add">➕ Adicionar Pontos</option>
                            <option value="set">📝 Definir Nova Pontuação Total</option>
                        </select>
                    </div>
                    
                    <div class="form-group" id="addPointsFields">
                        <label for="miscPoints">Pontos a Adicionar:</label>
                        <input type="number" id="miscPoints" min="1">
                    </div>
                    
                    <div class="form-group" id="setPointsFields" style="display: none;">
                        <label for="newTotalPoints">Nova Pontuação Total:</label>
                        <input type="number" id="newTotalPoints" min="0">
                        <small style="color: #666; font-style: italic;">Isso irá definir a pontuação total do jogador para este valor</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="miscReason">Motivo:</label>
                        <input type="text" id="miscReason" placeholder="Ex: Participação em evento lojinha, correção de pontos..." required>
                    </div>
                    <button type="submit" class="btn misc-points-btn">💾 Aplicar Alteração</button>
                </form>
            </div>
        </div>
    </div>

        </div>
        </div>
    </div>

    <!-- Modal de Criar Post -->
    <div id="createPostModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('createPostModal')">&times;</span>
            <h2>📝 Criar Novo Post</h2>
            
            <form id="createPostForm">
                <div class="form-group">
                    <label for="postType">Tipo de Post:</label>
                    <select id="postType" required onchange="updatePostForm()">
                        <option value="text">📝 Texto Simples</option>
                        <option value="tournament">🏆 Resultado de Torneio</option>
                        <option value="team">👥 Compartilhar Team</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="postContent">Conteúdo:</label>
                    <textarea id="postContent" placeholder="O que você quer compartilhar?" required maxlength="500"></textarea>
                    <small class="char-counter">0/500</small>
                </div>
                
                <!-- Campos específicos para resultado de torneio -->
                <div id="tournamentFields" style="display: none;">
                    <div class="form-group">
                        <label for="tournamentName">Nome do Torneio:</label>
                        <input type="text" id="tournamentName" placeholder="Ex: Regional São Paulo">
                    </div>
                    <div class="form-group">
                        <label for="placement">Colocação:</label>
                        <input type="text" id="placement" placeholder="Ex: 1º lugar, Top 8, Top 16">
                    </div>
                </div>
                
                <!-- Campos para team -->
                <div id="teamFields" style="display: none;">
                    <div class="form-group">
                        <label>Monte seu Team (clique nos Pokémon):</label>
                        
                        <!-- Filtros de Pokémon -->
                        <div class="pokemon-filters">
                            <input type="text" id="pokemonSearch" placeholder="🔍 Buscar Pokémon..." oninput="filterPokemon()">
                            <div class="filter-buttons">
                                <button type="button" class="filter-btn active" data-filter="all" onclick="filterByType('all')">Todos</button>
                                <button type="button" class="filter-btn" data-filter="popular" onclick="filterByType('popular')">Populares</button>
                                <button type="button" class="filter-btn" data-filter="legendary" onclick="filterByType('legendary')">Lendários</button>
                                <button type="button" class="filter-btn" data-filter="starter" onclick="filterByType('starter')">Iniciais</button>
                            </div>
                        </div>
                        
                        <div id="pokemonSelector" class="pokemon-selector">
                            <!-- Pokémon serão carregados aqui -->
                        </div>
                        
                        <div id="selectedTeam" class="selected-team">
                            <p>Team selecionado (0/6):</p>
                            <div class="team-display"></div>
                            <button type="button" class="clear-team-btn" onclick="clearTeam()">🗑️ Limpar Team</button>
                        </div>
                    </div>
                </div>
                
                <div class="form-actions">
                    <button type="button" onclick="closeModal('createPostModal')" class="btn-secondary">Cancelar</button>
                    <button type="submit" class="btn">📤 Publicar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal de Criar Perfil -->
    <div id="createProfileModal" class="modal">
        <div class="modal-content">
            <h2>🎮 Criar Seu Perfil</h2>
            <p>Configure seu perfil para começar a postar no PokePoint!</p>
            
            <form id="createProfileForm">
                <div class="form-group">
                    <label for="profileName">Nome de Usuário:</label>
                    <input type="text" id="profileName" required placeholder="Digite seu nome de usuário" maxlength="20">
                    <small>Será exibido nos seus posts (máx. 20 caracteres)</small>
                </div>
                
                <div class="form-group">
                    <label for="profileBio">Bio (opcional):</label>
                    <textarea id="profileBio" placeholder="Conte um pouco sobre você..." maxlength="150"></textarea>
                    <small>Descreva-se em até 150 caracteres</small>
                </div>
                
                <div class="form-group">
                    <label>Escolha seu Avatar:</label>
                    <div class="trainer-selector">
                        <!-- Avatares de treinadores serão carregados aqui -->
                    </div>
                    <input type="hidden" id="selectedAvatar" required>
                </div>
                
                <div class="form-group">
                    <label for="favoriteType">Tipo Pokémon Favorito:</label>
                    <select id="favoriteType">
                        <option value="">Selecione um tipo</option>
                        <option value="fire">🔥 Fogo</option>
                        <option value="water">💧 Água</option>
                        <option value="grass">🌱 Planta</option>
                        <option value="electric">⚡ Elétrico</option>
                        <option value="psychic">🔮 Psíquico</option>
                        <option value="dragon">🐲 Dragão</option>
                        <option value="dark">🌑 Sombrio</option>
                        <option value="fairy">🧚 Fada</option>
                        <option value="fighting">👊 Lutador</option>
                        <option value="steel">⚔️ Aço</option>
                    </select>
                </div>
                
                <div class="form-actions">
                    <button type="submit" class="btn">🎯 Criar Perfil</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal de Edição de Perfil -->
    <div id="profileModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('profileModal')">&times;</span>
            <h2>👤 Editar Perfil</h2>
            <p>Personalize seu perfil no PokePoint VGC</p>
            
            <form id="profileForm">
                <div class="form-group">
                    <label for="profileNickname">Nome de Usuário:</label>
                    <input type="text" id="profileNickname" placeholder="Seu nickname">
                </div>
                
                <div class="form-group">
                    <label for="profileDescription">Descrição:</label>
                    <textarea id="profileDescription" placeholder="Conte um pouco sobre você, suas conquistas no VGC, times favoritos..."></textarea>
                </div>
                
                <div class="form-group">
                    <label for="profileAvatar">Avatar:</label>
                    <div class="avatar-selection">
                        <div class="current-avatar">
                            <img id="currentAvatarPreview" src="https://play.pokemonshowdown.com/sprites/trainers/brendan.png" alt="Avatar Atual" class="avatar-preview">
                            <p>Avatar Atual</p>
                        </div>
                        <div class="avatar-grid" id="avatarGrid">
                            <!-- Avatares serão carregados aqui -->
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="profileFavoriteType">Tipo Pokémon Favorito:</label>
                    <select id="profileFavoriteType">
                        <option value="">Selecione...</option>
                        <option value="fire">🔥 Fogo</option>
                        <option value="water">💧 Água</option>
                        <option value="grass">🌿 Planta</option>
                        <option value="electric">⚡ Elétrico</option>
                        <option value="psychic">🔮 Psíquico</option>
                        <option value="ice">❄️ Gelo</option>
                        <option value="dragon">🐉 Dragão</option>
                        <option value="dark">🌑 Sombrio</option>
                        <option value="fairy">🧚 Fada</option>
                        <option value="fighting">👊 Lutador</option>
                        <option value="poison">☠️ Venenoso</option>
                        <option value="ground">🌍 Terra</option>
                        <option value="flying">🪶 Voador</option>
                        <option value="bug">🐛 Inseto</option>
                        <option value="rock">🗿 Pedra</option>
                        <option value="ghost">👻 Fantasma</option>
                        <option value="steel">⚙️ Aço</option>
                        <option value="normal">⚪ Normal</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="profileCity">Cidade:</label>
                    <input type="text" id="profileCity" placeholder="Sua cidade">
                </div>
                
                <div class="form-group">
                    <label for="profileExperience">Experiência no VGC:</label>
                    <select id="profileExperience">
                        <option value="">Selecione...</option>
                        <option value="beginner">🌱 Iniciante (0-6 meses)</option>
                        <option value="intermediate">🎯 Intermediário (6 meses - 2 anos)</option>
                        <option value="advanced">🏆 Avançado (2-5 anos)</option>
                        <option value="expert">👑 Veterano (5+ anos)</option>
                    </select>
                </div>
                
                <div class="button-group">
                    <button type="submit" class="btn">💾 Salvar Perfil</button>
                    <button type="button" onclick="closeModal('profileModal')" class="btn-secondary">Cancelar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-database-compat.js"></script>

    <script>
        // Navegação entre páginas
        function showPage(pageId) {
            // Esconder todas as páginas com transição
            document.querySelectorAll('.page-content').forEach(page => {
                if (page.style.display !== 'none') {
                    page.style.opacity = '0';
                    setTimeout(() => {
                        page.style.display = 'none';
                    }, 300);
                }
            });
            
            // Remover classe ativa de todos os links
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
            });
            
            // Mostrar página selecionada com transição
            const targetPage = document.getElementById(pageId);
            if (targetPage) {
                setTimeout(() => {
                    targetPage.style.display = 'block';
                    targetPage.style.opacity = '0';
                    setTimeout(() => {
                        targetPage.style.opacity = '1';
                    }, 50);
                }, 300);
            } else {
                console.error('Página não encontrada:', pageId);
                return;
            }
            
            // Ativar link correspondente
            const targetLink = document.querySelector(`[onclick="showPage('${pageId}')"]`);
            if (targetLink) {
                targetLink.classList.add('active');
            }
            
            // Atualizar URL sem recarregar
            history.pushState({page: pageId}, '', `#${pageId}`);
        }

        // Modal functions
        function openModal(modalId) {
            console.log('Tentando abrir modal:', modalId);
            const modal = document.getElementById(modalId);
            if (!modal) {
                console.error('Modal não encontrado:', modalId);
                return;
            }
            console.log('Modal encontrado, abrindo...');
            modal.style.display = 'block';
        }

        function closeModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.style.display = 'none';
                
                // Remover modais dinâmicos do DOM
                if (modalId === 'playerProfileModal') {
                    setTimeout(() => {
                        if (modal.parentNode) {
                            modal.parentNode.removeChild(modal);
                        }
                    }, 300);
                }
            }
        }

        // Fechar modal clicando fora
        window.onclick = function(event) {
            const modals = document.querySelectorAll('.modal');
            modals.forEach(modal => {
                if (event.target === modal) {
                    modal.style.display = 'none';
                }
            });
        }

        // Verificação do usuário - Aguardar DOM carregar
        document.addEventListener('DOMContentLoaded', function() {
            const verificationForm = document.getElementById('verificationForm');
            if (verificationForm) {
                verificationForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    console.log('=== FORMULÁRIO DE VERIFICAÇÃO ENVIADO ===');
                    
                    // Método alternativo - usar querySelector dentro do modal
                    const modal = document.getElementById('verificationModal');
                    
                    const realNameEl = modal.querySelector('#realName') || document.getElementById('realName');
                    const emailEl = modal.querySelector('#email') || document.getElementById('email');
                    const rgEl = modal.querySelector('#rg') || document.getElementById('rg');
                    const playerNameEl = modal.querySelector('#playerName') || document.getElementById('playerName');
                    const birthDateEl = modal.querySelector('#birthDate') || document.getElementById('birthDate');
                    const cityEl = modal.querySelector('#city') || document.getElementById('city');
                    const pokemonIdEl = modal.querySelector('#pokemonId') || document.getElementById('pokemonId');
                    const tournamentEl = modal.querySelector('#verificationReason') || document.getElementById('verificationReason');
                    
                    // Log detalhado de cada elemento
                    console.log('=== VERIFICAÇÃO DE ELEMENTOS ===');
                    console.log('realName elemento:', realNameEl);
                    console.log('realName valor:', realNameEl ? realNameEl.value : 'NULL');
                    console.log('email elemento:', emailEl);
                    console.log('email valor:', emailEl ? emailEl.value : 'NULL');
                    console.log('playerName elemento:', playerNameEl);
                    console.log('playerName valor:', playerNameEl ? playerNameEl.value : 'NULL');
                    
                    // Criar dados do formulário
                    const formData = {
                        userId: getCurrentUser(),
                        realName: realNameEl ? realNameEl.value.trim() : '',
                        email: emailEl ? emailEl.value.trim() : '',
                        rg: rgEl ? rgEl.value.trim() : '',
                        playerName: playerNameEl ? playerNameEl.value.trim() : '',
                        birthDate: birthDateEl ? birthDateEl.value.trim() : '',
                        city: cityEl ? cityEl.value.trim() : '',
                        pokemonId: pokemonIdEl ? pokemonIdEl.value.trim() : '',
                        tournaments: tournamentEl ? tournamentEl.value.trim() : '',
                        timestamp: new Date().toISOString(),
                        status: 'pending',
                        requestType: 'player_verification'
                    };
                    
                    console.log('=== DADOS COLETADOS ===', formData);
                    
                    // Lista de campos obrigatórios com validação individual
                    const validationErrors = [];
                    
                    if (!formData.realName) validationErrors.push('Nome Completo');
                    if (!formData.email) validationErrors.push('Email');
                    if (!formData.rg) validationErrors.push('RG');
                    if (!formData.playerName) validationErrors.push('Nome do Jogador VGC');
                    if (!formData.birthDate) validationErrors.push('Data de Nascimento');
                    if (!formData.city) validationErrors.push('Cidade');
                    if (!formData.tournaments) validationErrors.push('Torneios/Conquistas');
                    
                    console.log('=== ERROS DE VALIDAÇÃO ===', validationErrors);
                    
                    if (validationErrors.length > 0) {
                        alert('❌ Por favor, preencha todos os campos obrigatórios (*):\n\n' + 
                              validationErrors.map(field => '• ' + field).join('\n'));
                        return;
                    }
                    
                    // Salvar no Firebase/LocalStorage (simulação)
                    const verificationId = Date.now();
                    
                    try {
                        console.log('=== SALVANDO SOLICITAÇÃO ===');
                        
                        // Salvar no localStorage para demonstração
                        localStorage.setItem('verificationRequest_' + verificationId, JSON.stringify(formData));
                        
                        console.log('Solicitação salva com ID:', verificationId);
                        
                        // Atualizar status do usuário para "pendente"
                        updateUserVerificationStatus('pending');
                        
                        alert('✅ Solicitação enviada com sucesso!\n\n' +
                              '📋 Número da solicitação: #' + verificationId + '\n' +
                              '⏳ Status: Aguardando análise\n' +
                              '📧 Você receberá um email quando a análise for concluída.\n\n' +
                              'Tempo estimado: até 48 horas');
                        
                        closeModal('verificationModal');
                        
                        // Reset form manualmente
                        if (realNameEl) realNameEl.value = '';
                        if (emailEl) emailEl.value = '';
                        if (rgEl) rgEl.value = '';
                        if (playerNameEl) playerNameEl.value = '';
                        if (birthDateEl) birthDateEl.value = '';
                        if (cityEl) cityEl.value = '';
                        if (pokemonIdEl) pokemonIdEl.value = '';
                        if (tournamentEl) tournamentEl.value = '';
                        
                        console.log('=== PROCESSO CONCLUÍDO ===');
                        
                    } catch (error) {
                        console.error('=== ERRO ===', error);
                        alert('❌ Erro ao enviar solicitação: ' + error.message);
                    }
                });
            } else {
                console.error('Formulário de verificação não encontrado no DOM!');
            }
        });

        // Event listener para o formulário de perfil
        document.getElementById('profileForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            if (this.isSubmitting) {
                console.log('🚫 Perfil já sendo salvo...');
                return;
            }
            
            this.isSubmitting = true;
            const submitBtn = this.querySelector('button[type="submit"]');
            const originalText = submitBtn.textContent;
            submitBtn.textContent = '💾 Salvando...';
            submitBtn.disabled = true;
            
            try {
                const currentUser = getCurrentUser();
                const selectedAvatar = document.querySelector('.avatar-option.selected');
                
                const profileData = {
                    nickname: document.getElementById('profileNickname').value.trim(),
                    description: document.getElementById('profileDescription').value.trim(),
                    avatar: selectedAvatar ? selectedAvatar.src : document.getElementById('currentAvatarPreview').src,
                    favoriteType: document.getElementById('profileFavoriteType').value,
                    city: document.getElementById('profileCity').value.trim(),
                    experience: document.getElementById('profileExperience').value,
                    lastUpdated: new Date().toISOString(),
                    userEmail: currentUser ? currentUser.email : null
                };
                
                // Salvar perfil localmente
                const userKey = currentUser ? currentUser.email.split('@')[0] : 'guest';
                localStorage.setItem('userProfile_' + userKey, JSON.stringify(profileData));
                
                // Salvar perfil no Firebase se usuário estiver logado
                if (currentUser && currentUser.email) {
                    try {
                        const userProfileRef = database.ref(`${COLLECTION_NAME}/userProfiles/${currentUser.uid}`);
                        await userProfileRef.set(profileData);
                        console.log('✅ Perfil salvo no Firebase');
                    } catch (firebaseError) {
                        console.warn('⚠️ Erro ao salvar no Firebase, mantendo apenas local:', firebaseError);
                    }
                }
                
                // Atualizar avatar no createPost
                const createPostAvatar = document.getElementById('createPostAvatar');
                if (createPostAvatar) {
                    createPostAvatar.src = profileData.avatar;
                }
                
                // Atualizar avatar nos posts existentes do usuário
                updateUserAvatarInPosts(currentUser, profileData.avatar);
                
                // Atualizar nome nos posts se nickname mudou
                if (currentUser && currentUser.email) {
                    updateUserNameInPosts(currentUser.email, profileData.nickname);
                }
                
                alert('✅ Perfil atualizado com sucesso!\n\n' +
                      '👤 Nickname: ' + (profileData.nickname || 'Não definido') + '\n' +
                      '📝 Descrição: ' + (profileData.description ? 'Atualizada' : 'Não definida') + '\n' +
                      '🎮 Avatar: Atualizado\n' +
                      '📍 Cidade: ' + (profileData.city || 'Não definida') + '\n' +
                      '🔥 Experiência: ' + (profileData.experience || 'Não definida'));
                
                closeModal('profileModal');
                
            } catch (error) {
                console.error('Erro ao salvar perfil:', error);
                alert('❌ Erro ao salvar perfil: ' + error.message);
            } finally {
                this.isSubmitting = false;
                submitBtn.textContent = originalText;
                submitBtn.disabled = false;
            }
        });

        function updateUserAvatarInPosts(username, newAvatar) {
            // Atualizar avatar em todos os posts do usuário
            const userPosts = document.querySelectorAll(`[onclick*="openUserProfile('${username}')"]`);
            userPosts.forEach(avatar => {
                avatar.src = newAvatar;
            });
        }

        function updateUserNameInPosts(userKey, newNickname) {
            // Atualizar nome de usuário em posts existentes
            if (!newNickname || !newNickname.trim()) return;
            
            console.log(`🔄 Atualizando posts do usuário ${userKey} para ${newNickname}`);
            
            const posts = document.querySelectorAll('.post-card');
            let updatedCount = 0;
            
            posts.forEach(post => {
                const userNameElement = post.querySelector('.post-user-info h4');
                const postUserAvatar = post.querySelector('.user-avatar');
                
                if (userNameElement && postUserAvatar) {
                    // Verificar se o post é do usuário atual através do onclick do avatar
                    const onclickStr = postUserAvatar.getAttribute('onclick') || '';
                    
                    // Verificar múltiplas formas de identificar o usuário
                    const isUserPost = onclickStr.includes(`'${userKey}'`) || 
                                     onclickStr.includes(`"${userKey}"`) ||
                                     onclickStr.includes(userKey);
                    
                    if (isUserPost) {
                        const currentText = userNameElement.textContent;
                        // Preservar a parte de curtidas se existir
                        const likesMatch = currentText.match(/\((\d+) curtidas?\)/);
                        const likesText = likesMatch ? ` ${likesMatch[0]}` : '';
                        
                        userNameElement.innerHTML = `${newNickname}${likesText}`;
                        updatedCount++;
                        console.log(`✅ Post atualizado: ${currentText} -> ${newNickname}${likesText}`);
                    }
                }
            });
            
            console.log(`📊 Total de posts atualizados: ${updatedCount}`);
        }

        async function loadUserProfile() {
            try {
                const userKey = currentUser ? currentUser.email.split('@')[0] : 'guest';
                let profile = null;
                
                // Tentar carregar do Firebase primeiro
                if (currentUser && currentUser.uid) {
                    try {
                        const userProfileRef = database.ref(`${COLLECTION_NAME}/userProfiles/${currentUser.uid}`);
                        const snapshot = await userProfileRef.once('value');
                        if (snapshot.exists()) {
                            profile = snapshot.val();
                            // Salvar no localStorage como backup
                            localStorage.setItem('userProfile_' + userKey, JSON.stringify(profile));
                            console.log('✅ Perfil carregado do Firebase');
                        }
                    } catch (firebaseError) {
                        console.warn('⚠️ Erro ao carregar do Firebase, tentando localStorage:', firebaseError);
                    }
                }
                
                // Fallback para localStorage se Firebase falhar
                if (!profile) {
                    const savedProfile = localStorage.getItem('userProfile_' + userKey);
                    if (savedProfile) {
                        profile = JSON.parse(savedProfile);
                        console.log('✅ Perfil carregado do localStorage');
                    }
                }
                
                if (profile) {
                    // Atualizar avatar no createPost
                    if (profile.avatar) {
                        const createPostAvatar = document.getElementById('createPostAvatar');
                        if (createPostAvatar) {
                            createPostAvatar.src = profile.avatar;
                        }
                    }
                    
                    console.log('✅ Perfil do usuário carregado:', profile.nickname || userKey);
                    return profile;
                } else {
                    console.log('ℹ️ Nenhum perfil encontrado para o usuário');
                    return null;
                }
            } catch (error) {
                console.error('Erro ao carregar perfil:', error);
                return null;
            }
        }

        // Função para pegar usuário atual
        // Função para pegar usuário atual
        function getCurrentUser() {
            console.log('getCurrentUser chamada - currentUser:', currentUser);
            console.log('getCurrentUser chamada - currentUserProfile:', currentUserProfile);
            
            // Prioridade 1: Nickname do perfil se disponível
            if (currentUser && currentUser.email) {
                const userEmail = currentUser.email;
                const savedProfile = localStorage.getItem('userProfile_' + userEmail.split('@')[0]);
                if (savedProfile) {
                    try {
                        const profile = JSON.parse(savedProfile);
                        if (profile.nickname && profile.nickname.trim()) {
                            console.log('Retornando nickname do perfil:', profile.nickname);
                            return profile.nickname;
                        }
                    } catch (e) {
                        console.warn('Erro ao carregar perfil:', e);
                    }
                }
                
                // Fallback para email cortado se não tiver nickname
                const userName = userEmail.split('@')[0];
                console.log('Retornando usuário do Firebase (sem nickname):', userName);
                return userName;
            }
            
            // Prioridade 2: Perfil salvo no localStorage
            if (currentUserProfile && currentUserProfile.name) {
                console.log('Retornando do currentUserProfile:', currentUserProfile.name);
                return currentUserProfile.name;
            }
            
            // Prioridade 3: Verificar se há userInfo visível
            const userInfo = document.getElementById('userInfo');
            if (userInfo && userInfo.style.display !== 'none') {
                const userEmail = document.getElementById('userEmail');
                if (userEmail && userEmail.textContent) {
                    const email = userEmail.textContent;
                    const savedProfile = localStorage.getItem('userProfile_' + email.split('@')[0]);
                    if (savedProfile) {
                        try {
                            const profile = JSON.parse(savedProfile);
                            if (profile.nickname && profile.nickname.trim()) {
                                console.log('Retornando nickname do userEmail:', profile.nickname);
                                return profile.nickname;
                            }
                        } catch (e) {
                            console.warn('Erro ao carregar perfil do userEmail:', e);
                        }
                    }
                    
                    const userName = email.split('@')[0];
                    console.log('Retornando do userEmail:', userName);
                    return userName;
                }
            }
            
            // Prioridade 4: Tentar carregar do localStorage com chave alternativa
            const savedProfile = localStorage.getItem('pokepoint_user_profile');
            if (savedProfile) {
                try {
                    const profile = JSON.parse(savedProfile);
                    if (profile.name) {
                        currentUserProfile = profile;
                        console.log('Retornando do localStorage pokepoint_user_profile:', profile.name);
                        return profile.name;
                    }
                } catch (e) {
                    console.warn('Erro ao carregar perfil do localStorage:', e);
                }
            }
            
            // Fallback: Retornar usuário padrão
            console.log('Retornando UsuárioAnônimo');
            return 'UsuárioAnônimo';
        }

        // Funções de gerenciamento de verificação
        function updateUserVerificationStatus(status) {
            const verifyBtn = document.getElementById('verifyBtn');
            const currentUser = getCurrentUser();
            
            // Salvar status no localStorage
            localStorage.setItem('userVerificationStatus_' + currentUser, status);
            
            // Atualizar visual do botão
            switch(status) {
                case 'pending':
                    verifyBtn.innerHTML = '⏳ Verificação Pendente';
                    verifyBtn.classList.remove('verified', 'rejected');
                    verifyBtn.classList.add('pending');
                    verifyBtn.onclick = () => showVerificationStatus();
                    break;
                case 'approved':
                case 'verified':
                    verifyBtn.innerHTML = '✅ Conta Verificada';
                    verifyBtn.classList.remove('pending', 'rejected');
                    verifyBtn.classList.add('verified');
                    verifyBtn.onclick = () => showLinkedProfile();
                    break;
                case 'rejected':
                    verifyBtn.innerHTML = '❌ Verificação Rejeitada';
                    verifyBtn.classList.remove('pending', 'verified');
                    verifyBtn.classList.add('rejected');
                    verifyBtn.onclick = () => showRejectionReason();
                    break;
                default:
                    verifyBtn.innerHTML = '✓ Solicitar Verificação';
                    verifyBtn.classList.remove('pending', 'verified', 'rejected');
                    verifyBtn.onclick = () => showVerificationModal();
            }
        }

        // Mostrar perfil vinculado após aprovação
        function showLinkedProfile() {
            const currentUser = getCurrentUser();
            const linkedProfile = localStorage.getItem('linkedProfile_' + currentUser);
            
            if (linkedProfile) {
                try {
                    const profile = JSON.parse(linkedProfile);
                    alert('✅ Conta Verificada e Vinculada!\n\n' +
                          '👤 Nome Real: ' + profile.realName + '\n' +
                          '🎮 Jogador VGC: ' + profile.playerName + '\n' +
                          '📧 Email: ' + profile.email + '\n' +
                          '🏙️ Cidade: ' + profile.city + '\n' +
                          '✅ Verificado em: ' + new Date(profile.verifiedAt).toLocaleString('pt-BR') + '\n\n' +
                          '🎉 Sua conta está oficialmente vinculada ao sistema VGC!');
                } catch (e) {
                    console.error('Erro ao carregar perfil vinculado:', e);
                    alert('✅ Conta verificada com sucesso!');
                }
            } else {
                alert('✅ Conta verificada com sucesso!\n\nVocê tem acesso completo ao sistema VGC.');
            }
        }

        function showVerificationStatus() {
            const currentUser = getCurrentUser();
            const requests = Object.keys(localStorage)
                .filter(key => key.startsWith('verificationRequest_'))
                .map(key => JSON.parse(localStorage.getItem(key)))
                .filter(request => request.userId === currentUser);
            
            if (requests.length > 0) {
                const latestRequest = requests[requests.length - 1];
                alert('📋 Status da Verificação\n\n' +
                      '👤 Nome: ' + latestRequest.realName + '\n' +
                      '🎮 Jogador: ' + latestRequest.playerName + '\n' +
                      '⏳ Status: Aguardando análise\n' +
                      '📅 Enviado em: ' + new Date(latestRequest.timestamp).toLocaleDateString() + '\n\n' +
                      'Nossa equipe está analisando sua solicitação. Você receberá uma resposta em até 48h.');
            }
        }

        function showPlayerProfile() {
            // Simular dados do jogador verificado
            const currentUser = getCurrentUser();
            const request = Object.keys(localStorage)
                .filter(key => key.startsWith('verificationRequest_'))
                .map(key => JSON.parse(localStorage.getItem(key)))
                .find(req => req.userId === currentUser && req.status === 'approved');

            if (request) {
                // Criar mock de dados do perfil de jogador
                const playerProfile = {
                    name: request.playerName,
                    realName: request.realName,
                    city: request.city,
                    pokemonId: request.pokemonId,
                    tournaments: [
                        { name: "Regional São Paulo 2024", position: "Top 16", points: 40 },
                        { name: "League Cup Rio 2024", position: "Top 8", points: 60 },
                        { name: "League Challenge SP", position: "1º Lugar", points: 15 }
                    ],
                    totalPoints: 115,
                    ranking: "#127"
                };

                showPlayerDetailModal(playerProfile);
            } else {
                alert('🎮 Redirecionando para seu perfil de jogador...\n\n' +
                      'Aqui você poderá ver:\n' +
                      '• Histórico de torneios\n' +
                      '• Pontuação atual\n' +
                      '• Conquistas\n' +
                      '• Estatísticas detalhadas');
            }
        }

        function showPlayerDetailModal(playerData) {
            // Criar modal dinâmico para mostrar o perfil do jogador
            const modalContent = `
                <div class="modal" id="playerProfileModal" style="display: block;">
                    <div class="modal-content" style="max-width: 800px;">
                        <span class="close" onclick="closeModal('playerProfileModal')">&times;</span>
                        <div style="text-align: center; margin-bottom: 2rem;">
                            <h2>🎮 Perfil do Jogador Verificado</h2>
                            <div style="background: linear-gradient(135deg, #28a745, #20c997); color: white; padding: 1rem; border-radius: 10px; margin: 1rem 0;">
                                <h3>${playerData.name}</h3>
                                <p>Ranking: ${playerData.ranking} | Pontos: ${playerData.totalPoints}</p>
                            </div>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; margin-bottom: 2rem;">
                            <div>
                                <h4>📋 Informações Pessoais</h4>
                                <p><strong>Nome Real:</strong> ${playerData.realName}</p>
                                <p><strong>Cidade:</strong> ${playerData.city}</p>
                                <p><strong>ID Pokémon:</strong> ${playerData.pokemonId || 'Não informado'}</p>
                            </div>
                            <div>
                                <h4>🏆 Estatísticas</h4>
                                <p><strong>Total de Pontos:</strong> ${playerData.totalPoints}</p>
                                <p><strong>Torneios Participados:</strong> ${playerData.tournaments.length}</p>
                                <p><strong>Melhor Resultado:</strong> 1º Lugar</p>
                            </div>
                        </div>

                        <h4>🏆 Histórico de Torneios</h4>
                        <div style="background: #f8f9fa; padding: 1rem; border-radius: 10px;">
                            ${playerData.tournaments.map(tournament => `
                                <div style="background: white; padding: 1rem; margin: 0.5rem 0; border-radius: 8px; display: flex; justify-content: space-between;">
                                    <span><strong>${tournament.name}</strong></span>
                                    <span>${tournament.position} (+${tournament.points} pts)</span>
                                </div>
                            `).join('')}
                        </div>
                        
                        <div style="text-align: center; margin-top: 2rem;">
                            <button onclick="closeModal('playerProfileModal')" class="btn">Fechar Perfil</button>
                        </div>
                    </div>
                </div>
            `;
            
            // Adicionar modal ao DOM
            document.body.insertAdjacentHTML('beforeend', modalContent);
        }

        function showRejectionReason() {
            alert('❌ Verificação Rejeitada\n\n' +
                  'Motivo: Dados inconsistentes ou incompletos\n\n' +
                  'Você pode tentar novamente com informações mais precisas.\n' +
                  'Certifique-se de que o nome do jogador corresponde exatamente aos registros oficiais.');
        }

        // Verificar status ao carregar a página
        function checkVerificationStatus() {
            const currentUser = getCurrentUser();
            const status = localStorage.getItem('userVerificationStatus_' + currentUser);
            if (status) {
                updateUserVerificationStatus(status);
            }
        }

        // Funções de edição de perfil
        function openProfileModal() {
            // Carregar dados do perfil atual
            loadCurrentProfile();
            // Carregar avatares disponíveis
            loadAvatarOptions();
            // Abrir modal
            openModal('profileModal');
        }

        function openUserProfile(username) {
            // Sistema de vinculação automática por nome único
            // Primeiro verifica se é um jogador do ranking
            const rankingPlayers = {
                'João Silva': {
                    username: 'João Silva',
                    avatar: 'https://play.pokemonshowdown.com/sprites/trainers/lucas.png',
                    description: 'Jogador competitivo há 3 anos. Especialista em teams trick room e controle.',
                    favoriteType: 'Psychic',
                    city: 'São Paulo, SP',
                    experience: 'Competitivo',
                    totalPoints: 890,
                    tournaments: [
                        { name: 'League Challenge #1', points: 50, placement: '1º lugar' },
                        { name: 'Regional São Paulo', points: 200, placement: '4º lugar' },
                        { name: 'City Championship', points: 75, placement: '2º lugar' }
                    ],
                    favoriteTeam: ['charizard', 'grimmsnarl', 'dragapult', 'incineroar', 'rillaboom', 'whimsicott'],
                    achievements: ['Primeiro Regional Top Cut', 'Série de 10 vitórias', 'Team Builder Expert'],
                    isRankingPlayer: true,
                    ranking: 1
                },
                'Maria Santos': {
                    username: 'Maria Santos',
                    avatar: 'https://play.pokemonshowdown.com/sprites/trainers/dawn.png',
                    description: 'Adoro testar teams criativos! Sempre buscando novas estratégias na meta.',
                    favoriteType: 'Fairy',
                    city: 'Rio de Janeiro, RJ',
                    experience: 'Intermediário',
                    totalPoints: 456,
                    tournaments: [
                        { name: 'League Challenge #3', points: 30, placement: '3º lugar' },
                        { name: 'City Championship', points: 40, placement: '5º lugar' }
                    ],
                    favoriteTeam: ['flutter-mane', 'annihilape', 'gholdengo', 'great-tusk', 'amoonguss', 'torkoal'],
                    achievements: ['Team Inovador', 'Primeira Vitória Online'],
                    isRankingPlayer: true,
                    ranking: 5
                },
                'Pedro Champion': {
                    username: 'Pedro Champion',
                    avatar: 'https://play.pokemonshowdown.com/sprites/trainers/brendan.png',
                    description: 'Campeão regional 2024! Focado em ladder e torneios presenciais.',
                    favoriteType: 'Dragon',
                    city: 'Belo Horizonte, MG',
                    experience: 'Expert',
                    totalPoints: 1245,
                    tournaments: [
                        { name: 'Regional São Paulo', points: 300, placement: 'Top 8' },
                        { name: 'International Championship', points: 400, placement: 'Top 16' },
                        { name: 'League Challenge #2', points: 50, placement: '1º lugar' }
                    ],
                    favoriteTeam: ['koraidon', 'miraidon', 'flutter-mane', 'iron-hands', 'amoonguss', 'grimmsnarl'],
                    achievements: ['Campeão Regional', 'International Top Cut', 'Ladder Master', 'Team Building Genius'],
                    isRankingPlayer: true,
                    ranking: 2
                }
            };

            // Verificar se o nome corresponde a um jogador do ranking
            let userProfile = rankingPlayers[username];
            
            // Se não for jogador do ranking, verificar perfis personalizados salvos
            if (!userProfile) {
                const savedProfile = localStorage.getItem('userProfile_' + username);
                if (savedProfile) {
                    userProfile = JSON.parse(savedProfile);
                    userProfile.isRankingPlayer = false;
                } else {
                    // Perfil padrão para usuários não encontrados
                    userProfile = {
                        username: username,
                        avatar: 'https://play.pokemonshowdown.com/sprites/trainers/brendan.png',
                        description: 'Jogador de Pokémon VGC',
                        favoriteType: 'Normal',
                        city: 'Não informado',
                        experience: 'Iniciante',
                        totalPoints: 0,
                        tournaments: [],
                        favoriteTeam: [],
                        achievements: [],
                        isRankingPlayer: false,
                        ranking: null
                    };
                }
            }

            // Criar conteúdo do modal de perfil
            const modalContent = `
                <span class="close" onclick="closeModal('userProfileModal')">&times;</span>
                <div class="modern-profile-container">
                    <div class="profile-header-card">
                        <div class="profile-avatar">
                            <img src="${userProfile.avatar}" alt="${userProfile.username}" class="avatar-circle">
                            ${userProfile.isRankingPlayer ? '<div class="verified-badge">✅ Jogador Oficial</div>' : ''}
                        </div>
                        <div class="profile-main-info">
                            <h2 class="profile-name">${userProfile.username}</h2>
                            <p class="profile-position">
                                ${userProfile.isRankingPlayer ? 
                                    `#${userProfile.ranking} no ranking oficial` : 
                                    'Jogador da comunidade'
                                }
                            </p>
                            <div class="profile-rating">
                                <span class="rating-value">${userProfile.totalPoints}</span> pontos
                            </div>
                            <div class="profile-stats-mini">
                                <div class="stat-mini">
                                    <span class="stat-mini-value">${userProfile.tournaments.length}</span>
                                    <span class="stat-mini-label">Torneios</span>
                                </div>
                                <div class="stat-mini">
                                    <span class="stat-mini-value">${userProfile.achievements.length}</span>
                                    <span class="stat-mini-label">Conquistas</span>
                                </div>
                                <div class="stat-mini">
                                    <span class="stat-mini-value">${userProfile.experience}</span>
                                    <span class="stat-mini-label">Nível</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="profile-content-grid">
                        <div class="profile-card">
                            <div class="card-header">
                                <h3>Sobre</h3>
                                ${userProfile.isRankingPlayer ? '<span class="official-badge">🏆 Oficial</span>' : ''}
                            </div>
                            <p><strong>Descrição:</strong> ${userProfile.description}</p>
                            <p><strong>Tipo Favorito:</strong> ${userProfile.favoriteType} ${getTypeEmoji(userProfile.favoriteType)}</p>
                            <p><strong>Localização:</strong> ${userProfile.city}</p>
                            <p><strong>Experiência:</strong> ${userProfile.experience}</p>
                            ${userProfile.isRankingPlayer ? '<p><strong>Status:</strong> <span class="verified-text">✅ Perfil Verificado Automaticamente</span></p>' : ''}
                        </div>

                        <div class="profile-card">
                            <div class="card-header">
                                <h3>Torneios <span class="card-badge">${userProfile.tournaments.length}</span></h3>
                            </div>
                            <div class="tournaments-grid">
                                ${userProfile.tournaments.length > 0 ? userProfile.tournaments.map(tournament => `
                                    <div class="tournament-item">
                                        <div class="tournament-name">${tournament.name}</div>
                                        <div class="tournament-points">${tournament.points} pts</div>
                                        <div class="tournament-limit">${tournament.placement}</div>
                                    </div>
                                `).join('') : '<div class="no-content"><p>Nenhum torneio participado ainda</p></div>'}
                            </div>
                        </div>

                        <div class="profile-card">
                            <div class="card-header">
                                <h3>Time Favorito</h3>
                            </div>
                            ${userProfile.favoriteTeam.length > 0 ? `
                                <div class="pokemon-team">
                                    ${userProfile.favoriteTeam.map(pokemon => `
                                        <img src="https://play.pokemonshowdown.com/sprites/ani/${pokemon}.gif" 
                                             alt="${pokemon}" class="pokemon-sprite" title="${pokemon}">
                                    `).join('')}
                                </div>
                            ` : '<div class="no-content"><p>Nenhum time definido</p></div>'}
                        </div>

                        <div class="profile-card">
                            <div class="card-header">
                                <h3>Conquistas <span class="card-badge">${userProfile.achievements.length}</span></h3>
                            </div>
                            <div class="achievements-compact">
                                ${userProfile.achievements.length > 0 ? userProfile.achievements.map(achievement => `
                                    <div class="achievement-mini">🏆 ${achievement}</div>
                                `).join('') : '<div class="no-content"><p>Nenhuma conquista ainda</p><small>Continue jogando para desbloquear!</small></div>'}
                            </div>
                        </div>
                    </div>
                </div>
            `;

            // Mostrar modal
            const modal = document.getElementById('userProfileModal');
            if (!modal) {
                // Criar modal se não existir
                const newModal = document.createElement('div');
                newModal.id = 'userProfileModal';
                newModal.className = 'modal';
                newModal.innerHTML = `<div class="modal-content">${modalContent}</div>`;
                document.body.appendChild(newModal);
            } else {
                modal.querySelector('.modal-content').innerHTML = modalContent;
            }

            openModal('userProfileModal');
        }

        function loadCurrentProfile() {
            const currentUser = getCurrentUser();
            const savedProfile = localStorage.getItem('userProfile_' + currentUser);
            
            if (savedProfile) {
                const profile = JSON.parse(savedProfile);
                document.getElementById('profileNickname').value = profile.nickname || '';
                document.getElementById('profileDescription').value = profile.description || '';
                document.getElementById('profileFavoriteType').value = profile.favoriteType || '';
                document.getElementById('profileCity').value = profile.city || '';
                document.getElementById('profileExperience').value = profile.experience || '';
                
                // Atualizar preview do avatar
                if (profile.avatar) {
                    document.getElementById('currentAvatarPreview').src = profile.avatar;
                }
            }
        }

        function loadAvatarOptions() {
            const avatarGrid = document.getElementById('avatarGrid');
            const currentAvatar = document.getElementById('currentAvatarPreview').src;
            
            avatarGrid.innerHTML = trainerAvatars.map(avatar => `
                <img src="${avatar.url}" 
                     alt="${avatar.name}" 
                     class="avatar-option ${avatar.url === currentAvatar ? 'selected' : ''}" 
                     onclick="selectAvatar('${avatar.url}')"
                     title="${avatar.name}">
            `).join('');
        }

        function selectAvatar(avatarUrl) {
            // Remover seleção anterior
            document.querySelectorAll('.avatar-option').forEach(img => {
                img.classList.remove('selected');
            });
            
            // Selecionar novo avatar
            event.target.classList.add('selected');
            document.getElementById('currentAvatarPreview').src = avatarUrl;
        }

        // Sistema de perfil de usuário
        const trainerAvatars = [
            { id: 'lucas', name: 'Lucas', url: 'https://play.pokemonshowdown.com/sprites/trainers/lucas.png' },
            { id: 'dawn', name: 'Dawn', url: 'https://play.pokemonshowdown.com/sprites/trainers/dawn.png' },
            { id: 'brendan', name: 'Brendan', url: 'https://play.pokemonshowdown.com/sprites/trainers/brendan.png' },
            { id: 'may', name: 'May', url: 'https://play.pokemonshowdown.com/sprites/trainers/may.png' },
            { id: 'hilbert', name: 'Hilbert', url: 'https://play.pokemonshowdown.com/sprites/trainers/hilbert.png' },
            { id: 'hilda', name: 'Hilda', url: 'https://play.pokemonshowdown.com/sprites/trainers/hilda.png' },
            { id: 'calem', name: 'Calem', url: 'https://play.pokemonshowdown.com/sprites/trainers/calem.png' },
            { id: 'serena', name: 'Serena', url: 'https://play.pokemonshowdown.com/sprites/trainers/serena.png' },
            { id: 'elio', name: 'Elio', url: 'https://play.pokemonshowdown.com/sprites/trainers/elio.png' },
            { id: 'selene', name: 'Selene', url: 'https://play.pokemonshowdown.com/sprites/trainers/selene.png' },
            { id: 'victor', name: 'Victor', url: 'https://play.pokemonshowdown.com/sprites/trainers/victor.png' },
            { id: 'gloria', name: 'Gloria', url: 'https://play.pokemonshowdown.com/sprites/trainers/gloria.png' },
            { id: 'rei', name: 'Rei', url: 'https://play.pokemonshowdown.com/sprites/trainers/rei.png' },
            { id: 'akari', name: 'Akari', url: 'https://play.pokemonshowdown.com/sprites/trainers/akari.png' },
            { id: 'florian', name: 'Florian', url: 'https://play.pokemonshowdown.com/sprites/trainers/florian.png' },
            { id: 'juliana', name: 'Juliana', url: 'https://play.pokemonshowdown.com/sprites/trainers/juliana.png' }
        ];

        let selectedAvatarData = null;
        let currentUserProfile = null;

        function loadTrainerSelector() {
            const selector = document.querySelector('.trainer-selector');
            if (!selector) return;
            
            selector.innerHTML = trainerAvatars.map(trainer => `
                <div class="trainer-option" data-trainer="${trainer.id}" onclick="selectTrainer('${trainer.id}', '${trainer.url}', '${trainer.name}')">
                    <img src="${trainer.url}" alt="${trainer.name}" title="${trainer.name}">
                </div>
            `).join('');
        }

        function selectTrainer(trainerId, trainerUrl, trainerName) {
            // Remover seleção anterior
            document.querySelectorAll('.trainer-option').forEach(option => {
                option.classList.remove('selected');
            });
            
            // Adicionar seleção atual
            document.querySelector(`[data-trainer="${trainerId}"]`).classList.add('selected');
            
            // Salvar dados do avatar selecionado
            selectedAvatarData = {
                id: trainerId,
                url: trainerUrl,
                name: trainerName
            };
            
            document.getElementById('selectedAvatar').value = trainerId;
            
            // Atualizar preview se existir
            updateProfilePreview();
        }

        function updateProfilePreview() {
            // Esta função pode ser usada para mostrar um preview do perfil
            console.log('Avatar selecionado:', selectedAvatarData);
        }

        // Salvar perfil do usuário
        document.addEventListener('DOMContentLoaded', function() {
            const createProfileForm = document.getElementById('createProfileForm');
            if (createProfileForm) {
                createProfileForm.addEventListener('submit', async function(e) {
                    e.preventDefault();
                    
                    try {
                        const inputName = document.getElementById('profileName').value.trim();
                        
                        if (!inputName) {
                            alert('⚠️ Digite um nome de usuário!');
                            return;
                        }
                        
                        if (!selectedAvatarData) {
                            alert('⚠️ Escolha um avatar!');
                            return;
                        }
                        
                        // Lista de jogadores oficiais do ranking
                        const rankingPlayers = [
                            'João Silva',
                            'Maria Santos', 
                            'Pedro Champion',
                            'Ana Costa',
                            'Carlos Mendes',
                            'Fernanda Lima',
                            'Ricardo Souza',
                            'Beatriz Oliveira',
                            'Lucas Ferreira',
                            'Camila Rodrigues'
                        ];
                        
                        // Verificar se o nome já existe (verificação de nomes únicos)
                        const existingUsers = await database.ref(`${COLLECTION_NAME}/userProfiles`).once('value');
                        const usersData = existingUsers.val() || {};
                        
                        const nameExists = Object.values(usersData).some(user => 
                            user.name.toLowerCase() === inputName.toLowerCase()
                        );
                        
                        if (nameExists) {
                            alert('❌ Este nome de usuário já existe! Escolha outro.\n\n🔍 Nomes devem ser únicos no sistema.');
                            return;
                        }
                        
                        // Verificar se é um jogador do ranking (vinculação automática)
                        const isRankingPlayer = rankingPlayers.some(player => 
                            player.toLowerCase() === inputName.toLowerCase()
                        );
                        
                        let profileData = {
                            name: inputName,
                            bio: document.getElementById('profileBio').value.trim() || 'Jogador de Pokémon VGC',
                            avatar: selectedAvatarData,
                            favoriteType: document.getElementById('favoriteType').value,
                            createdAt: new Date().toISOString(),
                            email: getCurrentUserEmail(),
                            verified: isRankingPlayer, // Verificado automaticamente se for jogador do ranking
                            isRankingPlayer: isRankingPlayer,
                            postsCount: 0,
                            likesReceived: 0
                        };
                        
                        // Se for jogador do ranking, adicionar dados oficiais
                        if (isRankingPlayer) {
                            const rankingData = getRankingPlayerData(inputName);
                            profileData = {
                                ...profileData,
                                ...rankingData,
                                bio: document.getElementById('profileBio').value.trim() || rankingData.description,
                                favoriteType: document.getElementById('favoriteType').value || rankingData.favoriteType
                            };
                        }
                        
                        // Salvar perfil no Firebase
                        const userEmail = getCurrentUserEmail();
                        const userId = userEmail.replace(/[.@]/g, '_'); // Substituir caracteres inválidos
                        
                        await database.ref(`${COLLECTION_NAME}/userProfiles/${userId}`).set(profileData);
                        
                        // Salvar no localStorage também
                        localStorage.setItem('pokepoint_user_profile', JSON.stringify(profileData));
                        localStorage.setItem('userProfile_' + inputName, JSON.stringify(profileData));
                        currentUserProfile = profileData;
                        
                        if (isRankingPlayer) {
                            alert('🎉 Perfil criado e vinculado automaticamente!\n\n' +
                                  '✅ Seu nome corresponde a um jogador oficial do ranking.\n' +
                                  '🏆 Perfil verificado automaticamente!\n' +
                                  '📊 Dados oficiais vinculados com sucesso.');
                        } else {
                            alert('🎉 Perfil criado com sucesso!\n\n' +
                                  '👤 Perfil da comunidade criado.\n' +
                                  '🎮 Comece a participar e construir sua reputação!');
                        }
                        
                        closeModal('createProfileModal');
                        
                        // Atualizar interface
                        updateUserInterface();
                        
                    } catch (error) {
                        console.error('Erro ao criar perfil:', error);
                        alert('❌ Erro ao criar perfil: ' + error.message);
                    }
                });
            }
        });

        // Função para obter dados do jogador do ranking
        function getRankingPlayerData(playerName) {
            const playersData = {
                'João Silva': {
                    totalPoints: 890,
                    city: 'São Paulo, SP',
                    experience: 'Competitivo',
                    description: 'Jogador competitivo há 3 anos. Especialista em teams trick room e controle.',
                    favoriteType: 'Psychic',
                    tournaments: [
                        { name: 'League Challenge #1', points: 50, placement: '1º lugar' },
                        { name: 'Regional São Paulo', points: 200, placement: '4º lugar' },
                        { name: 'City Championship', points: 75, placement: '2º lugar' }
                    ],
                    achievements: ['Primeiro Regional Top Cut', 'Série de 10 vitórias', 'Team Builder Expert'],
                    ranking: 1
                },
                'Maria Santos': {
                    totalPoints: 456,
                    city: 'Rio de Janeiro, RJ', 
                    experience: 'Intermediário',
                    description: 'Adoro testar teams criativos! Sempre buscando novas estratégias na meta.',
                    favoriteType: 'Fairy',
                    tournaments: [
                        { name: 'League Challenge #3', points: 30, placement: '3º lugar' },
                        { name: 'City Championship', points: 40, placement: '5º lugar' }
                    ],
                    achievements: ['Team Inovador', 'Primeira Vitória Online'],
                    ranking: 5
                },
                'Pedro Champion': {
                    totalPoints: 1245,
                    city: 'Belo Horizonte, MG',
                    experience: 'Expert', 
                    description: 'Campeão regional 2024! Focado em ladder e torneios presenciais.',
                    favoriteType: 'Dragon',
                    tournaments: [
                        { name: 'Regional São Paulo', points: 300, placement: 'Top 8' },
                        { name: 'International Championship', points: 400, placement: 'Top 16' },
                        { name: 'League Challenge #2', points: 50, placement: '1º lugar' }
                    ],
                    achievements: ['Campeão Regional', 'International Top Cut', 'Ladder Master', 'Team Building Genius'],
                    ranking: 2
                }
            };
            
            return playersData[playerName] || {};
        }

        // Função para pegar email do usuário logado
        function getCurrentUserEmail() {
            const userEmail = document.getElementById('userEmail');
            return userEmail ? userEmail.textContent : 'anonimo@pokepoint.com';
        }

        // Função para pegar avatar do usuário atual
        function getCurrentUserAvatar() {
            // Prioridade 1: Avatar do perfil atual
            if (currentUserProfile && currentUserProfile.avatar) {
                if (typeof currentUserProfile.avatar === 'string') {
                    return currentUserProfile.avatar;
                }
                if (currentUserProfile.avatar.url) {
                    return currentUserProfile.avatar.url;
                }
            }
            
            // Prioridade 2: Avatar salvo no localStorage (sistema de edição de perfil)
            const currentUser = getCurrentUser();
            const savedProfile = localStorage.getItem('userProfile_' + currentUser);
            if (savedProfile) {
                try {
                    const profile = JSON.parse(savedProfile);
                    if (profile.avatar) {
                        return profile.avatar;
                    }
                } catch (e) {
                    console.warn('Erro ao carregar avatar do localStorage:', e);
                }
            }
            
            // Prioridade 3: Perfil antigo no localStorage
            const oldSavedProfile = localStorage.getItem('pokepoint_user_profile');
            if (oldSavedProfile) {
                try {
                    const profile = JSON.parse(oldSavedProfile);
                    if (profile.avatar) {
                        if (typeof profile.avatar === 'string') {
                            return profile.avatar;
                        }
                        if (profile.avatar.url) {
                            return profile.avatar.url;
                        }
                    }
                } catch (e) {
                    console.warn('Erro ao carregar avatar antigo do localStorage:', e);
                }
            }
            
            // Fallback: Avatar padrão
            return 'https://play.pokemonshowdown.com/sprites/trainers/brendan.png';
        }

        // Variable para time selecionado (global)
        window.selectedTeamPokemon = [];

        // Inicializar página
        window.addEventListener('load', function() {
            // Verificar se há hash na URL
            const hash = window.location.hash.substring(1);
            if (hash && document.getElementById(hash)) {
                showPage(hash);
            } else {
                showPage('inicioPage'); // Página padrão
            }
            
            // Carregar perfil do usuário
            loadUserProfile();
            
            // Carregar posts do Firebase
            loadPostsFromFirebase();
            
            // Limpar posts de exemplo (executar uma vez)
            cleanupSamplePosts();
            
            // Inicializar team display
            updateTeamDisplay();
        });

        // Navegação pelo histórico do browser
        window.addEventListener('popstate', function(event) {
            if (event.state && event.state.page) {
                showPage(event.state.page);
            }
        });

        // Carregar posts do Firebase
        async function loadPostsFromFirebase() {
            try {
                const feedContainer = document.querySelector('.posts-container');
                if (!feedContainer) {
                    console.log('Container de posts não encontrado');
                    return;
                }
                
                // Mostrar loading
                feedContainer.innerHTML = '<div class="loading">📡 Carregando posts...</div>';
                
                // Verificar se Firebase está disponível
                if (typeof database === 'undefined') {
                    throw new Error('Firebase não configurado');
                }
                
                // Timeout para Firebase
                const timeoutPromise = new Promise((_, reject) => 
                    setTimeout(() => reject(new Error('Timeout')), 3000)
                );
                
                const dataPromise = database.ref(`${COLLECTION_NAME}/posts`).orderByChild('timestamp').once('value');
                
                const snapshot = await Promise.race([dataPromise, timeoutPromise]);
                const postsData = snapshot.val();
                
                let posts = [];
                
                if (postsData) {
                    // Converter para array e ordenar por timestamp (mais recente primeiro)
                    posts = Object.keys(postsData).map(id => ({
                        id: id,
                        ...postsData[id]
                    })).sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
                }
                
                // Se não há posts, mostrar posts de exemplo
                if (posts.length === 0) {
                    generateFeedPosts(); // Manter posts de exemplo
                    // Inicializar sistema de likes após gerar posts de exemplo
                    setTimeout(() => {
                        initializeLikes();
                        updateLikeStates();
                    }, 100);
                    return;
                }
                
                // Renderizar posts do Firebase
                const renderedPosts = await Promise.all(posts.map(async post => {
                    // Tentar obter nickname do perfil se disponível
                    let displayName = post.user;
                    try {
                        if (post.user && post.user.includes('@')) {
                            // Se for email, tentar buscar nickname do Firebase primeiro
                            try {
                                const userUID = post.userUID;
                                if (userUID) {
                                    const userProfileRef = database.ref(`${COLLECTION_NAME}/userProfiles/${userUID}`);
                                    const profileSnapshot = await userProfileRef.once('value');
                                    if (profileSnapshot.exists()) {
                                        const profile = profileSnapshot.val();
                                        if (profile.nickname && profile.nickname.trim()) {
                                            displayName = profile.nickname;
                                        }
                                    }
                                }
                            } catch (firebaseError) {
                                console.warn('Erro ao buscar perfil no Firebase para', post.user);
                            }
                            
                            // Fallback para localStorage se Firebase não funcionar
                            if (displayName === post.user) {
                                const userKey = post.user.split('@')[0];
                                const savedProfile = localStorage.getItem('userProfile_' + userKey);
                                if (savedProfile) {
                                    const profile = JSON.parse(savedProfile);
                                    if (profile.nickname && profile.nickname.trim()) {
                                        displayName = profile.nickname;
                                    }
                                }
                            }
                        }
                    } catch (e) {
                        console.warn('Erro ao buscar nickname para', post.user, e);
                    }
                    
                    return `
                    <div class="post-card" data-post-id="${post.id}">
                        <div class="post-header">
                            <img src="${post.avatar || 'https://play.pokemonshowdown.com/sprites/trainers/brendan.png'}" alt="${displayName}" class="user-avatar" onclick="openUserProfile('${post.user}')" style="cursor: pointer;" title="Ver perfil de ${displayName}">
                            <div class="post-user-info">
                                <h4>${displayName} ${post.verified ? '✅' : ''} <span class="likes-count">(${post.likes || 0} curtidas)</span></h4>
                                <span class="post-time">${formatTimeAgo(new Date(post.timestamp))}</span>
                            </div>
                        </div>
                        
                        <div class="post-content">
                            <p>${post.content}</p>
                            
                            ${post.tournament ? `
                                <div class="tournament-result">
                                    <span class="tournament-badge">${post.tournament}</span>
                                    <span class="placement-badge">${post.placement}</span>
                                </div>
                            ` : ''}
                            
                            ${post.team ? `
                                <div class="pokemon-team">
                                    ${post.team.map(pokemon => `
                                        <img src="https://play.pokemonshowdown.com/sprites/ani/${pokemon}.gif" 
                                             alt="${pokemon}" class="pokemon-sprite" title="${pokemon}">
                                    `).join('')}
                                </div>
                            ` : ''}
                        </div>
                        
                        <div class="post-actions">
                            <div class="post-actions-left">
                                <button class="curtir-btn" data-post-id="${post.id}" onclick="curtirPost('${post.id}')">
                                    ❤️ Curtir
                                </button>
                                <button class="comentar-btn" onclick="toggleComments('${post.id}')">
                                    💬 Comentários (${post.comments || 0})
                                </button>
                            </div>
                        </div>
                        
                        <!-- Seção de comentários (oculta por padrão) -->
                        <div class="comments-section" id="comments-${post.id}" style="display: none;">
                            <div class="comments-list" id="comments-list-${post.id}">
                                <!-- Comentários serão carregados aqui -->
                            </div>
                            <div class="comment-input">
                                <img src="${getCurrentUserAvatar()}" class="comment-avatar">
                                <input type="text" placeholder="Escreva um comentário..." onkeypress="handleCommentKeypress(event, '${post.id}')" id="comment-input-${post.id}">
                                <button onclick="addComment('${post.id}')">💬</button>
                            </div>
                        </div>
                    </div>
                    `;
                }));
                
                feedContainer.innerHTML = renderedPosts.join('');
                
                console.log(`${posts.length} posts carregados do Firebase`);
                
                // Inicializar sistema de likes após carregar posts do Firebase
                setTimeout(() => {
                    initializeLikes();
                    updateLikeStates();
                }, 100);
                
            } catch (error) {
                console.error('Erro ao carregar posts:', error);
                console.log('Carregando posts de exemplo...');
                // Fallback para posts de exemplo
                generateFeedPosts();
                // Inicializar sistema de likes após gerar posts de exemplo
                setTimeout(() => {
                    initializeLikes();
                    updateLikeStates();
                }, 100);
            }
        }

        // SISTEMA DE CURTIDAS SIMPLES (baseado na lógica do dislike antigo)
        window.postCurtidas = {}; // Armazenar curtidas globalmente
        window.userCurtidas = {}; // Controlar o que cada usuário curtiu

        async function initializeLikes() {
            // Carregar curtidas dos posts do Firebase
            try {
                const posts = document.querySelectorAll('[data-post-id]');
                for (const post of posts) {
                    const postId = post.dataset.postId;
                    await atualizarContadorCurtidasDoFirebase(postId);
                }
                console.log('✅ Sistema de curtidas inicializado com dados do Firebase');
            } catch (error) {
                console.error('Erro ao inicializar curtidas:', error);
                console.log('🚫 Sem dados de fallback - usando apenas posts reais do Firebase');
            }
        }

        // Função para limpar posts de exemplo do Firebase (executar uma vez)
        async function cleanupSamplePosts() {
            try {
                console.log('🧹 Limpando posts de exemplo...');
                const postsRef = database.ref(`${COLLECTION_NAME}/posts`);
                const snapshot = await postsRef.once('value');
                const posts = snapshot.val() || {};
                
                // Remover posts marcados como samplePost ou com IDs 1, 2, 3
                for (const [postId, postData] of Object.entries(posts)) {
                    if (postData.samplePost === true || ['1', '2', '3'].includes(postId)) {
                        await database.ref(`${COLLECTION_NAME}/posts/${postId}`).remove();
                        console.log(`🗑️ Post de exemplo removido: ${postId}`);
                    }
                }
                
                console.log('✅ Limpeza de posts de exemplo concluída');
            } catch (error) {
                console.error('Erro ao limpar posts de exemplo:', error);
            }
        }

        async function curtirPost(postId) {
            console.log('🔥 CURTIR clicado para post:', postId);
            
            // Verificar se está logado
            if (!currentUser) {
                alert('❌ Faça login para curtir posts!');
                showLoginModal();
                return;
            }
            
            // Verificar se já está processando
            if (window.curtindoPost && window.curtindoPost[postId]) {
                console.log('🚫 Curtida já em andamento...');
                return;
            }
            
            // Inicializar flag de processamento
            if (!window.curtindoPost) window.curtindoPost = {};
            window.curtindoPost[postId] = true;
            
            const userId = currentUser.uid;
            
            try {
                // Verificar se o usuário já curtiu este post
                const userLikeRef = database.ref(`${COLLECTION_NAME}/userLikes/${userId}/${postId}`);
                const userLikeSnapshot = await userLikeRef.once('value');
                const userJaCurtiu = userLikeSnapshot.val();
                
                // Encontrar elementos da UI
                const postCard = document.querySelector(`[data-post-id="${postId}"]`);
                if (!postCard) {
                    console.error('❌ Post não encontrado:', postId);
                    return;
                }
                
                const curtirBtn = postCard.querySelector('.curtir-btn');
                if (!curtirBtn) {
                    console.error('❌ Botão não encontrado');
                    return;
                }
                
                // Desabilitar botão temporariamente
                curtirBtn.disabled = true;
                
                if (userJaCurtiu) {
                    // Remover curtida
                    await userLikeRef.remove();
                    
                    // Decrementar contador do post
                    const postRef = database.ref(`${COLLECTION_NAME}/posts/${postId}/likes`);
                    await postRef.transaction((currentLikes) => {
                        return Math.max(0, (currentLikes || 0) - 1);
                    });
                    
                    // Atualizar UI
                    curtirBtn.classList.remove('curtido');
                    curtirBtn.textContent = '❤️ Curtir';
                    console.log('💔 Curtida removida do Firebase');
                    
                } else {
                    // Adicionar curtida
                    await userLikeRef.set(true);
                    
                    // Incrementar contador do post
                    const postRef = database.ref(`${COLLECTION_NAME}/posts/${postId}/likes`);
                    await postRef.transaction((currentLikes) => {
                        return (currentLikes || 0) + 1;
                    });
                    
                    // Atualizar UI
                    curtirBtn.classList.add('curtido');
                    curtirBtn.textContent = '❤️ Curtido';
                    console.log('❤️ Curtida salva no Firebase');
                }
                
                // Recarregar contador atualizado
                await atualizarContadorCurtidasDoFirebase(postId);
                
            } catch (error) {
                console.error('❌ Erro ao curtir post:', error);
                alert('❌ Erro ao curtir post: ' + error.message);
            } finally {
                // Limpar flag de processamento
                if (window.curtindoPost) {
                    window.curtindoPost[postId] = false;
                }
                
                // Reabilitar botão
                const curtirBtn = document.querySelector(`[data-post-id="${postId}"] .curtir-btn`);
                if (curtirBtn) curtirBtn.disabled = false;
            }
        }

        async function atualizarContadorCurtidasDoFirebase(postId) {
            try {
                const postRef = database.ref(`${COLLECTION_NAME}/posts/${postId}/likes`);
                const snapshot = await postRef.once('value');
                const numCurtidas = Math.max(0, snapshot.val() || 0);
                
                const contadorElement = document.querySelector(`[data-post-id="${postId}"] .likes-count`);
                if (contadorElement) {
                    contadorElement.textContent = `(${numCurtidas} curtidas)`;
                }
                
                // Atualizar cache local também
                window.postCurtidas[postId] = numCurtidas;
                
            } catch (error) {
                console.error('Erro ao atualizar contador:', error);
            }
        }

        function atualizarContadorCurtidas(postId) {
            const numCurtidas = Math.max(0, window.postCurtidas[postId] || 0);
            const contadorElement = document.querySelector(`[data-post-id="${postId}"] .likes-count`);
            if (contadorElement) {
                contadorElement.textContent = `(${numCurtidas} curtidas)`;
            }
        }

        async function updateLikeStates() {
            // Atualizar visual dos botões baseado no que o usuário já curtiu no Firebase
            if (!currentUser) return;
            
            try {
                const userId = currentUser.uid;
                const userLikesRef = database.ref(`${COLLECTION_NAME}/userLikes/${userId}`);
                const snapshot = await userLikesRef.once('value');
                const userLikes = snapshot.val() || {};
                
                // Atualizar todos os botões de curtir baseado no Firebase
                Object.keys(userLikes).forEach(postId => {
                    const postCard = document.querySelector(`[data-post-id="${postId}"]`);
                    if (postCard) {
                        const curtirBtn = postCard.querySelector('.curtir-btn');
                        if (curtirBtn) {
                            curtirBtn.classList.add('curtido');
                            curtirBtn.textContent = '❤️ Curtido';
                        }
                    }
                });
                
                // Carregar contadores atualizados do Firebase
                const posts = document.querySelectorAll('[data-post-id]');
                for (const post of posts) {
                    const postId = post.dataset.postId;
                    await atualizarContadorCurtidasDoFirebase(postId);
                }
                
            } catch (error) {
                console.error('Erro ao atualizar estados dos likes:', error);
            }
        }

        // Sistema de comentários funcional
        const postComments = {
            1: [],
            2: [],
            3: []
        };

        function toggleComments(postId) {
            const commentsSection = document.getElementById(`comments-${postId}`);
            if (commentsSection.style.display === 'none') {
                commentsSection.style.display = 'block';
                loadComments(postId);
            } else {
                commentsSection.style.display = 'none';
            }
        }

        async function loadComments(postId) {
            try {
                const commentsList = document.getElementById(`comments-list-${postId}`);
                
                // Carregar comentários do Firebase
                const snapshot = await database.ref(`${COLLECTION_NAME}/comments/${postId}`).once('value');
                const commentsData = snapshot.val();
                
                let comments = [];
                if (commentsData) {
                    comments = Object.keys(commentsData).map(id => ({
                        id: id,
                        ...commentsData[id]
                    })).sort((a, b) => new Date(a.timestamp) - new Date(b.timestamp));
                }
                
                if (comments.length === 0) {
                    commentsList.innerHTML = '<div class="no-comments">💬 Seja o primeiro a comentar!</div>';
                    return;
                }
                
                commentsList.innerHTML = comments.map(comment => `
                    <div class="comment">
                        <img src="${comment.avatar}" class="comment-avatar">
                        <div class="comment-content">
                            <strong>${comment.user}</strong>
                            <p>${comment.text}</p>
                            <span class="comment-time">${formatTimeAgo(new Date(comment.timestamp))}</span>
                        </div>
                    </div>
                `).join('');
                
            } catch (error) {
                console.error('Erro ao carregar comentários:', error);
                const commentsList = document.getElementById(`comments-list-${postId}`);
                commentsList.innerHTML = '<div class="no-comments">💬 Seja o primeiro a comentar!</div>';
            }
        }

        async function addComment(postId) {
            try {
                // Verificar se o usuário está logado
                if (!currentUser) {
                    alert('❌ Você precisa fazer login para comentar!');
                    showLoginModal();
                    return;
                }
                
                const commentInput = document.getElementById(`comment-input-${postId}`);
                const commentText = commentInput.value.trim();
                
                if (!commentText) {
                    alert('⚠️ Digite um comentário!');
                    return;
                }
                
                // Criar novo comentário
                const newComment = {
                    user: getCurrentUser(),
                    avatar: getCurrentUserAvatar(),
                    text: commentText,
                    timestamp: new Date().toISOString()
                };
                
                // Salvar comentário no Firebase
                const commentRef = await database.ref(`${COLLECTION_NAME}/comments/${postId}`).push();
                await commentRef.set(newComment);
                
                // Atualizar contador de comentários no post
                const snapshot = await database.ref(`${COLLECTION_NAME}/posts/${postId}`).once('value');
                const postData = snapshot.val();
                
                if (postData) {
                    const newCommentCount = (postData.comments || 0) + 1;
                    await database.ref(`${COLLECTION_NAME}/posts/${postId}`).update({
                        comments: newCommentCount
                    });
                    
                    // Atualizar contador na UI
                    const commentCount = document.querySelector(`[data-post-id="${postId}"] .comment-count`);
                    if (commentCount) {
                        commentCount.textContent = newCommentCount;
                    }
                }
                
                // Limpar input
                commentInput.value = '';
                
                // Recarregar comentários
                loadComments(postId);
                
                console.log('Comentário adicionado:', newComment);
                
            } catch (error) {
                console.error('Erro ao adicionar comentário:', error);
                alert('❌ Erro ao adicionar comentário: ' + error.message);
            }
        }

        function handleCommentKeypress(event, postId) {
            if (event.key === 'Enter') {
                addComment(postId);
            }
        }

        // Função para formatar tempo
        function formatTimeAgo(timestamp) {
            const now = new Date();
            const diffInMinutes = Math.floor((now - timestamp) / (1000 * 60));
            
            if (diffInMinutes < 1) return 'agora';
            if (diffInMinutes < 60) return `${diffInMinutes}m`;
            
            const diffInHours = Math.floor(diffInMinutes / 60);
            if (diffInHours < 24) return `${diffInHours}h`;
            
            const diffInDays = Math.floor(diffInHours / 24);
            if (diffInDays < 7) return `${diffInDays}d`;
            
            return timestamp.toLocaleDateString('pt-BR');
        }

        // Função para atualizar formulário de criar post
        function updatePostForm() {
            const postType = document.getElementById('postType').value;
            const tournamentFields = document.getElementById('tournamentFields');
            const teamFields = document.getElementById('teamFields');
            
            // Esconder todos os campos específicos
            tournamentFields.style.display = 'none';
            teamFields.style.display = 'none';
            
            // Mostrar campos relevantes
            if (postType === 'tournament') {
                tournamentFields.style.display = 'block';
            } else if (postType === 'team') {
                teamFields.style.display = 'block';
                loadPokemonSelector();
            }
        }

        // Contador de caracteres
        document.addEventListener('DOMContentLoaded', function() {
            const textarea = document.getElementById('postContent');
            const counter = document.querySelector('.char-counter');
            
            if (textarea && counter) {
                textarea.addEventListener('input', function() {
                    const count = this.value.length;
                    counter.textContent = `${count}/500`;
                    
                    if (count > 450) {
                        counter.style.color = '#ff6b6b';
                    } else if (count > 400) {
                        counter.style.color = '#ffa726';
                    } else {
                        counter.style.color = 'rgba(255, 255, 255, 0.6)';
                    }
                });
            }
        });

        // Carregar seletor de Pokémon melhorado
        const pokemonDatabase = {
            popular: ['charizard', 'dragapult', 'grimmsnarl', 'incineroar', 'rillaboom', 'whimsicott', 'flutter-mane', 'annihilape', 'gholdengo', 'great-tusk', 'amoonguss', 'torkoal', 'garchomp', 'salamence', 'metagross', 'tyranitar'],
            legendary: ['koraidon', 'miraidon', 'zacian', 'zamazenta', 'eternatus', 'calyrex', 'kyogre', 'groudon', 'rayquaza', 'dialga', 'palkia', 'giratina', 'reshiram', 'zekrom', 'kyurem'],
            starter: ['charizard', 'blastoise', 'venusaur', 'typhlosion', 'feraligatr', 'meganium', 'blaziken', 'swampert', 'sceptile', 'infernape', 'torterra', 'empoleon', 'serperior', 'emboar', 'samurott', 'rillaboom', 'cinderace', 'inteleon'],
            all: ['charizard', 'dragapult', 'grimmsnarl', 'incineroar', 'rillaboom', 'whimsicott', 'flutter-mane', 'annihilape', 'gholdengo', 'great-tusk', 'amoonguss', 'torkoal', 'garchomp', 'salamence', 'metagross', 'tyranitar', 'koraidon', 'miraidon', 'iron-hands', 'baxcalibur', 'ting-lu', 'chi-yu', 'chien-pao', 'wo-chien', 'roaring-moon', 'iron-valiant', 'scream-tail', 'sandy-shocks', 'lucario', 'toxapex', 'landorus-therian', 'urshifu', 'regieleki', 'spectrier', 'glastrier']
        };

        function loadPokemonSelector() {
            filterByType('popular'); // Começar com populares
        }

        function filterByType(type) {
            const selector = document.getElementById('pokemonSelector');
            const filterButtons = document.querySelectorAll('.filter-btn');
            
            // Atualizar botões ativos
            filterButtons.forEach(btn => btn.classList.remove('active'));
            document.querySelector(`[data-filter="${type}"]`).classList.add('active');
            
            const pokemonList = pokemonDatabase[type] || pokemonDatabase.all;
            
            selector.innerHTML = pokemonList.map(pokemon => `
                <div class="pokemon-option ${window.selectedTeamPokemon.includes(pokemon) ? 'selected' : ''}" 
                     data-pokemon="${pokemon}"
                     onclick="selectPokemon('${pokemon}')"
                     title="${pokemon.charAt(0).toUpperCase() + pokemon.slice(1)}">
                    <img src="https://play.pokemonshowdown.com/sprites/ani/${pokemon}.gif" 
                         alt="${pokemon}" 
                         style="width: 100%; height: 100%; object-fit: contain;">
                </div>
            `).join('');
        }

        function filterPokemon() {
            const searchTerm = document.getElementById('pokemonSearch').value.toLowerCase();
            const pokemonOptions = document.querySelectorAll('.pokemon-option');
            
            pokemonOptions.forEach(option => {
                const pokemonName = option.dataset.pokemon.toLowerCase();
                if (pokemonName.includes(searchTerm)) {
                    option.style.display = 'block';
                } else {
                    option.style.display = 'none';
                }
            });
        }

        function selectPokemon(pokemon) {
            if (window.selectedTeamPokemon.length >= 6) {
                alert('⚠️ Time já tem 6 Pokémon!');
                return;
            }
            
            if (window.selectedTeamPokemon.includes(pokemon)) {
                alert('⚠️ Este Pokémon já foi selecionado!');
                return;
            }
            
            window.selectedTeamPokemon.push(pokemon);
            updateTeamDisplay();
            
            // Atualizar visualmente o seletor
            const pokemonOption = document.querySelector(`[data-pokemon="${pokemon}"]`);
            if (pokemonOption) {
                pokemonOption.classList.add('selected');
            }
        }

        function removePokemon(pokemon) {
            window.selectedTeamPokemon = window.selectedTeamPokemon.filter(p => p !== pokemon);
            updateTeamDisplay();
            
            // Atualizar visualmente o seletor
            const pokemonOption = document.querySelector(`[data-pokemon="${pokemon}"]`);
            if (pokemonOption) {
                pokemonOption.classList.remove('selected');
            }
        }

        function clearTeam() {
            if (window.selectedTeamPokemon.length === 0) {
                alert('⚠️ Time já está vazio!');
                return;
            }
            
            if (confirm('🗑️ Tem certeza que quer limpar todo o time?')) {
                // Remover classe selected de todos os Pokémon
                window.selectedTeamPokemon.forEach(pokemon => {
                    const pokemonOption = document.querySelector(`[data-pokemon="${pokemon}"]`);
                    if (pokemonOption) {
                        pokemonOption.classList.remove('selected');
                    }
                });
                
                window.selectedTeamPokemon = [];
                updateTeamDisplay();
            }
        }

        function updateTeamDisplay() {
            const teamDisplay = document.querySelector('.team-display');
            const teamInfo = document.querySelector('.selected-team p');
            
            teamInfo.textContent = `Team selecionado (${window.selectedTeamPokemon.length}/6):`;
            
            // Criar 6 slots (alguns vazios se necessário)
            const slots = [];
            for (let i = 0; i < 6; i++) {
                if (i < window.selectedTeamPokemon.length) {
                    const pokemon = window.selectedTeamPokemon[i];
                    slots.push(`
                        <div class="team-pokemon">
                            <img src="https://play.pokemonshowdown.com/sprites/ani/${pokemon}.gif" 
                                 alt="${pokemon}" 
                                 class="pokemon-sprite"
                                 title="${pokemon}">
                            <button class="remove-pokemon" onclick="removePokemon('${pokemon}')" title="Remover ${pokemon}">&times;</button>
                        </div>
                    `);
                } else {
                    slots.push('<div class="team-pokemon empty"></div>');
                }
            }
            
            teamDisplay.innerHTML = slots.join('');
        }

        // Lidar com criação de posts
        document.getElementById('createPostForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            if (this.isSubmitting) {
                console.log('🚫 Criação de post já em andamento...');
                return;
            }
            
            // Verificar se o usuário está logado
            if (!currentUser) {
                alert('❌ Você precisa fazer login para criar posts!');
                showLoginModal();
                return;
            }
            
            this.isSubmitting = true;
            const submitBtn = this.querySelector('button[type="submit"]');
            const originalText = submitBtn.textContent;
            submitBtn.textContent = 'Criando...';
            submitBtn.disabled = true;
            
            try {
                const currentUserName = getCurrentUser();
                const currentUserAvatar = getCurrentUserAvatar();
                
                console.log('Debug - currentUser:', currentUser);
                console.log('Debug - currentUserProfile:', currentUserProfile);
                console.log('Debug - currentUserName:', currentUserName);
                console.log('Debug - currentUserAvatar:', currentUserAvatar);
                console.log('Debug - localStorage user:', localStorage.getItem('userProfile'));
                
                // Validar dados essenciais
                if (!currentUserName || currentUserName === 'undefined' || currentUserName === undefined) {
                    console.error('Nome do usuário inválido:', currentUserName);
                    alert('❌ Nome do usuário não definido. Faça login ou configure seu perfil.');
                    return;
                }
                
                if (!currentUserAvatar || currentUserAvatar === 'undefined' || currentUserAvatar === undefined) {
                    console.error('Avatar do usuário inválido:', currentUserAvatar);
                    alert('❌ Avatar do usuário não definido.');
                    return;
                }
                
                const postData = {
                    type: document.getElementById('postType').value || 'text',
                    content: document.getElementById('postContent').value || '',
                    timestamp: new Date().toISOString(),
                    user: currentUserName,
                    userUID: currentUser ? currentUser.uid : null,
                    verified: currentUserProfile ? (currentUserProfile.verified || false) : false,
                    avatar: currentUserAvatar,
                    likes: 0,
                    dislikes: 0,
                    comments: 0,
                    userLiked: false,
                    userDisliked: false
                };
                
                // Validar conteúdo
                if (!postData.content.trim()) {
                    alert('❌ O post precisa ter conteúdo!');
                    return;
                }
                
                if (postData.type === 'tournament') {
                    postData.tournament = document.getElementById('tournamentName').value || '';
                    postData.placement = document.getElementById('placement').value || '';
                }
                
                if (postData.type === 'team' && window.selectedTeamPokemon && window.selectedTeamPokemon.length > 0) {
                    postData.team = [...window.selectedTeamPokemon];
                }
                
                console.log('Dados do post a serem salvos:', postData);
                
                // Salvar no Firebase
                const postRef = await database.ref(`${COLLECTION_NAME}/posts`).push();
                await postRef.set(postData);
                
                console.log('Post salvo no Firebase:', postData);
                alert('📤 Post publicado com sucesso!');
                closeModal('createPostModal');
                
                // Reset form
                document.getElementById('createPostForm').reset();
                window.selectedTeamPokemon = [];
                updateTeamDisplay();
                updatePostForm(); // Reset campos específicos
                
                // Recarregar feed do Firebase
                loadPostsFromFirebase();
                
            } catch (error) {
                console.error('Erro ao publicar post:', error);
                alert('❌ Erro ao publicar post: ' + error.message);
            } finally {
                this.isSubmitting = false;
                submitBtn.textContent = originalText;
                submitBtn.disabled = false;
            }
        });

        // Calcular prévia dos pontos em tempo real
        async function calculatePointsPreview() {
            const playerName = document.getElementById('playerName').value;
            const newPoints = parseInt(document.getElementById('newPoints').value);
            const tournamentId = document.getElementById('tournament').value;
            const previewDiv = document.getElementById('pointsPreview');
            const previewText = document.getElementById('previewText');
            
            if (!playerName || !newPoints || !tournamentId) {
                previewDiv.style.display = 'none';
                return;
            }
            
            try {
                // Buscar dados do jogador
                const snapshot = await database.ref(`${COLLECTION_NAME}/players`).once('value');
                const playersData = snapshot.val() || {};
                
                let playerData = null;
                Object.keys(playersData).forEach(id => {
                    if (playersData[id].name === playerName) {
                        playerData = playersData[id];
                    }
                });
                
                if (playerData) {
                    const currentTotal = playerData.totalPoints || 0;
                    const currentTournament = playerData.tournaments?.[tournamentId] || 0;
                    const newTotal = currentTotal - currentTournament + newPoints;
                    const difference = newPoints - currentTournament;
                    
                    let text = `Total atual: ${currentTotal} pontos<br>`;
                    text += `Torneio atual: ${currentTournament} pontos<br>`;
                    text += `Novo torneio: ${newPoints} pontos<br>`;
                    text += `<strong>Novo total: ${newTotal} pontos`;
                    
                    if (difference > 0) {
                        text += ` (+${difference})</strong>`;
                        previewDiv.style.background = 'rgba(0,255,0,0.1)';
                    } else if (difference < 0) {
                        text += ` (${difference})</strong>`;
                        previewDiv.style.background = 'rgba(255,165,0,0.1)';
                    } else {
                        text += ` (sem mudança)</strong>`;
                        previewDiv.style.background = 'rgba(128,128,128,0.1)';
                    }
                    
                    previewText.innerHTML = text;
                    previewDiv.style.display = 'block';
                } else {
                    previewText.innerHTML = `Jogador não encontrado. Será criado com ${newPoints} pontos.`;
                    previewDiv.style.background = 'rgba(0,191,255,0.1)';
                    previewDiv.style.display = 'block';
                }
                
            } catch (error) {
                console.error('Erro ao calcular prévia:', error);
                previewDiv.style.display = 'none';
            }
        }

        // Configuração do Firebase
        const firebaseConfig = {
        apiKey: "AIzaSyAexCf7hPN2OQvfsw66UDpci6nycivrK98",
        authDomain: "void-activation-system.firebaseapp.com",
        databaseURL: "https://void-activation-system-default-rtdb.firebaseio.com",
        projectId: "void-activation-system",
        storageBucket: "void-activation-system.firebasestorage.app",
        messagingSenderId: "108268095097",
        appId: "1:108268095097:web:4f45ff75a9e528b3f0f6a8",
        measurementId: "G-P71BZFRDQB"
        };
        // Inicializar Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const database = firebase.database();

        // Configuração das coleções
        const COLLECTION_NAME = 'vcgpoint';

        // Limites dos torneios
        const TOURNAMENT_LIMITS = {
            torneio1: 50,
            torneio2: 30,
            torneio3: 40,
            torneio4: 25
        };

        // ===== BACKEND COMMUNICATION =====
        const BACKEND_URL = 'http://127.0.0.1:5000'; // URL do backend Python

        // Função para fazer requisições para o backend
        async function backendRequest(endpoint, method = 'GET', data = null) {
            try {
                const config = {
                    method: method,
                    headers: {
                        'Content-Type': 'application/json',
                    }
                };

                if (data) {
                    config.body = JSON.stringify(data);
                }

                const response = await fetch(`${BACKEND_URL}${endpoint}`, config);
                const result = await response.json();

                if (!response.ok) {
                    throw new Error(result.error || 'Erro na requisição');
                }

                return result;
            } catch (error) {
                console.error('Erro na comunicação com backend:', error);
                throw error;
            }
        }

        // Verificar se backend está online
        async function checkBackendHealth() {
            try {
                const response = await fetch(`${BACKEND_URL}/health`);
                const data = await response.json();
                console.log('✅ Backend conectado:', data.status);
                return true;
            } catch (error) {
                console.warn('⚠️ Backend offline - funcionalidades admin limitadas');
                return false;
            }
        }

        // ===== ADMIN FUNCTIONS (SECURE) =====
        async function createPlayerSecure(name, points) {
            try {
                const result = await backendRequest('/api/admin/players', 'POST', {
                    name: name,
                    points: points,
                    token: 'admin_token' // Em produção, usar token JWT real
                });
                return result;
            } catch (error) {
                throw new Error('Erro ao criar jogador: ' + error.message);
            }
        }

        async function updatePointsSecure(playerName, newPoints, tournamentId) {
            try {
                const result = await backendRequest('/api/admin/points', 'PUT', {
                    playerName: playerName,
                    newPoints: newPoints,
                    tournamentId: tournamentId,
                    token: 'admin_token' // Em produção, usar token JWT real
                });
                return result;
            } catch (error) {
                throw new Error('Erro ao atualizar pontos: ' + error.message);
            }
        }

        async function addAchievementSecure(playerName, achievementType, achievementData) {
            try {
                const result = await backendRequest('/api/admin/achievements', 'POST', {
                    playerName: playerName,
                    achievementType: achievementType,
                    achievementData: achievementData,
                    token: 'admin_token' // Em produção, usar token JWT real
                });
                return result;
            } catch (error) {
                throw new Error('Erro ao adicionar conquista: ' + error.message);
            }
        }

        async function verifyAdminSecure(email) {
            try {
                const result = await backendRequest('/api/admin/verify', 'POST', {
                    email: email
                });
                return result.isAdmin;
            } catch (error) {
                console.warn('Erro na verificação de admin:', error);
                return false;
            }
        }

        // Cache para Pokémon
        let pokemonCache = {};
        let allPokemon = [];

        // Estado da aplicação
        let currentUser = null;
        let isAdmin = false;

        // Inicialização
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
        });

        function initializeApp() {
            // Verificar conectividade com backend
            checkBackendHealth();
            
            auth.onAuthStateChanged(async user => {
                currentUser = user;
                if (user) {
                    document.getElementById('logoutBtn').classList.remove('hidden');
                    document.querySelector('.auth-btn').classList.remove('hidden');
                    document.getElementById('userInfo').classList.remove('hidden');
                    document.getElementById('userEmail').textContent = user.email;
                    checkAdminStatus(user.email);
                    
                    // Verificar se usuário tem perfil
                    await checkUserProfile();
                    
                    // Atualizar estados dos likes quando usuario faz login
                    updateLikeStates();
                    
                } else {
                    document.getElementById('logoutBtn').classList.add('hidden');
                    document.querySelector('.auth-btn').classList.remove('hidden');
                    document.getElementById('userInfo').classList.add('hidden');
                    document.getElementById('adminBtn').classList.add('hidden');
                    isAdmin = false;
                    
                    // Limpar dados do perfil
                    currentUserProfile = null;
                    localStorage.removeItem('pokepoint_user_profile');
                }
            });

            // Testar conexão com Firebase
            database.ref('.info/connected').on('value', function(snapshot) {
                if (snapshot.val() === true) {
                    console.log('Conectado ao Firebase Realtime Database');
                } else {
                    console.log('Desconectado do Firebase Realtime Database');
                }
            });

            loadAllPokemon();
            loadTournamentsConfig();
            loadRankings();
        }

        async function checkAdminStatus(email) {
            try {
                // Verificar status de admin usando backend seguro
                const isAdminStatus = await verifyAdminSecure(email);
                
                if (isAdminStatus) {
                    isAdmin = true;
                    document.getElementById('adminBtn').classList.remove('hidden');
                    console.log('✅ Admin verificado via backend');
                } else {
                    isAdmin = false;
                    document.getElementById('adminBtn').classList.add('hidden');
                }
            } catch (error) {
                console.warn('⚠️ Erro na verificação de admin, usando fallback local');
                // Fallback para verificação local (apenas para desenvolvimento)
                const adminEmails = [
                    'admin@pokepoint.com', 
                    'herick@gmail.com',
                    'herick.dev@gmail.com',
                    'admin@admin.com'
                ];
                if (adminEmails.includes(email)) {
                    isAdmin = true;
                    document.getElementById('adminBtn').classList.remove('hidden');
                }
            }
        }

        // Autenticação
        function showLoginModal() {
            document.getElementById('loginModal').style.display = 'block';
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
            
            // Limpar seleção de Pokémon quando fechar modal
            if (modalId === 'playerModal') {
                selectedTeamPokemon = [];
                pokemonDisplayOffset = 50;
            }
        }

        function showRegisterForm() {
            const form = document.getElementById('loginForm');
            form.innerHTML = `
                <div class="form-group">
                    <label for="regEmail">Email:</label>
                    <input type="email" id="regEmail" required>
                </div>
                <div class="form-group">
                    <label for="regPassword">Senha:</label>
                    <input type="password" id="regPassword" required>
                </div>
                <button type="button" class="btn" onclick="register()">Criar Conta</button>
                <button type="button" class="btn" onclick="showLoginForm()">Voltar ao Login</button>
            `;
        }

        function showLoginForm() {
            const form = document.getElementById('loginForm');
            form.innerHTML = `
                <div class="form-group">
                    <label for="email">Email:</label>
                    <input type="email" id="email" required>
                </div>
                <div class="form-group">
                    <label for="password">Senha:</label>
                    <input type="password" id="password" required>
                </div>
                <button type="submit" class="btn">Entrar</button>
                <button type="button" class="btn" onclick="showRegisterForm()">Criar Conta</button>
            `;
        }

        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            if (this.isSubmitting) {
                console.log('🚫 Login já em andamento...');
                return;
            }
            
            this.isSubmitting = true;
            const submitBtn = this.querySelector('button[type="submit"]');
            const originalText = submitBtn.textContent;
            submitBtn.textContent = 'Entrando...';
            submitBtn.disabled = true;
            
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            
            auth.signInWithEmailAndPassword(email, password)
                .then(() => {
                    closeModal('loginModal');
                })
                .catch(error => {
                    alert('Erro no login: ' + error.message);
                })
                .finally(() => {
                    this.isSubmitting = false;
                    submitBtn.textContent = originalText;
                    submitBtn.disabled = false;
                });
        });

        function register() {
            const email = document.getElementById('regEmail').value;
            const password = document.getElementById('regPassword').value;
            
            auth.createUserWithEmailAndPassword(email, password)
                .then(() => {
                    closeModal('loginModal');
                })
                .catch(error => {
                    alert('Erro no registro: ' + error.message);
                });
        }

        function logout() {
            auth.signOut();
        }

        // Navegação entre abas
        function showTab(tabId) {
            // Esconder todas as abas
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Remover classe active de todos os botões
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Mostrar aba selecionada
            document.getElementById(tabId).classList.add('active');
            
            // Adicionar classe active ao botão
            event.target.classList.add('active');
        }

        // Carregar Pokémon da API
        async function loadAllPokemon() {
            try {
                console.log('Carregando Pokémon da API...');
                const loadedIds = new Set(); // Para evitar duplicatas
                
                // Carregar diretamente a lista nacional de Pokémon até a 9ª geração (mais eficiente)
                const response = await fetch('https://pokeapi.co/api/v2/pokemon?limit=1025');
                const data = await response.json();
                
                for (let pokemonInfo of data.results) {
                    try {
                        const pokemonResponse = await fetch(pokemonInfo.url);
                        const pokemonData = await pokemonResponse.json();
                        
                        // Evitar duplicatas e só incluir Pokémon com sprite
                        if (!loadedIds.has(pokemonData.id) && pokemonData.sprites.front_default) {
                            loadedIds.add(pokemonData.id);
                            pokemonCache[pokemonData.id] = {
                                id: pokemonData.id,
                                name: pokemonData.name,
                                sprite: pokemonData.sprites.front_default,
                                types: pokemonData.types.map(t => t.type.name)
                            };
                            allPokemon.push(pokemonCache[pokemonData.id]);
                        }
                    } catch (error) {
                        console.warn(`Erro ao carregar ${pokemonInfo.name}:`, error);
                    }
                }
                
                // Ordenar por ID
                allPokemon.sort((a, b) => a.id - b.id);
                
                console.log(`Pokémon únicos carregados: ${allPokemon.length}`);
            } catch (error) {
                console.error('Erro ao carregar Pokémon:', error);
            }
        }

        // Carregar rankings
        async function loadRankings() {
            // Carregar ranking geral
            await loadGeneralRanking();
            
            // Carregar rankings dos torneios
            for (let i = 1; i <= 4; i++) {
                const tournamentId = `torneio${i}`;
                const rankingContainer = document.getElementById(`ranking${i}`);
                
                try {
                    const snapshot = await database.ref(`${COLLECTION_NAME}/players`).once('value');
                    const playersData = snapshot.val() || {};
                    
                    const players = [];
                    Object.keys(playersData).forEach(playerId => {
                        const data = playersData[playerId];
                        if (data.tournaments && data.tournaments[tournamentId] && data.tournaments[tournamentId] > 0) {
                            players.push({
                                id: playerId,
                                name: data.name,
                                totalPoints: data.totalPoints || 0,
                                tournamentPoints: data.tournaments[tournamentId] || 0,
                                teams: data.teams || [],
                                rating: data.rating || 0,
                                achievements: data.achievements || []
                            });
                        }
                    });
                    
                    // Ordenar por pontuação do torneio
                    players.sort((a, b) => b.tournamentPoints - a.tournamentPoints);
                    
                    renderRanking(rankingContainer, players, tournamentId);
                } catch (error) {
                    console.error('Erro ao carregar ranking:', error);
                    rankingContainer.innerHTML = '<div class="loading">Erro ao carregar dados</div>';
                }
            }
        }

        async function loadGeneralRanking() {
            const rankingContainer = document.getElementById('rankingGeral');
            
            try {
                const snapshot = await database.ref(`${COLLECTION_NAME}/players`).once('value');
                const playersData = snapshot.val() || {};
                
                const players = [];
                Object.keys(playersData).forEach(playerId => {
                    const data = playersData[playerId];
                    if (data.totalPoints && data.totalPoints > 0) {
                        players.push({
                            id: playerId,
                            name: data.name,
                            totalPoints: data.totalPoints || 0,
                            tournaments: data.tournaments || {},
                            teams: data.teams || [],
                            rating: data.rating || 0,
                            achievements: data.achievements || []
                        });
                    }
                });
                
                // Ordenar por pontuação total
                players.sort((a, b) => b.totalPoints - a.totalPoints);
                
                renderGeneralRanking(rankingContainer, players);
            } catch (error) {
                console.error('Erro ao carregar ranking geral:', error);
                rankingContainer.innerHTML = '<div class="loading">Erro ao carregar dados</div>';
            }
        }

        function renderRanking(container, players, tournamentId) {
            if (players.length === 0) {
                container.innerHTML = '<div class="loading">Nenhum jogador registrado neste torneio</div>';
                return;
            }
            
            container.innerHTML = '';
            players.forEach((player, index) => {
                const div = document.createElement('div');
                div.className = 'player-card';
                div.innerHTML = `
                    <div class="player-info">
                        <h3>#${index + 1} - ${player.name}</h3>
                        <div class="rating">
                            ${'★'.repeat(Math.floor(player.rating))}${'☆'.repeat(5 - Math.floor(player.rating))}
                            (${player.rating.toFixed(1)})
                        </div>
                    </div>
                    <div class="player-stats">
                        <div class="tournament-points">Torneio: ${player.tournamentPoints}</div>
                        <div class="points">Total: ${player.totalPoints}</div>
                    </div>
                `;
                div.onclick = () => showPlayerDetails(player);
                container.appendChild(div);
            });
        }

        function renderGeneralRanking(container, players) {
            if (players.length === 0) {
                container.innerHTML = '<div class="loading">Nenhum jogador registrado</div>';
                return;
            }
            
            container.innerHTML = '';
            players.forEach((player, index) => {
                const div = document.createElement('div');
                div.className = 'player-card';
                
                // Criar lista de pontos por torneio
                let tournamentDetails = '';
                Object.keys(player.tournaments).forEach(tournament => {
                    const tournamentName = {
                        'torneio1': 'Alpha',
                        'torneio2': 'Beta',
                        'torneio3': 'Gamma',
                        'torneio4': 'Delta'
                    }[tournament] || tournament;
                    
                    if (player.tournaments[tournament] > 0) {
                        tournamentDetails += `<div class="tournament-points">${tournamentName}: ${player.tournaments[tournament]}</div>`;
                    }
                });
                
                div.innerHTML = `
                    <div class="player-info">
                        <h3>#${index + 1} - ${player.name}</h3>
                        <div class="rating">
                            ${'★'.repeat(Math.floor(player.rating))}${'☆'.repeat(5 - Math.floor(player.rating))}
                            (${player.rating.toFixed(1)})
                        </div>
                        <div style="margin-top: 0.5rem; display: flex; gap: 0.5rem; flex-wrap: wrap;">
                            ${tournamentDetails}
                        </div>
                    </div>
                    <div class="player-stats">
                        <div class="points">Total: ${player.totalPoints}</div>
                    </div>
                `;
                div.onclick = () => showPlayerDetails(player);
                container.appendChild(div);
            });
        }

        // Mostrar detalhes do jogador
        async function showPlayerDetails(player) {
            const modal = document.getElementById('playerModal');
            const detailsContainer = document.getElementById('playerDetails');
            
            let teamsHtml = '';
            if (player.teams && player.teams.length > 0) {
                // Ordenar times por curtidas (mais curtido no topo)
                const sortedTeams = [...player.teams].sort((a, b) => (b.likes || 0) - (a.likes || 0));
                
                teamsHtml = `
                    <div class="profile-content-section">
                        <h3 class="section-title">⚔️ Times Usados por ${player.name} <span style="color: #666; font-size: 0.9rem;">(${player.teams.length} times registrados)</span></h3>
                        <div class="teams-container">
                `;
                
                for (let team of sortedTeams) {
                    const isLiked = currentUser && team.likedBy && team.likedBy.includes(currentUser.uid);
                    const pokemonTeamHtml = await renderPokemonTeamInline(team.pokemon);
                    teamsHtml += `
                        <div class="team-card ${sortedTeams[0].id === team.id ? 'most-popular' : ''}">
                            <div class="team-header">
                                <h4>${team.name} ${sortedTeams[0].id === team.id ? '👑' : ''}</h4>
                                <div class="team-stats">
                                    <span class="likes-count">${team.likes || 0} curtidas</span>
                                    ${currentUser ? `<button class="like-btn ${isLiked ? 'liked' : ''}" onclick="toggleLike('${player.id}', '${team.id}')" title="${isLiked ? 'Descurtir' : 'Curtir'}">❤️</button>` : ''}
                                </div>
                            </div>
                            <div class="pokemon-team-grid">
                                ${pokemonTeamHtml}
                            </div>
                            ${team.submittedBy ? '<div class="team-author">Reportado por usuário</div>' : ''}
                        </div>
                    `;
                }
                
                teamsHtml += `
                        </div>
                    </div>
                `;
            } else {
                teamsHtml = `
                    <div class="profile-content-section">
                        <h3 class="section-title">⚔️ Times Usados por ${player.name}</h3>
                        <p class="no-teams">Nenhum time registrado ainda. Seja o primeiro a adicionar um time que este jogador usou contra você!</p>
                    </div>
                `;
            }
            
            detailsContainer.innerHTML = `
                <div class="modern-profile-container">
                    <div class="profile-header-card">
                        <div class="profile-avatar">
                            <div class="avatar-circle">
                                <span class="avatar-initial">${player.name.charAt(0).toUpperCase()}</span>
                            </div>
                        </div>
                        <div class="profile-main-info">
                            <h2 class="profile-name">${player.name}</h2>
                            <div class="profile-position">#${await getPlayerPosition(player.id)} • ${player.totalPoints} pontos</div>
                            <div class="profile-rating">
                                ${'★'.repeat(Math.floor(player.rating || 0))}${'☆'.repeat(5 - Math.floor(player.rating || 0))} 
                                <span class="rating-value">(${(player.rating || 0).toFixed(1)})</span>
                            </div>
                        </div>
                        <div class="profile-stats-mini">
                            <div class="stat-mini">
                                <div class="stat-mini-value">${(player.achievements || []).length}</div>
                                <div class="stat-mini-label">Conquistas</div>
                            </div>
                            <div class="stat-mini">
                                <div class="stat-mini-value">${(player.teams || []).length}</div>
                                <div class="stat-mini-label">Times</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="profile-content-grid">
                        <div class="profile-card">
                            <div class="card-header">
                                <h3>🏆 Torneios</h3>
                            </div>
                            <div class="tournaments-grid">
                                <div class="tournament-item">
                                    <div class="tournament-name" id="profile-tournament1-name">League Challenge</div>
                                    <div class="tournament-points">${player.tournaments?.torneio1 || 0}</div>
                                    <div class="tournament-limit" id="profile-tournament1-limit">/50</div>
                                </div>
                                <div class="tournament-item">
                                    <div class="tournament-name" id="profile-tournament2-name">League Cup</div>
                                    <div class="tournament-points">${player.tournaments?.torneio2 || 0}</div>
                                    <div class="tournament-limit" id="profile-tournament2-limit">/30</div>
                                </div>
                                <div class="tournament-item">
                                    <div class="tournament-name" id="profile-tournament3-name">Regional</div>
                                    <div class="tournament-points">${player.tournaments?.torneio3 || 0}</div>
                                    <div class="tournament-limit" id="profile-tournament3-limit">/40</div>
                                </div>
                                <div class="tournament-item">
                                    <div class="tournament-name" id="profile-tournament4-name">Internacional</div>
                                    <div class="tournament-points">${player.tournaments?.torneio4 || 0}</div>
                                    <div class="tournament-limit" id="profile-tournament4-limit">/25</div>
                                </div>
                            </div>
                        </div>
                        
                        ${renderModernAchievements(player.achievements || [])}
                        
                        ${currentUser ? `
                            <div class="profile-card">
                                <div class="card-header">
                                    <h3>⭐ Avaliação</h3>
                                </div>
                                <div class="rating-interactive">
                                    ${renderRatingStars(player.rating || 0, player.id)}
                                </div>
                            </div>
                        ` : ''}
                    </div>
                    
                    ${teamsHtml}
                    
                    ${currentUser ? `
                        <div class="add-team-section">
                            <button type="button" class="btn add-team-toggle-btn" onclick="toggleAddTeamForm()">
                                ➕ Adicionar Time que ${player.name} Usou Contra Você
                            </button>
                            <div id="addTeamForm" class="add-team-form" style="display: none;">
                                <h3>📝 Novo Time de ${player.name}</h3>
                                <form onsubmit="submitOpponentTeam(event, '${player.id}')">
                                    <div class="form-group">
                                        <label>Nome do time que ${player.name} usou:</label>
                                        <input type="text" id="opponentTeamName" placeholder="Ex: Time Dragão, Balanced Team, etc." required>
                                    </div>
                                    <div id="opponentPokemonSelection"></div>
                                    <div class="form-actions">
                                        <button type="submit" class="btn btn-primary">Salvar Time</button>
                                        <button type="button" class="btn btn-secondary" onclick="toggleAddTeamForm()">Cancelar</button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    ` : `
                        <div class="login-prompt">
                            <p>Faça login para adicionar times que ${player.name} usou contra você!</p>
                            <button class="btn" onclick="showLoginModal()">Fazer Login</button>
                        </div>
                    `}
                </div>
            `;
            
            if (currentUser) {
                setupOpponentPokemonSelection();
            }
            
            modal.style.display = 'block';
        }

        async function renderPokemonTeam(pokemonIds) {
            let html = '<div class="pokemon-team">';
            for (let id of pokemonIds) {
                if (pokemonCache[id]) {
                    const pokemon = pokemonCache[id];
                    html += `
                        <div class="pokemon-card">
                            <img src="${pokemon.sprite}" alt="${pokemon.name}">
                            <div class="pokemon-name">${pokemon.name}</div>
                        </div>
                    `;
                }
            }
            html += '</div>';
            return html;
        }

        async function renderPokemonTeamInline(pokemonIds) {
            console.log('Renderizando time com IDs:', pokemonIds);
            console.log('PokemonCache size:', Object.keys(pokemonCache).length);
            
            let html = '';
            for (let id of pokemonIds) {
                if (pokemonCache[id]) {
                    const pokemon = pokemonCache[id];
                    html += `
                        <div class="pokemon-mini" title="${pokemon.name}">
                            <img src="${pokemon.sprite}" alt="${pokemon.name}">
                        </div>
                    `;
                } else {
                    console.warn(`Pokemon com ID ${id} não encontrado no cache`);
                    // Tentar carregar o pokemon individualmente se não estiver no cache
                    try {
                        const response = await fetch(`https://pokeapi.co/api/v2/pokemon/${id}`);
                        const pokemonData = await response.json();
                        
                        if (pokemonData.sprites.front_default) {
                            pokemonCache[pokemonData.id] = {
                                id: pokemonData.id,
                                name: pokemonData.name,
                                sprite: pokemonData.sprites.front_default,
                                types: pokemonData.types.map(t => t.type.name)
                            };
                            
                            const pokemon = pokemonCache[pokemonData.id];
                            html += `
                                <div class="pokemon-mini" title="${pokemon.name}">
                                    <img src="${pokemon.sprite}" alt="${pokemon.name}">
                                </div>
                            `;
                        }
                    } catch (error) {
                        console.error(`Erro ao carregar Pokemon ${id}:`, error);
                        // Mostrar placeholder para pokemon não encontrado
                        html += `
                            <div class="pokemon-mini pokemon-missing" title="Pokémon #${id} não encontrado">
                                <span>?</span>
                            </div>
                        `;
                    }
                }
            }
            return html;
        }

        function renderRatingStars(currentRating, playerId) {
            console.log('Renderizando estrelas para jogador:', playerId, 'rating atual:', currentRating);
            let html = `
                <div class="rating-instruction">Clique nas estrelas para avaliar este jogador</div>
                <div class="rating">
            `;
            for (let i = 1; i <= 5; i++) {
                const active = i <= Math.floor(currentRating) ? 'active' : '';
                html += `<span class="star ${active}" onclick="ratePlayer('${playerId}', ${i})" title="Avaliar com ${i} estrela${i > 1 ? 's' : ''} - ${getStarDescription(i)}">★</span>`;
            }
            html += `
                </div>
                <div class="current-rating">Avaliação atual: ${currentRating.toFixed(1)}/5.0</div>
            `;
            console.log('HTML das estrelas gerado:', html);
            return html;
        }

        function getStarDescription(stars) {
            const descriptions = {
                1: "Muito ruim",
                2: "Ruim", 
                3: "Regular",
                4: "Bom",
                5: "Excelente"
            };
            return descriptions[stars] || "";
        }

        function togglePointsFields() {
            const action = document.getElementById('pointsAction').value;
            const addFields = document.getElementById('addPointsFields');
            const setFields = document.getElementById('setPointsFields');
            const addPointsInput = document.getElementById('miscPoints');
            const setPointsInput = document.getElementById('newTotalPoints');
            
            if (action === 'add') {
                addFields.style.display = 'block';
                setFields.style.display = 'none';
                addPointsInput.required = true;
                setPointsInput.required = false;
            } else {
                addFields.style.display = 'none';
                setFields.style.display = 'block';
                addPointsInput.required = false;
                setPointsInput.required = true;
            }
        }

        function renderAchievements(achievements) {
            if (!achievements || achievements.length === 0) {
                return `
                    <div class="profile-content-section">
                        <h3 class="section-title">🏆 Conquistas</h3>
                        <div class="no-achievements">Nenhuma conquista ainda. Continue jogando para desbloquear prêmios!</div>
                    </div>
                `;
            }

            const achievementTemplates = {
                'tournament_winner': { icon: '🏆', title: 'Campeão de Torneio', description: 'Venceu um torneio oficial' },
                'tournament_runner_up': { icon: '🥈', title: 'Vice-Campeão', description: 'Ficou em 2º lugar em um torneio' },
                'tournament_semifinalist': { icon: '🥉', title: 'Semifinalista', description: 'Chegou às semifinais de um torneio' },
                'first_victory': { icon: '⭐', title: 'Primeira Vitória', description: 'Conquistou sua primeira vitória oficial' },
                'streak_5': { icon: '🔥', title: '5 Vitórias Seguidas', description: 'Venceu 5 partidas consecutivas' },
                'streak_10': { icon: '🔥', title: '10 Vitórias Seguidas', description: 'Venceu 10 partidas consecutivas' },
                'points_milestone_50': { icon: '💯', title: '50 Pontos', description: 'Alcançou 50 pontos totais' },
                'points_milestone_100': { icon: '💯', title: '100 Pontos', description: 'Alcançou 100 pontos totais' },
                'team_creator': { icon: '📝', title: 'Criador de Times', description: 'Contribuiu com times para a comunidade' },
                'community_favorite': { icon: '❤️', title: 'Favorito da Comunidade', description: 'Recebeu muitas curtidas da comunidade' },
                'veteran_player': { icon: '🎖️', title: 'Jogador Veterano', description: 'Membro ativo da comunidade há muito tempo' }
            };

            let html = `
                <div class="profile-content-section">
                    <h3 class="section-title">🏆 Conquistas <span style="color: #666; font-size: 0.9rem;">(${achievements.length} desbloqueadas)</span></h3>
                    <div class="achievements-grid">
            `;

            achievements.forEach(achievement => {
                const template = achievementTemplates[achievement.type] || {
                    icon: achievement.icon || '🎗️',
                    title: achievement.title || 'Conquista Especial',
                    description: achievement.description || 'Conquista personalizada'
                };

                html += `
                    <div class="achievement-card earned">
                        <div class="achievement-icon">${template.icon}</div>
                        <div class="achievement-title">${template.title}</div>
                        <div class="achievement-description">${template.description}</div>
                        ${achievement.tournament ? `<div class="achievement-description">Torneio: ${achievement.tournament}</div>` : ''}
                        <div class="achievement-date">${new Date(achievement.dateEarned).toLocaleDateString('pt-BR')}</div>
                    </div>
                `;
            });

            html += `
                    </div>
                </div>
            `;

            return html;
        }

        function renderModernAchievements(achievements) {
            if (!achievements || achievements.length === 0) {
                return `
                    <div class="profile-card">
                        <div class="card-header">
                            <h3>🏆 Conquistas</h3>
                        </div>
                        <div class="no-content">
                            <p>Nenhuma conquista ainda</p>
                            <small>Continue jogando para desbloquear!</small>
                        </div>
                    </div>
                `;
            }

            return `
                <div class="profile-card">
                    <div class="card-header">
                        <h3>🏆 Conquistas</h3>
                        <span class="card-badge">${achievements.length}</span>
                    </div>
                    <div class="achievements-compact">
                        ${achievements.slice(0, 3).map(achievement => {
                            const templates = {
                                'tournament_winner': '🏆',
                                'tournament_runner_up': '🥈',
                                'tournament_semifinalist': '🥉',
                                'first_victory': '⭐',
                                'streak_5': '🔥',
                                'streak_10': '🔥',
                                'points_milestone_50': '💯',
                                'points_milestone_100': '💯',
                                'team_creator': '📝',
                                'community_favorite': '❤️',
                                'veteran_player': '🎖️'
                            };
                            const icon = templates[achievement.type] || achievement.icon || '🎗️';
                            return `<div class="achievement-mini" title="${achievement.type}">${icon}</div>`;
                        }).join('')}
                        ${achievements.length > 3 ? `<div class="achievement-more">+${achievements.length - 3}</div>` : ''}
                    </div>
                </div>
            `;
        }

        async function getPlayerPosition(playerId) {
            try {
                const snapshot = await database.ref(`${COLLECTION_NAME}/players`).once('value');
                const playersData = snapshot.val() || {};
                
                const players = [];
                Object.keys(playersData).forEach(id => {
                    const data = playersData[id];
                    if (data.totalPoints && data.totalPoints > 0) {
                        players.push({
                            id: id,
                            totalPoints: data.totalPoints || 0
                        });
                    }
                });
                
                players.sort((a, b) => b.totalPoints - a.totalPoints);
                const position = players.findIndex(p => p.id === playerId) + 1;
                return position || '-';
            } catch (error) {
                return '-';
            }
        }

        async function ratePlayer(playerId, rating) {
            console.log('Tentando avaliar jogador:', playerId, 'com rating:', rating);
            console.log('Current user:', currentUser);
            
            if (!currentUser) {
                alert('Você precisa estar logado para avaliar um jogador!');
                return;
            }
            
            try {
                console.log('Salvando avaliação...');
                // Salvar avaliação individual
                await database.ref(`${COLLECTION_NAME}/ratings/${playerId}/${currentUser.uid}`).set({
                    rating: rating,
                    userId: currentUser.uid,
                    userEmail: currentUser.email,
                    timestamp: new Date().toISOString()
                });
                
                console.log('Avaliação salva, recalculando média...');
                // Recalcular média
                const ratingsSnapshot = await database.ref(`${COLLECTION_NAME}/ratings/${playerId}`).once('value');
                const ratingsData = ratingsSnapshot.val() || {};
                
                let totalRating = 0;
                let count = 0;
                
                Object.values(ratingsData).forEach(ratingData => {
                    totalRating += ratingData.rating;
                    count++;
                });
                
                const averageRating = count > 0 ? totalRating / count : 0;
                console.log('Nova média calculada:', averageRating);
                
                await database.ref(`${COLLECTION_NAME}/players/${playerId}/rating`).set(averageRating);
                
                // Recarregar dados
                loadRankings();
                
                // Atualizar stars na modal
                document.querySelectorAll('.star').forEach((star, index) => {
                    star.classList.toggle('active', index < rating);
                });
                
                alert(`Avaliação de ${rating} estrelas salva com sucesso!`);
                
            } catch (error) {
                console.error('Erro ao avaliar jogador:', error);
                alert('Erro ao avaliar jogador: ' + error.message);
            }
        }

        async function toggleLike(playerId, teamId) {
            if (!currentUser) return;
            
            try {
                const playerSnapshot = await database.ref(`${COLLECTION_NAME}/players/${playerId}`).once('value');
                const playerData = playerSnapshot.val();
                
                if (!playerData) return;
                
                const teams = playerData.teams || [];
                const teamIndex = teams.findIndex(t => t.id === teamId);
                
                if (teamIndex !== -1) {
                    const team = teams[teamIndex];
                    const likedBy = team.likedBy || [];
                    const userIndex = likedBy.indexOf(currentUser.uid);
                    
                    if (userIndex > -1) {
                        likedBy.splice(userIndex, 1);
                        team.likes = Math.max((team.likes || 1) - 1, 0);
                    } else {
                        likedBy.push(currentUser.uid);
                        team.likes = (team.likes || 0) + 1;
                    }
                    
                    team.likedBy = likedBy;
                    teams[teamIndex] = team;
                    
                    await database.ref(`${COLLECTION_NAME}/players/${playerId}/teams`).set(teams);
                    
                    // Recarregar modal
                    const updatedSnapshot = await database.ref(`${COLLECTION_NAME}/players/${playerId}`).once('value');
                    showPlayerDetails({ id: playerId, ...updatedSnapshot.val() });
                }
            } catch (error) {
                console.error('Erro ao curtir time:', error);
                alert('Erro ao curtir time: ' + error.message);
            }
        }

        // Configurações de Torneios
        let tournamentsConfig = {
            torneio1: { name: "League Challenge", limit: 50 },
            torneio2: { name: "League Cup", limit: 30 },
            torneio3: { name: "Regional", limit: 40 },
            torneio4: { name: "Internacional", limit: 25 }
        };

        async function loadTournamentsConfig() {
            try {
                const snapshot = await database.ref(`${COLLECTION_NAME}/tournaments_config`).once('value');
                const config = snapshot.val();
                
                if (config) {
                    tournamentsConfig = config;
                    updateTournamentSelects();
                    updateTournamentConfigForm();
                }
            } catch (error) {
                console.error('Erro ao carregar configurações dos torneios:', error);
            }
        }

        function updateTournamentSelects() {
            // Atualizar select de torneio no formulário de pontos
            const tournamentSelect = document.getElementById('tournament');
            if (tournamentSelect) {
                tournamentSelect.innerHTML = `
                    <option value="torneio1">${tournamentsConfig.torneio1.name} (Limite: ${tournamentsConfig.torneio1.limit})</option>
                    <option value="torneio2">${tournamentsConfig.torneio2.name} (Limite: ${tournamentsConfig.torneio2.limit})</option>
                    <option value="torneio3">${tournamentsConfig.torneio3.name} (Limite: ${tournamentsConfig.torneio3.limit})</option>
                    <option value="torneio4">${tournamentsConfig.torneio4.name} (Limite: ${tournamentsConfig.torneio4.limit})</option>
                `;
            }

            // Atualizar select de torneio no formulário de conquistas
            const achievementTournamentSelect = document.getElementById('achievementTournament');
            if (achievementTournamentSelect) {
                achievementTournamentSelect.innerHTML = `
                    <option value="">Não específico</option>
                    <option value="torneio1">${tournamentsConfig.torneio1.name}</option>
                    <option value="torneio2">${tournamentsConfig.torneio2.name}</option>
                    <option value="torneio3">${tournamentsConfig.torneio3.name}</option>
                    <option value="torneio4">${tournamentsConfig.torneio4.name}</option>
                `;
            }

            // Atualizar botões das abas
            const tabButtons = {
                'tab-torneio1': tournamentsConfig.torneio1.name,
                'tab-torneio2': tournamentsConfig.torneio2.name,
                'tab-torneio3': tournamentsConfig.torneio3.name,
                'tab-torneio4': tournamentsConfig.torneio4.name
            };

            Object.keys(tabButtons).forEach(buttonId => {
                const button = document.getElementById(buttonId);
                if (button) {
                    button.textContent = tabButtons[buttonId];
                }
            });

            // Atualizar títulos dos rankings
            const rankingTitles = {
                'ranking-title-torneio1': `Ranking - ${tournamentsConfig.torneio1.name}`,
                'ranking-title-torneio2': `Ranking - ${tournamentsConfig.torneio2.name}`,
                'ranking-title-torneio3': `Ranking - ${tournamentsConfig.torneio3.name}`,
                'ranking-title-torneio4': `Ranking - ${tournamentsConfig.torneio4.name}`
            };

            Object.keys(rankingTitles).forEach(titleId => {
                const title = document.getElementById(titleId);
                if (title) {
                    title.textContent = rankingTitles[titleId];
                }
            });

            // Atualizar limites de pontos
            const limits = {
                'limit-torneio1': `Limite de Pontos: ${tournamentsConfig.torneio1.limit}`,
                'limit-torneio2': `Limite de Pontos: ${tournamentsConfig.torneio2.limit}`,
                'limit-torneio3': `Limite de Pontos: ${tournamentsConfig.torneio3.limit}`,
                'limit-torneio4': `Limite de Pontos: ${tournamentsConfig.torneio4.limit}`
            };

            Object.keys(limits).forEach(limitId => {
                const limit = document.getElementById(limitId);
                if (limit) {
                    limit.textContent = limits[limitId];
                }
            });
        }

        function updateTournamentConfigForm() {
            document.getElementById('tournament1Name').value = tournamentsConfig.torneio1.name;
            document.getElementById('tournament1Limit').value = tournamentsConfig.torneio1.limit;
            document.getElementById('tournament2Name').value = tournamentsConfig.torneio2.name;
            document.getElementById('tournament2Limit').value = tournamentsConfig.torneio2.limit;
            document.getElementById('tournament3Name').value = tournamentsConfig.torneio3.name;
            document.getElementById('tournament3Limit').value = tournamentsConfig.torneio3.limit;
            document.getElementById('tournament4Name').value = tournamentsConfig.torneio4.name;
            document.getElementById('tournament4Limit').value = tournamentsConfig.torneio4.limit;
        }

        // Painel Admin Expandido
        function showAdminPanel() {
            if (!isAdmin) return;
            console.log('Abrindo painel admin...');
            document.getElementById('adminModal').style.display = 'block';
            console.log('Modal aberto, mostrando aba de verificação...');
            showAdminTab('verification'); // Mostrar aba de verificações por padrão
            console.log('Aba de verificação carregada');
        }

        // Gerenciar abas do admin
        function showAdminTab(tabName) {
            console.log('Mostrando aba:', tabName);
            
            // Esconder todas as abas
            const tabs = document.querySelectorAll('.admin-tab-content');
            console.log('Abas encontradas:', tabs.length);
            tabs.forEach(tab => tab.classList.remove('active'));
            
            // Remover classe active dos botões
            const buttons = document.querySelectorAll('.admin-tab-btn');
            console.log('Botões encontrados:', buttons.length);
            buttons.forEach(btn => btn.classList.remove('active'));
            
            // Mostrar aba selecionada
            const targetTab = document.getElementById('adminTab' + tabName.charAt(0).toUpperCase() + tabName.slice(1));
            console.log('Aba alvo:', targetTab);
            if (targetTab) {
                targetTab.classList.add('active');
                console.log('Aba ativada:', targetTab.id);
            } else {
                console.error('Aba não encontrada!');
            }
            
            // Ativar botão correspondente
            const targetButton = document.querySelector(`[onclick="showAdminTab('${tabName}')"]`);
            console.log('Botão alvo:', targetButton);
            if (targetButton) {
                targetButton.classList.add('active');
            }
            
            // Carregar dados específicos da aba
            if (tabName === 'verification') {
                console.log('Carregando dados de verificação...');
                loadVerificationRequests();
            }
        }

        // Carregar solicitações de verificação
        function loadVerificationRequests() {
            const container = document.getElementById('verificationRequests');
            if (!container) {
                console.error('Container verificationRequests não encontrado!');
                return;
            }
            
            console.log('Carregando solicitações de verificação...');
            
            // Buscar solicitações no localStorage
            const requests = [];
            const allKeys = Object.keys(localStorage);
            console.log('Total de chaves no localStorage:', allKeys.length);
            console.log('Chaves que começam com verificationRequest_:', allKeys.filter(k => k.startsWith('verificationRequest_')));
            
            Object.keys(localStorage).forEach(key => {
                if (key.startsWith('verificationRequest_')) {
                    try {
                        const request = JSON.parse(localStorage.getItem(key));
                        request.id = key.replace('verificationRequest_', '');
                        requests.push(request);
                        console.log('Solicitação carregada:', request);
                    } catch (e) {
                        console.error('Erro ao carregar solicitação:', e);
                    }
                }
            });
            
            console.log('Total de solicitações encontradas:', requests.length);
            
            // Filtrar apenas pendentes
            const pendingRequests = requests.filter(req => req.status === 'pending');
            console.log('Solicitações pendentes:', pendingRequests.length);
            
            if (pendingRequests.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 20px; color: #666;">
                        <h4>📭 Nenhuma solicitação pendente</h4>
                        <p>Todas as verificações foram processadas.</p>
                        <br>
                        <button class="btn" onclick="createTestVerification()" style="background: #74b9ff; color: white;">
                            🧪 Criar Solicitação de Teste
                        </button>
                        <small style="display: block; margin-top: 10px; color: #999;">
                            Clique acima para criar uma solicitação de exemplo para testar o sistema.
                        </small>
                    </div>
                `;
                return;
            }
            
            // Renderizar solicitações
            container.innerHTML = pendingRequests.map(request => `
                <div class="verification-request pending" id="request-${request.id}">
                    <h4>
                        🔐 Solicitação #${request.id}
                        <span class="verification-status pending">⏳ Pendente</span>
                    </h4>
                    
                    <div class="verification-details">
                        <div class="verification-detail">
                            <strong>👤 Usuário:</strong> ${request.userId || 'N/A'}
                        </div>
                        <div class="verification-detail">
                            <strong>📝 Nome Real:</strong> ${request.realName || 'N/A'}
                        </div>
                        <div class="verification-detail">
                            <strong>📧 Email:</strong> ${request.email || 'N/A'}
                        </div>
                        <div class="verification-detail">
                            <strong>🆔 RG:</strong> ${request.rg || 'N/A'}
                        </div>
                        <div class="verification-detail">
                            <strong>🎮 Nome VGC:</strong> ${request.playerName || 'N/A'}
                        </div>
                        <div class="verification-detail">
                            <strong>📅 Nascimento:</strong> ${request.birthDate || 'N/A'}
                        </div>
                        <div class="verification-detail">
                            <strong>🏙️ Cidade:</strong> ${request.city || 'N/A'}
                        </div>
                        <div class="verification-detail">
                            <strong>🎯 Pokémon ID:</strong> ${request.pokemonId || 'Não informado'}
                        </div>
                    </div>
                    
                    <div class="verification-detail" style="grid-column: 1 / -1; margin-top: 10px;">
                        <strong>🏆 Torneios/Conquistas:</strong><br>
                        ${request.tournaments || 'N/A'}
                    </div>
                    
                    <div class="verification-detail" style="grid-column: 1 / -1;">
                        <strong>📅 Data da Solicitação:</strong> ${new Date(request.timestamp).toLocaleString('pt-BR')}
                    </div>
                    
                    <div class="verification-actions">
                        <button class="btn-approve" onclick="approveVerification('${request.id}', '${request.userId}', '${request.playerName}')">
                            ✅ Aprovar & Vincular
                        </button>
                        <button class="btn-reject" onclick="rejectVerification('${request.id}', '${request.userId}')">
                            ❌ Rejeitar
                        </button>
                    </div>
                </div>
            `).join('');
        }

        // Aprovar verificação e vincular conta
        function approveVerification(requestId, userId, playerName) {
            if (!confirm(`Confirma a aprovação da verificação?\n\nUsuário: ${userId}\nJogador VGC: ${playerName}\n\nIsso vai vincular a conta permanentemente.`)) {
                return;
            }
            
            try {
                // Atualizar status da solicitação
                const requestKey = 'verificationRequest_' + requestId;
                const request = JSON.parse(localStorage.getItem(requestKey));
                request.status = 'approved';
                request.approvedAt = new Date().toISOString();
                localStorage.setItem(requestKey, JSON.stringify(request));
                
                // Criar/atualizar perfil vinculado
                const linkedProfile = {
                    userId: userId,
                    playerName: playerName,
                    realName: request.realName,
                    email: request.email,
                    rg: request.rg,
                    birthDate: request.birthDate,
                    city: request.city,
                    pokemonId: request.pokemonId,
                    tournaments: request.tournaments,
                    verified: true,
                    verifiedAt: new Date().toISOString(),
                    verificationId: requestId
                };
                
                // Salvar perfil vinculado
                localStorage.setItem('linkedProfile_' + userId, JSON.stringify(linkedProfile));
                
                // Atualizar status de verificação do usuário
                localStorage.setItem('userVerificationStatus_' + userId, 'approved');
                
                alert(`✅ Verificação aprovada com sucesso!\n\n👤 Usuário: ${userId}\n🎮 Jogador VGC: ${playerName}\n\nA conta foi vinculada permanentemente.`);
                
                // Recarregar lista
                loadVerificationRequests();
                
            } catch (error) {
                console.error('Erro ao aprovar verificação:', error);
                alert('❌ Erro ao aprovar verificação: ' + error.message);
            }
        }

        // Rejeitar verificação
        function rejectVerification(requestId, userId) {
            const reason = prompt('Motivo da rejeição (opcional):');
            
            if (!confirm(`Confirma a rejeição da verificação?\n\nUsuário: ${userId}\n\nO usuário poderá tentar novamente.`)) {
                return;
            }
            
            try {
                // Atualizar status da solicitação
                const requestKey = 'verificationRequest_' + requestId;
                const request = JSON.parse(localStorage.getItem(requestKey));
                request.status = 'rejected';
                request.rejectedAt = new Date().toISOString();
                request.rejectionReason = reason || 'Dados insuficientes ou incorretos';
                localStorage.setItem(requestKey, JSON.stringify(request));
                
                // Atualizar status de verificação do usuário
                localStorage.setItem('userVerificationStatus_' + userId, 'rejected');
                localStorage.setItem('userRejectionReason_' + userId, reason || 'Dados insuficientes ou incorretos');
                
                alert(`❌ Verificação rejeitada.\n\nUsuário: ${userId}\nMotivo: ${reason || 'Dados insuficientes ou incorretos'}\n\nO usuário pode tentar novamente.`);
                
                // Recarregar lista
                loadVerificationRequests();
                
            } catch (error) {
                console.error('Erro ao rejeitar verificação:', error);
                alert('❌ Erro ao rejeitar verificação: ' + error.message);
            }
        }

        // Criar solicitação de teste para demonstração
        function createTestVerification() {
            const testRequest = {
                userId: 'TestUser123',
                realName: 'João Silva Santos',
                email: 'joao.silva@email.com',
                rg: '12.345.678-9',
                playerName: 'JoaoVGC',
                birthDate: '1995-03-15',
                city: 'São Paulo',
                pokemonId: 'PKMN123456',
                tournaments: 'Regional SP 2024 (Top 8), League Cup RJ 2024 (1º lugar), Various League Challenges',
                timestamp: new Date().toISOString(),
                status: 'pending',
                requestType: 'player_verification'
            };
            
            const testId = Date.now();
            localStorage.setItem('verificationRequest_' + testId, JSON.stringify(testRequest));
            
            alert('✅ Solicitação de teste criada!\n\nAgora você pode ver como funciona o sistema de aprovação.');
            
            // Recarregar a lista
            loadVerificationRequests();
        }

        document.getElementById('pointsForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            if (this.isSubmitting) {
                console.log('🚫 Submissão de pontos já em andamento...');
                return;
            }
            
            this.isSubmitting = true;
            const submitBtn = this.querySelector('button[type="submit"]');
            const originalText = submitBtn.textContent;
            submitBtn.textContent = 'Atualizando...';
            submitBtn.disabled = true;
            
            const playerName = document.getElementById('playerName').value;
            const newTournamentPoints = parseInt(document.getElementById('newPoints').value);
            const tournamentId = document.getElementById('tournament').value;
            
            try {
                // Usar backend seguro para atualizar pontos
                const result = await updatePointsSecure(playerName, newTournamentPoints, tournamentId);
                
                if (result.success) {
                    const data = result.data;
                    let message = `Pontuação atualizada com sucesso!\n\n`;
                    message += `${data.tournament}: ${data.oldTournamentPoints} → ${data.newTournamentPoints}`;
                    
                    const difference = data.newTotalPoints - data.oldTotalPoints;
                    if (difference > 0) {
                        message += ` (+${difference})`;
                    } else if (difference < 0) {
                        message += ` (${difference})`;
                    }
                    
                    message += `\nTotal geral: ${data.oldTotalPoints} → ${data.newTotalPoints}`;
                    message += `\nLimite do torneio: ${data.limit} pontos`;
                    
                    alert(message);
                    document.getElementById('pointsForm').reset();
                    loadRankings();
                } else {
                    throw new Error(result.error || 'Erro desconhecido');
                }
                
            } catch (error) {
                console.error('Erro ao atualizar pontuação:', error);
                alert('❌ Erro ao atualizar pontuação: ' + error.message);
            } finally {
                this.isSubmitting = false;
                submitBtn.textContent = originalText;
                submitBtn.disabled = false;
            }
        });

        document.addEventListener('DOMContentLoaded', function() {
            const createPlayerForm = document.getElementById('createPlayerForm');
            if (createPlayerForm) {
                let isSubmitting = false; // Flag para evitar múltiplas submissões
                createPlayerForm.addEventListener('submit', async function(e) {
                    e.preventDefault();
                    
                    if (isSubmitting) {
                        console.log('🚫 Criação de jogador já em andamento...');
                        return;
                    }
                    
                    isSubmitting = true;
                    const submitBtn = this.querySelector('button[type="submit"]');
                    const originalText = submitBtn.textContent;
                    submitBtn.textContent = 'Criando...';
                    submitBtn.disabled = true;
                    
                    const name = document.getElementById('newPlayerName').value;
                    const points = parseInt(document.getElementById('newPlayerPoints').value);
                    
                    try {
                        // Usar backend seguro para criar jogador
                        const result = await createPlayerSecure(name, points);
                        
                        if (result.success) {
                            alert('✅ Jogador criado com sucesso!');
                            document.getElementById('createPlayerForm').reset();
                            loadRankings();
                        } else {
                            throw new Error(result.error || 'Erro desconhecido');
                        }
                        
                    } catch (error) {
                        console.error('Erro ao criar jogador:', error);
                        alert('❌ Erro ao criar jogador: ' + error.message);
                    } finally {
                        isSubmitting = false;
                        submitBtn.textContent = originalText;
                        submitBtn.disabled = false;
                    }
                });
            }

            // Listener para mudança no tipo de conquista
            const achievementType = document.getElementById('achievementType');
            if (achievementType) {
                achievementType.addEventListener('change', function() {
                    const customFields = document.getElementById('customAchievementFields');
                    if (this.value === 'custom') {
                        customFields.style.display = 'block';
                    } else {
                        customFields.style.display = 'none';
                    }
                });
            }

            // Form para gerenciar conquistas
            const achievementForm = document.getElementById('achievementForm');
            if (achievementForm) {
                achievementForm.addEventListener('submit', async function(e) {
                    e.preventDefault();
                    const playerName = document.getElementById('achievementPlayerName').value;
                    const achievementType = document.getElementById('achievementType').value;
                    const tournament = document.getElementById('achievementTournament').value;

                    try {
                        // Buscar jogador
                        const snapshot = await database.ref(`${COLLECTION_NAME}/players`).once('value');
                        const playersData = snapshot.val() || {};
                        
                        let playerId = null;
                        let playerData = null;
                        
                        Object.keys(playersData).forEach(id => {
                            if (playersData[id].name === playerName) {
                                playerId = id;
                                playerData = playersData[id];
                            }
                        });
                        
                        if (!playerData) {
                            alert('Jogador não encontrado!');
                            return;
                        }

                        const achievements = playerData.achievements || [];
                        
                        // Verificar se já tem essa conquista
                        const existingAchievement = achievements.find(a => 
                            a.type === achievementType && 
                            (!tournament || a.tournament === tournament)
                        );
                        
                        if (existingAchievement) {
                            alert('Este jogador já possui essa conquista!');
                            return;
                        }

                        let newAchievement = {
                            type: achievementType,
                            dateEarned: new Date().toISOString()
                        };

                        if (tournament) {
                            newAchievement.tournament = tournament;
                        }

                        // Se for conquista personalizada, adicionar campos customizados
                        if (achievementType === 'custom') {
                            newAchievement.title = document.getElementById('customTitle').value;
                            newAchievement.description = document.getElementById('customDescription').value;
                            newAchievement.icon = document.getElementById('customIcon').value;
                        }

                        achievements.push(newAchievement);
                        
                        await database.ref(`${COLLECTION_NAME}/players/${playerId}/achievements`).set(achievements);
                        
                        alert('Conquista concedida com sucesso!');
                        achievementForm.reset();
                        document.getElementById('customAchievementFields').style.display = 'none';
                        
                    } catch (error) {
                        console.error('Erro ao conceder conquista:', error);
                        alert('Erro ao conceder conquista: ' + error.message);
                    }
                });
            }

            // Form para configurar torneios
            const tournamentConfigForm = document.getElementById('tournamentConfigForm');
            if (tournamentConfigForm) {
                tournamentConfigForm.addEventListener('submit', async function(e) {
                    e.preventDefault();
                    
                    try {
                        // Salvar configurações dos torneios no Firebase
                        const tournamentsConfig = {
                            torneio1: {
                                name: document.getElementById('tournament1Name').value,
                                limit: parseInt(document.getElementById('tournament1Limit').value)
                            },
                            torneio2: {
                                name: document.getElementById('tournament2Name').value,
                                limit: parseInt(document.getElementById('tournament2Limit').value)
                            },
                            torneio3: {
                                name: document.getElementById('tournament3Name').value,
                                limit: parseInt(document.getElementById('tournament3Limit').value)
                            },
                            torneio4: {
                                name: document.getElementById('tournament4Name').value,
                                limit: parseInt(document.getElementById('tournament4Limit').value)
                            }
                        };
                        
                        await database.ref(`${COLLECTION_NAME}/tournaments_config`).set(tournamentsConfig);
                        
                        alert('Configurações dos torneios salvas com sucesso!');
                        
                        // Atualizar os selects de torneio
                        updateTournamentSelects();
                        
                        // Recarregar rankings para mostrar nomes atualizados
                        loadRankings();
                        
                    } catch (error) {
                        console.error('Erro ao salvar configurações:', error);
                        alert('Erro ao salvar configurações: ' + error.message);
                    }
                });
            }

            // Form para adicionar pontos diversos/lojinha
            const miscPointsForm = document.getElementById('miscPointsForm');
            if (miscPointsForm) {
                miscPointsForm.addEventListener('submit', async function(e) {
                    e.preventDefault();
                    
                    const playerName = document.getElementById('miscPlayerName').value;
                    const action = document.getElementById('pointsAction').value;
                    const reason = document.getElementById('miscReason').value;
                    
                    let pointsToAdd = 0;
                    let newTotal = 0;
                    
                    if (action === 'add') {
                        pointsToAdd = parseInt(document.getElementById('miscPoints').value);
                    } else {
                        newTotal = parseInt(document.getElementById('newTotalPoints').value);
                    }
                    
                    try {
                        // Buscar jogador
                        const snapshot = await database.ref(`${COLLECTION_NAME}/players`).once('value');
                        const playersData = snapshot.val() || {};
                        
                        let playerId = null;
                        let playerData = null;
                        
                        Object.keys(playersData).forEach(id => {
                            if (playersData[id].name === playerName) {
                                playerId = id;
                                playerData = playersData[id];
                            }
                        });
                        
                        if (!playerData) {
                            alert('Jogador não encontrado!');
                            return;
                        }
                        
                        const currentTotal = playerData.totalPoints || 0;
                        let finalTotal;
                        let changeDescription;
                        
                        if (action === 'add') {
                            finalTotal = currentTotal + pointsToAdd;
                            changeDescription = `+${pointsToAdd} pontos adicionados`;
                        } else {
                            finalTotal = newTotal;
                            const difference = newTotal - currentTotal;
                            if (difference >= 0) {
                                changeDescription = `+${difference} pontos (ajuste para ${newTotal})`;
                            } else {
                                changeDescription = `${difference} pontos (ajuste para ${newTotal})`;
                            }
                        }
                        
                        // Atualizar pontuação total
                        await database.ref(`${COLLECTION_NAME}/players/${playerId}/totalPoints`).set(finalTotal);
                        
                        // Registrar histórico de pontos diversos
                        const miscHistory = playerData.miscPointsHistory || [];
                        miscHistory.push({
                            action: action,
                            points: action === 'add' ? pointsToAdd : newTotal,
                            previousTotal: currentTotal,
                            newTotal: finalTotal,
                            change: finalTotal - currentTotal,
                            reason: reason,
                            date: new Date().toISOString(),
                            addedBy: currentUser.email
                        });
                        
                        await database.ref(`${COLLECTION_NAME}/players/${playerId}/miscPointsHistory`).set(miscHistory);
                        
                        alert(`Pontuação atualizada para ${playerName}!\n${changeDescription}\nTotal anterior: ${currentTotal}\nTotal atual: ${finalTotal}`);
                        miscPointsForm.reset();
                        
                        // Reset para estado inicial
                        document.getElementById('pointsAction').value = 'add';
                        togglePointsFields();
                        
                        // Recarregar rankings
                        loadRankings();
                        
                    } catch (error) {
                        console.error('Erro ao atualizar pontos:', error);
                        alert('Erro ao atualizar pontos: ' + error.message);
                    }
                });
            }

            loadAllPokemon();
        });

        function setupOpponentPokemonSelection() {
            // Reset completo antes de configurar
            selectedTeamPokemon = [];
            pokemonDisplayOffset = 50;
            refreshingGrid = false;
            selectingPokemon = false;
            
            const container = document.getElementById('opponentPokemonSelection');
            container.innerHTML = `
                <div class="pokemon-selection-header">
                    <h4>🎯 Selecione os 6 Pokémon do time</h4>
                    <div class="progress-indicator">
                        <span id="selectionProgress">0/6 selecionados</span>
                    </div>
                </div>
                
                <div class="search-filters-card">
                    <div class="search-section">
                        <div class="search-box">
                            <span class="search-icon">🔍</span>
                            <input type="text" id="globalPokemonSearch" placeholder="Buscar Pokémon..." onkeyup="globalPokemonSearch()">
                        </div>
                    </div>
                    
                    <div class="filters-section">
                        <div class="filter-item">
                            <span class="filter-label">Tipo:</span>
                            <select id="typeFilter">
                                <option value="">Todos os tipos</option>
                                <option value="normal">Normal</option>
                                <option value="fire">Fogo</option>
                                <option value="water">Água</option>
                                <option value="electric">Elétrico</option>
                                <option value="grass">Grama</option>
                                <option value="ice">Gelo</option>
                                <option value="fighting">Lutador</option>
                                <option value="poison">Veneno</option>
                                <option value="ground">Terra</option>
                                <option value="flying">Voador</option>
                                <option value="psychic">Psíquico</option>
                                <option value="bug">Inseto</option>
                                <option value="rock">Pedra</option>
                                <option value="ghost">Fantasma</option>
                                <option value="dragon">Dragão</option>
                                <option value="dark">Sombrio</option>
                                <option value="steel">Aço</option>
                                <option value="fairy">Fada</option>
                            </select>
                        </div>
                        
                        <div class="filter-item">
                            <span class="filter-label">Geração:</span>
                            <select id="generationFilter">
                                <option value="">Todas</option>
                                <option value="1-151">Gen 1</option>
                                <option value="152-251">Gen 2</option>
                                <option value="252-386">Gen 3</option>
                                <option value="387-493">Gen 4</option>
                                <option value="494-649">Gen 5</option>
                                <option value="650-721">Gen 6</option>
                                <option value="722-809">Gen 7</option>
                                <option value="810-905">Gen 8</option>
                                <option value="906-1010">Gen 9</option>
                            </select>
                        </div>
                        
                        <button type="button" class="btn-search" onclick="filterPokemon()">
                            🔍 Buscar
                        </button>
                        
                        <button type="button" class="clear-filters-btn" onclick="clearFilters()">
                            Limpar
                        </button>
                    </div>
                </div>
                
                <div class="selected-team-preview" id="selectedTeamPreview">
                    <!-- Time selecionado aparecerá aqui -->
                </div>
                
                <div class="pokemon-grid-container">
                    <div class="pokemon-grid" id="pokemonGrid"></div>
                </div>
            `;
            
            displayAllPokemon();
            updateSelectedTeamPreview();
            updateProgressIndicator();
        }

        function displayAllPokemon() {
            const grid = document.getElementById('pokemonGrid');
            if (!grid) return;
            
            // Limpar completamente antes de renderizar
            grid.innerHTML = '';
            
            // Reset do offset para evitar duplicação
            pokemonDisplayOffset = 50;
            
            // Verificar se allPokemon está carregado
            if (!allPokemon || allPokemon.length === 0) {
                grid.innerHTML = '<div class="no-results">Carregando Pokémon...</div>';
                return;
            }
            
            // Mostrar apenas os primeiros 50 Pokémon inicialmente
            const pokemonToShow = allPokemon.slice(0, 50);
            
            pokemonToShow.forEach(pokemon => {
                const div = document.createElement('div');
                const isSelected = selectedTeamPokemon.find(p => p.id === pokemon.id);
                div.className = `pokemon-selection-card ${isSelected ? 'selected' : ''}`;
                div.innerHTML = `
                    <img src="${pokemon.sprite}" alt="${pokemon.name}">
                    <div class="pokemon-name">${pokemon.name}</div>
                    ${isSelected ? '<div class="selected-indicator">✓</div>' : ''}
                `;
                div.onclick = () => selectPokemonForTeam(pokemon);
                grid.appendChild(div);
            });
            
            // Adicionar botão para carregar mais apenas se há mais pokémon
            if (allPokemon.length > 50) {
                const loadMoreBtn = document.createElement('button');
                loadMoreBtn.type = 'button';
                loadMoreBtn.className = 'btn load-more-btn';
                loadMoreBtn.textContent = 'Carregar mais Pokémon';
                loadMoreBtn.onclick = () => loadMorePokemon();
                grid.appendChild(loadMoreBtn);
            }
        }

        let selectedTeamPokemon = [];
        let pokemonDisplayOffset = 50;

        function loadMorePokemon() {
            const grid = document.getElementById('pokemonGrid');
            if (!grid) return;
            
            const loadMoreBtn = grid.querySelector('.load-more-btn');
            
            // Remover botão temporariamente
            if (loadMoreBtn) loadMoreBtn.remove();
            
            // Verificar se ainda há pokémon para carregar
            if (pokemonDisplayOffset >= allPokemon.length) {
                return;
            }
            
            // Adicionar mais 50 Pokémon
            const pokemonToShow = allPokemon.slice(pokemonDisplayOffset, pokemonDisplayOffset + 50);
            
            pokemonToShow.forEach(pokemon => {
                // Verificar se já existe antes de adicionar
                const existingCard = Array.from(grid.children).find(child => {
                    const img = child.querySelector('img');
                    return img && img.alt === pokemon.name;
                });
                
                if (!existingCard) {
                    const div = document.createElement('div');
                    const isSelected = selectedTeamPokemon.find(p => p.id === pokemon.id);
                    div.className = `pokemon-selection-card ${isSelected ? 'selected' : ''}`;
                    div.innerHTML = `
                        <img src="${pokemon.sprite}" alt="${pokemon.name}">
                        <div class="pokemon-name">${pokemon.name}</div>
                        ${isSelected ? '<div class="selected-indicator">✓</div>' : ''}
                    `;
                    div.onclick = () => selectPokemonForTeam(pokemon);
                    grid.appendChild(div);
                }
            });
            
            pokemonDisplayOffset += 50;
            
            // Adicionar botão novamente se ainda há mais Pokémon
            if (pokemonDisplayOffset < allPokemon.length) {
                const newLoadMoreBtn = document.createElement('button');
                newLoadMoreBtn.type = 'button';
                newLoadMoreBtn.className = 'btn load-more-btn';
                newLoadMoreBtn.textContent = 'Carregar mais Pokémon';
                newLoadMoreBtn.onclick = () => loadMorePokemon();
                grid.appendChild(newLoadMoreBtn);
            }
        }

        let selectingPokemon = false; // Flag para evitar duplo clique
        let refreshingGrid = false; // Flag para evitar múltiplas atualizações

        function selectPokemonForTeam(pokemon) {
            if (selectingPokemon) return; // Evitar duplo clique
            selectingPokemon = true;
            
            setTimeout(() => { selectingPokemon = false; }, 500); // Reset após 500ms
            
            if (selectedTeamPokemon.length >= 6) {
                alert('Você já selecionou 6 Pokémon!');
                selectingPokemon = false;
                return;
            }
            
            if (selectedTeamPokemon.find(p => p.id === pokemon.id)) {
                alert('Este Pokémon já foi selecionado!');
                selectingPokemon = false;
                return;
            }
            
            selectedTeamPokemon.push(pokemon);
            updateSelectedPokemonDisplay();
            
            // Atualizar apenas o elemento específico ao invés de toda a grid
            updatePokemonCardSelection(pokemon.id, true);
        }

        function updatePokemonCardSelection(pokemonId, isSelected) {
            const cards = document.querySelectorAll('.pokemon-selection-card');
            cards.forEach(card => {
                const img = card.querySelector('img');
                if (img && img.alt.includes(pokemonId)) {
                    if (isSelected) {
                        card.classList.add('selected');
                        if (!card.querySelector('.selected-indicator')) {
                            card.innerHTML += '<div class="selected-indicator">✓</div>';
                        }
                    } else {
                        card.classList.remove('selected');
                        const indicator = card.querySelector('.selected-indicator');
                        if (indicator) indicator.remove();
                    }
                }
            });
        }

        function removePokemonFromTeam(pokemonId) {
            selectedTeamPokemon = selectedTeamPokemon.filter(p => p.id !== pokemonId);
            updateSelectedPokemonDisplay();
            
            // Atualizar apenas o elemento específico
            updatePokemonCardSelection(pokemonId, false);
        }

        function refreshPokemonGrid() {
            if (refreshingGrid) return; // Evitar múltiplas atualizações
            refreshingGrid = true;
            
            setTimeout(() => { refreshingGrid = false; }, 300);
            
            // Redesenhar a grid atual (seja filtrada ou completa)
            const searchTerm = document.getElementById('globalPokemonSearch').value.toLowerCase();
            const typeFilter = document.getElementById('typeFilter').value;
            const generationFilter = document.getElementById('generationFilter').value;
            
            if (searchTerm || typeFilter || generationFilter) {
                filterPokemon();
            } else {
                displayAllPokemon();
            }
        }

        function updateSelectedPokemonDisplay() {
            updateSelectedTeamPreview();
            updateProgressIndicator();
        }

        function updateSelectedTeamPreview() {
            const preview = document.getElementById('selectedTeamPreview');
            
            if (selectedTeamPokemon.length === 0) {
                preview.className = 'selected-team-preview empty';
                preview.innerHTML = '<span>Selecione os Pokémon do time para ver a prévia aqui</span>';
                return;
            }
            
            preview.className = 'selected-team-preview';
            let html = '';
            
            selectedTeamPokemon.forEach(pokemon => {
                html += `
                    <div class="selected-pokemon-mini">
                        <img src="${pokemon.sprite}" alt="${pokemon.name}" title="${pokemon.name}">
                        <button class="remove-btn" onclick="removePokemonFromTeam(${pokemon.id})" title="Remover ${pokemon.name}">×</button>
                    </div>
                `;
            });
            
            // Adicionar slots vazios
            for (let i = selectedTeamPokemon.length; i < 6; i++) {
                html += `
                    <div class="selected-pokemon-mini empty-slot">
                        <div style="width: 50px; height: 50px; display: flex; align-items: center; justify-content: center; color: #cbd5e0; font-size: 1.5rem;">+</div>
                    </div>
                `;
            }
            
            preview.innerHTML = html;
        }

        function updateProgressIndicator() {
            const indicator = document.getElementById('selectionProgress');
            const count = selectedTeamPokemon.length;
            indicator.textContent = `${count}/6 selecionados`;
            
            if (count === 6) {
                indicator.style.background = 'rgba(72, 187, 120, 0.2)';
                indicator.style.color = '#2f855a';
            } else {
                indicator.style.background = 'rgba(255, 255, 255, 0.2)';
                indicator.style.color = 'white';
            }
        }

        function globalPokemonSearch() {
            filterPokemon();
        }

        function filterPokemon() {
            const searchTerm = document.getElementById('globalPokemonSearch').value.toLowerCase();
            const typeFilter = document.getElementById('typeFilter').value;
            const generationFilter = document.getElementById('generationFilter').value;
            const grid = document.getElementById('pokemonGrid');
            
            let filteredPokemon = allPokemon;
            
            // Filtro por nome
            if (searchTerm.length >= 1) {
                filteredPokemon = filteredPokemon.filter(pokemon => 
                    pokemon.name.toLowerCase().includes(searchTerm)
                );
            }
            
            // Filtro por tipo
            if (typeFilter) {
                filteredPokemon = filteredPokemon.filter(pokemon => 
                    pokemon.types && pokemon.types.includes(typeFilter)
                );
            }
            
            // Filtro por geração
            if (generationFilter) {
                const [min, max] = generationFilter.split('-').map(Number);
                filteredPokemon = filteredPokemon.filter(pokemon => 
                    pokemon.id >= min && pokemon.id <= max
                );
            }
            
            displayFilteredPokemon(filteredPokemon);
        }

        function displayFilteredPokemon(pokemonList) {
            const grid = document.getElementById('pokemonGrid');
            grid.innerHTML = '';
            
            if (pokemonList.length === 0) {
                grid.innerHTML = '<div class="no-results">Nenhum Pokémon encontrado com os filtros aplicados</div>';
                return;
            }
            
            // Mostrar apenas os primeiros 50 resultados para não sobrecarregar
            const pokemonToShow = pokemonList.slice(0, 50);
            
            pokemonToShow.forEach(pokemon => {
                const div = document.createElement('div');
                const isSelected = selectedTeamPokemon.find(p => p.id === pokemon.id);
                div.className = `pokemon-selection-card ${isSelected ? 'selected' : ''}`;
                
                // Mostrar tipos como badges
                const typeBadges = pokemon.types ? pokemon.types.map(type => 
                    `<span class="type-badge type-${type}">${type}</span>`
                ).join('') : '';
                
                div.innerHTML = `
                    <img src="${pokemon.sprite}" alt="${pokemon.name}">
                    <div class="pokemon-name">${pokemon.name}</div>
                    <div class="pokemon-types">${typeBadges}</div>
                    ${isSelected ? '<div class="selected-indicator">✓</div>' : ''}
                `;
                div.onclick = () => selectPokemonForTeam(pokemon);
                grid.appendChild(div);
            });
            
            // Mostrar contagem
            if (pokemonList.length > 50) {
                const moreInfo = document.createElement('div');
                moreInfo.className = 'no-results';
                moreInfo.textContent = `Mostrando 50 de ${pokemonList.length} resultados. Use filtros para refinar a busca.`;
                grid.appendChild(moreInfo);
            }
        }

        function clearFilters() {
            // Limpar campos de filtro
            document.getElementById('globalPokemonSearch').value = '';
            document.getElementById('typeFilter').value = '';
            document.getElementById('generationFilter').value = '';
            
            // Reset completo do offset e flags
            pokemonDisplayOffset = 50;
            refreshingGrid = false;
            selectingPokemon = false;
            
            // Limpar grid completamente antes de recarregar
            const grid = document.getElementById('pokemonGrid');
            if (grid) {
                grid.innerHTML = '';
            }
            
            displayAllPokemon();
        }

        function toggleAddTeamForm() {
            const form = document.getElementById('addTeamForm');
            const button = document.querySelector('.add-team-toggle-btn');
            
            if (form.style.display === 'none') {
                form.style.display = 'block';
                button.textContent = '❌ Cancelar Adição de Time';
                button.style.background = 'linear-gradient(135deg, #feb2b2 0%, #f56565 100%)';
                setupOpponentPokemonSelection();
            } else {
                form.style.display = 'none';
                button.textContent = `➕ Adicionar Time que ${document.querySelector('#playerDetails h2').textContent} Usou Contra Você`;
                button.style.background = 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)';
                
                // Limpar seleção de Pokémon completamente
                selectedTeamPokemon = [];
                pokemonDisplayOffset = 50;
                refreshingGrid = false;
                selectingPokemon = false;
                
                // Limpar preview
                const preview = document.getElementById('selectedTeamPreview');
                if (preview) {
                    preview.className = 'selected-team-preview empty';
                    preview.innerHTML = '<span>Selecione os Pokémon do time para ver a prévia aqui</span>';
                }
                
                // Limpar campo de nome
                const teamNameField = document.getElementById('opponentTeamName');
                if (teamNameField) {
                    teamNameField.value = '';
                }
            }
        }

        async function submitOpponentTeam(event, playerId) {
            event.preventDefault();
            
            if (!currentUser) {
                alert('Você precisa estar logado para adicionar um time!');
                return;
            }
            
            const teamName = document.getElementById('opponentTeamName').value;
            
            if (selectedTeamPokemon.length !== 6) {
                alert('Selecione exatamente 6 Pokémon para o time!');
                return;
            }
            
            try {
                const playerSnapshot = await database.ref(`${COLLECTION_NAME}/players/${playerId}`).once('value');
                const playerData = playerSnapshot.val();
                
                if (!playerData) {
                    alert('Jogador não encontrado');
                    return;
                }
                
                const teams = playerData.teams || [];
                
                const newTeam = {
                    id: Date.now().toString(),
                    name: teamName,
                    pokemon: selectedTeamPokemon.map(p => p.id),
                    likes: 0,
                    likedBy: [],
                    submittedBy: currentUser.uid,
                    submittedAt: new Date().toISOString(),
                    submittedByEmail: currentUser.email,
                    description: `Time usado por ${playerData.name} (reportado por ${currentUser.email})`
                };
                
                teams.push(newTeam);
                
                await database.ref(`${COLLECTION_NAME}/players/${playerId}/teams`).set(teams);
                
                // Limpar seleção
                selectedTeamPokemon = [];
                pokemonDisplayOffset = 50;
                
                // Fechar formulário
                toggleAddTeamForm();
                
                alert('Time adicionado com sucesso!');
                closeModal('playerModal');
                
                // Recarregar rankings para mostrar a atualização
                loadRankings();
                
            } catch (error) {
                console.error('Erro ao adicionar time:', error);
                alert('Erro ao adicionar time: ' + error.message);
            }
        }

        // Fechar modal ao clicar fora
        window.onclick = function(event) {
            const modals = document.querySelectorAll('.modal');
            modals.forEach(modal => {
                if (event.target === modal) {
                    modal.style.display = 'none';
                }
            });
        }

        // Funções de administração (para demonstração)
        function approveVerification(requestId) {
            const request = JSON.parse(localStorage.getItem('verificationRequest_' + requestId));
            if (request) {
                // Atualizar status do usuário
                updateUserVerificationStatus('verified');
                
                // Marcar request como aprovado
                request.status = 'approved';
                localStorage.setItem('verificationRequest_' + requestId, JSON.stringify(request));
                
                // Criar perfil de jogador vinculado
                const playerProfile = {
                    userId: request.userId,
                    playerName: request.playerName,
                    realName: request.realName,
                    email: request.email,
                    city: request.city,
                    pokemonId: request.pokemonId,
                    verified: true,
                    verificationDate: new Date().toISOString()
                };
                
                localStorage.setItem('playerProfile_' + request.userId, JSON.stringify(playerProfile));
                
                alert('✅ Verificação aprovada!\n\n' +
                      '👤 Jogador: ' + request.playerName + '\n' +
                      '📧 Email: ' + request.email + '\n' +
                      '🏙️ Cidade: ' + request.city + '\n\n' +
                      'O usuário agora tem acesso ao perfil completo de jogador!');
            }
        }

        function rejectVerification(requestId) {
            const request = JSON.parse(localStorage.getItem('verificationRequest_' + requestId));
            if (request) {
                updateUserVerificationStatus('rejected');
                request.status = 'rejected';
                localStorage.setItem('verificationRequest_' + requestId, JSON.stringify(request));
                alert('❌ Verificação rejeitada para ' + request.playerName);
            }
        }

        // Função para simular painel de admin (tecla de atalho para demonstração)
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey && e.shiftKey && e.key === 'A') {
                showAdminPanel();
            }
        });

        function showAdminPanel() {
            const requests = Object.keys(localStorage)
                .filter(key => key.startsWith('verificationRequest_'))
                .map(key => {
                    const data = JSON.parse(localStorage.getItem(key));
                    const id = key.replace('verificationRequest_', '');
                    return {id, ...data};
                })
                .filter(request => request.status === 'pending');

            if (requests.length === 0) {
                alert('📋 Painel Administrativo\n\nNenhuma solicitação de verificação pendente.');
                return;
            }

            let adminMessage = '📋 Painel Administrativo - Verificações Pendentes\n\n';
            requests.forEach((request, index) => {
                adminMessage += `${index + 1}. ${request.playerName}\n`;
                adminMessage += `   Nome: ${request.realName}\n`;
                adminMessage += `   Email: ${request.email}\n`;
                adminMessage += `   RG: ${request.rg}\n`;
                adminMessage += `   Cidade: ${request.city}\n`;
                adminMessage += `   Data: ${new Date(request.timestamp).toLocaleDateString()}\n\n`;
            });

            const action = confirm(adminMessage + '\nDeseja aprovar a primeira solicitação?');
            if (action && requests.length > 0) {
                approveVerification(requests[0].id);
            }
        }

        // Inicialização da página
        document.addEventListener('DOMContentLoaded', function() {
            // Garantir que a página inicial esteja visível
            const inicioPage = document.getElementById('inicioPage');
            if (inicioPage && inicioPage.style.display === 'none') {
                inicioPage.style.display = 'block';
                inicioPage.style.opacity = '1';
            }
            
            // Carregar perfil do usuário
            loadUserProfile();
            
            // Garantir que o feed tenha conteúdo
            setTimeout(() => {
                const feedContainer = document.querySelector('.posts-container');
                if (feedContainer && feedContainer.innerHTML.trim() === '') {
                    console.log('Feed vazio detectado, carregando posts de exemplo...');
                    generateFeedPosts();
                    setTimeout(() => {
                        initializeLikes();
                        updateLikeStates();
                    }, 100);
                }
            }, 500);
            
            // Verificar status de verificação ao carregar
            setTimeout(() => {
                checkVerificationStatus();
            }, 1000);

            // Adicionar dica sobre painel admin
            console.log('💡 Dica: Pressione Ctrl+Shift+A para acessar o painel administrativo de verificações');
        });
    </script>
</body>
</html>
